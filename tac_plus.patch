diff -uNr tac_plus.F4.0.3.alpha/Makefile 081101/Makefile
--- tac_plus.F4.0.3.alpha/Makefile	Sat Apr  3 09:03:48 1999
+++ 081101/Makefile	Thu Jan  1 02:00:00 1970
@@ -1,138 +0,0 @@
-# Please NOTE:  None of the TACACS code available here comes with any
-# warranty or support.
-# Copyright (c) 1995-1998 by Cisco systems, Inc.
-# 
-# Permission to use, copy, modify, and distribute this software for any
-# purpose and without fee is hereby granted, provided that this
-# copyright and permission notice appear on all copies of the software and
-# supporting documentation, the name of Cisco Systems, Inc. not be used
-# in advertising or publicity pertaining to distribution of the
-# program without specific prior permission, and notice be given
-# in supporting documentation that modification, copying and distribution is by
-# permission of Cisco Systems, Inc.   
-# 
-# Cisco Systems, Inc. makes no representations about the suitability of this
-# software for any purpose.  THIS SOFTWARE IS PROVIDED ``AS IS''
-# AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT
-# LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
-# FOR A PARTICULAR PURPOSE. 
-
-# CC = gcc
-
-# For AIX
-# See /usr/lpp/bos/bsdport on your system for details of how to define bsdcc
-# CC=bsdcc
-# OS=-DAIX
-
-# For HP/UX uncomment the following line
-# OS=-DHPUX
-
-# For MIPS, uncomment the following line
-# OS=-DMIPS
-
-# For Solaris (SUNOS 5.3, 5.4, 5.5, 5.6) uncomment the following two lines
-OS=-DSOLARIS
-OSLIBS=-lsocket -lnsl
-
-# For FreeBSD
-# OS=-DFREEBSD
-# You may also need to add:
-# OSLIBS=-lcrypt
-# NOTE: If you want your password encryption to be compatible with
-# e.g. SunOS, you may need to instead use:
-# OSLIBS=-ldescrypt
-
-# For LINUX
-# OS=-DLINUX
-#
-# On REDHAT 5.0 systems, or systems that use the new glibc,
-# you might instead need the following:
-# OS=-DLINUX -DGLIBC
-# OSLIBS=-lcrypt
-
-
-# Athough invoked as root, most of the time you don't want tac_plus to
-# be running as root. If USERID and GROUPID are set, tac_plus will
-# attempt change to run as that user & group after reading the
-# configuration file and obtaining a privileged socket. If you always
-# want tac_plus to run as root, then just comment out the FLAGS line.
-
-# USERID  = 1500
-# GROUPID = 25
-# FLAGS   = -DTAC_PLUS_USERID=$(USERID) -DTAC_PLUS_GROUPID=$(GROUPID)
-
-# Definitions for SKEY functionality
-# DEFINES = -DSKEY
-# LIBS = ../crimelab/skey/src/libskey.a
-# INCLUDES = -I../crimelab/skey/src
-
-# Debugging flags
-DEBUG = -g
-
-# Enforce a limit on maximum sessions per user. See the user's guide
-# for more information.
-MAXSESS = -DMAXSESS
-
-# Microsoft CHAP extension support. See the user's guide for more
-# information.
-# MSCHAP = -DMSCHAP
-# MSCHAP_DES = -DMSCHAP_DES
-# MSCHAP_MD4_SRC = md4.c
-
-# On startup, tac_plus creates the file /etc/tac_plus.pid (if
-# possible), containing its process id. Uncomment and modify the
-# following line to change this filename
-
-# PIDFILE = -DTAC_PLUS_PIDFILE=\"/var/run/tac_plus.pid\" 
-
-#
-# End of customisable section of Makefile
-#
-
-CFLAGS = $(DEBUG) $(DEFINES) $(INCLUDES) $(FLAGS) $(OS) $(PIDFILE) $(MAXSESS)
-
-HFILES = expire.h parse.h regmagic.h md5.h regexp.h tac_plus.h 
-
-SRCS =	acct.c authen.c author.c choose_authen.c config.c do_acct.c \
-	do_author.c dump.c encrypt.c expire.c $(MSCHAP_MD4_SRC) md5.c \
-	packet.c report.c sendauth.c tac_plus.c utils.c pw.c hash.c \
-	parse.c regexp.c programs.c enable.c pwlib.c default_fn.c \
-	skey_fn.c default_v0_fn.c sendpass.c maxsess.c
-
-OBJS = $(SRCS:.c=.o)
-
-all:
-	@echo "Please edit the Makefile and then make tac_plus"
-
-tac_plus: $(OBJS) $(LIBS) generate_passwd
-	$(CC) -o tac_plus $(CFLAGS) $(OBJS) $(LIBS) $(OSLIBS)
-
-purecov: $(OBJS) $(LIBS)
-	purecov -follow-child-processes -handle-signals=SIGTERM \
-	    -append-logfile -log-file=purecov.log \
-	    -cache-dir=`pwd` \
-	    $(CC) -o tac_plus $(CFLAGS) $(OBJS) $(LIBS) $(OSLIBS)
-
-purify: $(OBJS) $(LIBS)
-	purify -follow-child-processes=yes -log-file=./tac_plus_purify.log \
-	    -handle-signals=SIGTERM -cache-dir=. \
-	    $(CC) -o tac_plus $(CFLAGS) $(OBJS) $(LIBS) $(OSLIBS)
-
-generate_passwd:
-	$(CC) $(CFLAGS) -o generate_passwd generate_passwd.c $(OSLIBS)
-
-saber:
-	#load -C $(CFLAGS) $(SRCS) $(LIBS)
-
-clean:
-	-rm -f *.o *~ *.BAK tac_plus generate_passwd
-
-install:
-	cp tac_plus /usr/local/bin
-	cp tac_plus.1 /usr/man/manl/tac_plus.1
-
-depend:
-	makedepend $(CFLAGS) $(SRCS)
-
-# DO NOT DELETE THIS LINE -- make depend depends on it.
-
diff -uNr tac_plus.F4.0.3.alpha/Makefile.in 081101/Makefile.in
--- tac_plus.F4.0.3.alpha/Makefile.in	Thu Jan  1 02:00:00 1970
+++ 081101/Makefile.in	Wed Oct 31 14:50:28 2001
@@ -0,0 +1,177 @@
+# Please NOTE:  None of the TACACS code available here comes with any
+# warranty or support.
+# Copyright (c) 1995-1998 by Cisco systems, Inc.
+# 
+# Permission to use, copy, modify, and distribute this software for any
+# purpose and without fee is hereby granted, provided that this
+# copyright and permission notice appear on all copies of the software and
+# supporting documentation, the name of Cisco Systems, Inc. not be used
+# in advertising or publicity pertaining to distribution of the
+# program without specific prior permission, and notice be given
+# in supporting documentation that modification, copying and distribution is by
+# permission of Cisco Systems, Inc.   
+# 
+# Cisco Systems, Inc. makes no representations about the suitability of this
+# software for any purpose.  THIS SOFTWARE IS PROVIDED ``AS IS''
+# AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT
+# LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
+# FOR A PARTICULAR PURPOSE. 
+
+SHELL = /bin/sh
+VPATH = @srcdir@
+
+top_srcdir = @top_srcdir@
+srcdir = @srcdir@
+prefix = @prefix@
+exec_prefix = @exec_prefix@
+bindir = $(exec_prefix)/bin
+sbindir = $(exec_prefix)/sbin
+infodir = $(prefix)/info
+libdir = $(prefix)/lib/gnudl
+mandir = $(prefix)/share/man/man1
+
+CC = @CC@
+CPPFLAGS = @CPPFLAGS@ 
+FLAGS = $(CPPFLAGS) @CFLAGS@
+LDFLAGS = @LDFLAGS@
+OSLIBS = @LIBS@
+DEFINES = @DEFINES@
+OS = @OS@
+PIDFILE = @PIDFILE@
+DB = @DB@
+
+# For AIX
+# See /usr/lpp/bos/bsdport on your system for details of how to define bsdcc
+# CC=bsdcc
+# OS=-DAIX
+
+# For HP/UX uncomment the following line
+# OS=-DHPUX
+
+# For MIPS, uncomment the following line
+# OS=-DMIPS
+
+# For Solaris (SUNOS 5.3, 5.4, 5.5, 5.6) uncomment the following two lines
+#OS=-DSOLARIS
+#OSLIBS=-lsocket -lnsl
+
+# For FreeBSD
+# OS=-DFREEBSD
+# You may also need to add:
+# OSLIBS=-lcrypt
+# NOTE: If you want your password encryption to be compatible with
+# e.g. SunOS, you may need to instead use:
+# OSLIBS=-ldescrypt
+
+# For LINUX
+# OS=-DLINUX
+#
+# On REDHAT 5.0 systems, or systems that use the new glibc,
+# you might instead need the following:
+#OS=-DLINUX -DGLIBC
+#OSLIBS=-lcrypt
+
+# Athough invoked as root, most of the time you don't want tac_plus to
+# be running as root. If USERID and GROUPID are set, tac_plus will
+# attempt change to run as that user & group after reading the
+# configuration file and obtaining a privileged socket. If you always
+# want tac_plus to run as root, then just comment out the FLAGS line.
+
+# USERID  = 1500
+# GROUPID = 25
+# FLAGS   = -DTAC_PLUS_USERID=$(USERID) -DTAC_PLUS_GROUPID=$(GROUPID)
+
+# Definitions for SKEY functionality
+# DEFINES = -DSKEY
+# LIBS = ../crimelab/skey/src/libskey.a
+# INCLUDES = -I../crimelab/skey/src
+
+# Debugging flags
+DEBUG = 
+
+# Opt flags
+OPT_FLAGS = 
+
+# Enforce a limit on maximum sessions per user. See the user's guide
+# for more information.
+#MAXSESS = -DMAXSESS
+
+# Microsoft CHAP extension support. See the user's guide for more
+# information.
+# MSCHAP = -DMSCHAP
+# MSCHAP_DES = -DMSCHAP_DES
+# MSCHAP_MD4_SRC = md4.c
+
+# On startup, tac_plus creates the file /etc/tac_plus.pid (if
+# possible), containing its process id. Uncomment and modify the
+# following line to change this filename
+
+#PIDFILE = -DTAC_PLUS_PIDFILE=\"/var/run/tac_plus.pid\" 
+
+#
+# End of customisable section of Makefile
+#
+
+CFLAGS = $(DEBUG) $(OPT_FLAGS) $(DEFINES) $(INCLUDES) $(FLAGS) $(OS) $(PIDFILE) $(LDFLAGS) $(DB) 
+
+HFILES = expire.h parse.h regmagic.h md5.h regexp.h tac_plus.h 
+
+SRCS =	acct.c authen.c author.c choose_authen.c config.c do_acct.c \
+	do_author.c dump.c encrypt.c expire.c $(MSCHAP_MD4_SRC) md5.c \
+	packet.c report.c sendauth.c tac_plus.c utils.c pw.c hash.c \
+	parse.c regexp.c programs.c enable.c pwlib.c default_fn.c \
+	skey_fn.c default_v0_fn.c sendpass.c maxsess.c tac_pam.c \
+	db.c db_null.c db_mysql.c db_pgsql.c tcpwrap.c ldap.c time_limit.c
+
+OBJS = $(SRCS:.c=.o)
+
+all:
+	@echo "Please edit the Makefile and then make tac_plus"
+
+tac_plus: $(OBJS) $(LIBS) generate_passwd
+	$(CC) -o tac_plus $(CFLAGS) $(OBJS) $(LIBS) $(OSLIBS) 
+	strip tac_plus
+
+purecov: $(OBJS) $(LIBS)
+	purecov -follow-child-processes -handle-signals=SIGTERM \
+	    -append-logfile -log-file=purecov.log \
+	    -cache-dir=`pwd` \
+	    $(CC) -o tac_plus $(CFLAGS) $(OBJS) $(LIBS) $(OSLIBS)
+
+purify: $(OBJS) $(LIBS)
+	purify -follow-child-processes=yes -log-file=./tac_plus_purify.log \
+	    -handle-signals=SIGTERM -cache-dir=. \
+	    $(CC) -o tac_plus $(CFLAGS) $(OBJS) $(LIBS) $(OSLIBS)
+
+generate_passwd:
+	$(CC) $(CFLAGS) -o generate_passwd generate_passwd.c $(OSLIBS)
+
+clean:
+	-rm -f *.o *~ *.BAK core tac_plus generate_passwd
+
+distclean: clean
+	-rm -f Makefile config.h config.status config.cache config.log
+
+clean_obj:
+	-rm -f *.o *~ *.BAK
+
+make_dir:
+	mkdir -p  $(DESTDIR)$(bindir)
+	mkdir -p  $(DESTDIR)$(sbindir)
+	mkdir -p  $(DESTDIR)$(mandir)
+ 
+install: make_dir
+	cp tac_plus $(DESTDIR)$(sbindir)/
+	cp generate_passwd $(DESTDIR)$(bindir)/
+	cp tac_plus.1 $(DESTDIR)$(mandir)/
+
+rpm_install: make_dir
+	install -c -m 0755 tac_plus $(DESTDIR)$(sbindir)/
+	install -c -m 0755 generate_passwd $(DESTDIR)$(sbindir)/
+	install -c -m 0644 tac_plus.1 $(DESTDIR)$(mandir)/
+
+depend:
+	makedepend $(CFLAGS) $(SRCS)
+
+# DO NOT DELETE THIS LINE -- make depend depends on it.
+
diff -uNr tac_plus.F4.0.3.alpha/acct.c 081101/acct.c
--- tac_plus.F4.0.3.alpha/acct.c	Sat Apr  3 09:03:45 1999
+++ 081101/acct.c	Wed Oct 31 14:50:28 2001
@@ -25,6 +25,11 @@
 
 void account();
 
+/* For  DB accounting */
+#ifdef DB
+int db_acct();
+#endif /* DB */
+
 void
 accounting(pak)
 u_char *pak;
@@ -147,7 +152,11 @@
 	errors = do_wtmp(&rec);
     } else {
 	errors = do_acct(&rec);
-    }
+#ifdef DB 
+    if (session.db_acct && rec.acct_type==ACCT_TYPE_STOP )
+	db_acct(&rec);
+#endif
+	}
 
     if (errors) {
 	status = TAC_PLUS_ACCT_STATUS_ERROR;
diff -uNr tac_plus.F4.0.3.alpha/authen.c 081101/authen.c
--- tac_plus.F4.0.3.alpha/authen.c	Sat Apr  3 09:03:45 1999
+++ 081101/authen.c	Wed Oct 31 14:50:28 2001
@@ -132,6 +132,9 @@
      * authenticate this puppy. Begin by choosing a suitable
      * authentication function to call to actually do the work. */
 
+#ifdef TCPWRAPPER
+if (check_from_wrap(&identity)) {   
+#endif
     ret = choose(&authen_data, &authen_type);
 
     switch (ret) {
@@ -144,7 +147,11 @@
 	/* We lost our connection, aborted, or something dreadful happened */
 	break;
     }
-
+#ifdef TCPWRAPPER
+} else {
+send_authen_error("You are not allowed to access here");
+}
+#endif
     /* free data structures */
     if (authen_data.server_msg) {
 	free(authen_data.server_msg);
@@ -227,6 +234,7 @@
 
 	    datap->status = TAC_PLUS_AUTHEN_STATUS_GETUSER;
 	    if (datap->service == TAC_PLUS_AUTHEN_SVC_LOGIN) {
+		if ( !(prompt=(char *)cfg_get_host_prompt(datap->NAS_id->NAS_name)) )
 		prompt = "\nUser Access Verification\n\nUsername: ";
 	    } else {
 		prompt = "Username: ";
diff -uNr tac_plus.F4.0.3.alpha/change.log 081101/change.log
--- tac_plus.F4.0.3.alpha/change.log	Thu Jan  1 02:00:00 1970
+++ 081101/change.log	Thu Nov  8 12:36:22 2001
@@ -0,0 +1,14 @@
+08 Thursday November 2001
+Fixed configure.in for compile FreeBSD correctly
+Changed do_acct.c for create file problem in FreeBSD(O_SYNC error)
+
+18 Thursday October 2001
+Added cleartext and des option for enable passwords 
+
+15 Monday October 2001  
+Changed mysql and pgsql configure options
+Added --enable-finger for maxsess
+
+11 Tue September 2001
+Want to do per host enable passwd..
+Ok.. By time 4:00 finished adding this feature. But required test..
diff -uNr tac_plus.F4.0.3.alpha/config.c 081101/config.c
--- tac_plus.F4.0.3.alpha/config.c	Sat Apr  3 09:03:45 1999
+++ 081101/config.c	Wed Oct 31 14:50:28 2001
@@ -32,9 +32,12 @@
                        default authorization = permit |
                        key = <string>
 
-   <authen_default> := default authentication = file <filename>
-
-   <permission>     := permit | deny
+   <authen_default> := default authentication = file <filename> 
+#if defined(DB)
+		    | db <string> )
+#endif
+   
+<permission>     := permit | deny
 
    <filename>       := <string>
 
@@ -48,8 +51,15 @@
 
    <password_spec>  := file <filename> | 
 		       skey | 
-		       cleartext <password> | 
+		       cleartext <password> |
 		       des <password> |
+
+#ifdef USE_PAM		
+		       pam <pam_service> |
+#endif 		
+#if defined(DB)		
+			db <string>
+#endif
 		       nopassword
 
    <user_attr>      :=   name     = <string> |
@@ -63,6 +73,9 @@
 #endif
 	                 pap      = cleartext <string> |
 	                 pap      = des <string> |
+#ifdef USE_PAM	
+	                 pap      = pam <pam_service> |
+#endif 		
 	                 opap     = cleartext <string> |
 	                 global   = cleartext <string> |
         	         msg      = <string>
@@ -95,6 +108,7 @@
 static int sym_error = 0;	/* a parsing error has occurred */
 static int no_user_dflt = 0;	/* default if user doesn't exist */
 static char *authen_default = NULL;	/* top level authentication default */
+static int authen_default_method = 0; /*For method check */
 static char *nopasswd_str = "nopassword";
 
 /* A host definition structure. Currently unused, but when we start
@@ -108,6 +122,10 @@
     char *name;			/* host name */
     void *hash;			/* hash table next pointer */
     int line;			/* line number defined on */
+    char *key;			/* host specific key */
+    char *type;			/* host type	     */
+    char *prompt;               /* host Login prompt string */
+    char *enable;               /* host enable password */
 };
 
 /* A user or group definition
@@ -148,8 +166,10 @@
 #ifdef MAXSESS
     int maxsess;		/* Max sessions/user */
 #endif /* MAXSESS */
+    char *time;		/* Timestamp  */
 };
 
+typedef struct host HOST;
 typedef struct user USER;
 
 /* Only the first 2 fields (name and hash) are used by the hash table
@@ -165,8 +185,7 @@
 
 void *grouptable[HASH_TAB_SIZE];/* Table of group declarations */
 void *usertable[HASH_TAB_SIZE];	/* Table of user declarations */
-
-/* void *hosttable[HASH_TAB_SIZE];	Table of host declarations */
+void *hosttable[HASH_TAB_SIZE];	/* Table of host declarations */
 
 
 static void
@@ -342,6 +361,8 @@
 	free(user->member);
     if (user->expires)
 	free(user->expires);
+    if (user->time)
+	free(user->time);
     if (user->arap)
 	free(user->arap);
     if (user->chap)
@@ -365,6 +386,29 @@
     free_svcs(user->svcs);
 }
 
+static void
+free_hoststruct(host)
+HOST *host;
+{
+    if (debug & DEBUG_CLEAN_FLAG)
+	report(LOG_DEBUG, "free %s",
+		host->name);
+    if (host->name)
+	free(host->name);
+    
+    if (host->key)
+	free(host->key);
+    
+    if (host->type)
+	free(host->type);
+
+    if (host->prompt)
+        free(host->prompt);
+    
+    if (host->enable)
+        free(host->enable);
+}
+
 /*
  * Exported routines
  */
@@ -375,11 +419,16 @@
 {
     int i;
     USER *entry, *next;
+    HOST *host_entry,*hn;
 
     if (authen_default) {
 	free(authen_default);
 	authen_default = NULL;
     }
+   
+   if (authen_default_method) {
+	authen_default_method = 0;
+    }
 
     if (session.key) {
 	free(session.key);
@@ -390,8 +439,23 @@
 	free(session.acctfile);
 	session.acctfile = NULL;
     }
+    
+    if (session.db_acct) {
+	free(session.db_acct);
+	session.db_acct = NULL;
+    }
 
-    /* clean the hosttable -- currently a no-op */
+    /* clean the hosttable */
+    for (i = 0; i < HASH_TAB_SIZE; i++) {
+	host_entry = (HOST *) hosttable[i];
+	while (host_entry) {
+	    hn = host_entry->hash;
+	    free_hoststruct(host_entry);
+	    free(host_entry);
+	    host_entry = hn;
+	}
+	hosttable[i] = NULL;
+    }
 
     /* the grouptable */
     for (i = 0; i < HASH_TAB_SIZE; i++) {
@@ -479,14 +543,8 @@
     return (S_permit);
 }
 
-/*
-static void
-parse_host()
-{
-}
-*/
-
 static int parse_user();
+static int parse_host();
 
 static void
  rch();
@@ -505,7 +563,7 @@
 
     bzero(grouptable, sizeof(grouptable));
     bzero(usertable, sizeof(usertable));
-    /* bzero(hosttable, sizeof(hosttable)); */
+    bzero(hosttable, sizeof(hosttable)); 
 
     sym_get();
 
@@ -526,6 +584,17 @@
 	    sym_get();
 	    continue;
 
+#ifdef DB	
+	case S_db_accounting:
+	    sym_get();
+	    parse(S_separator);
+	    if (session.db_acct) 
+		free(session.db_acct);
+	    session.db_acct = tac_strdup(sym_buf);
+	    sym_get();
+	    continue;
+#endif
+
 	case S_default:
 	    sym_get();
 	    switch (sym_code) {
@@ -544,7 +613,28 @@
 		}
 		parse(S_authentication);
 		parse(S_separator);
-		parse(S_file);
+
+	        switch(sym_code) {
+                
+		case S_file:
+#ifdef DB
+		case S_db:
+#endif
+#ifdef USE_LDAP
+		case S_ldap:
+#endif
+#ifdef USE_PAM
+		case S_pam:
+#endif
+                authen_default_method = sym_code;
+		break;
+
+		default:
+                parse_error("expecting default_method keyword after 'default authentication = ' on line %d",sym_line);
+		return (1);
+                }
+                sym_get();
+
 		authen_default = tac_strdup(sym_buf);
 		sym_get();
 		continue;
@@ -572,7 +662,11 @@
 	    session.keyline = sym_line;
 	    sym_get();
 	    continue;
-
+	
+	case S_host:
+	    parse_host();
+	    continue;
+	
 	case S_user:
 	case S_group:
 	    parse_user();
@@ -602,6 +696,88 @@
     field = tac_strdup(sym_buf);
 
 static int
+parse_host()
+{
+    HOST *h;
+    HOST *host = (HOST *) tac_malloc(sizeof(HOST));
+    char buf[MAX_INPUT_LINE_LEN];
+
+    bzero(host, sizeof(HOST));
+
+    sym_get();
+    parse(S_separator);
+    host->name = tac_strdup(sym_buf);
+    host->line = sym_line;
+    
+    h = hash_add_entry(hosttable, (void *) host);
+    
+    if (h) {
+        parse_error("multiply defined %s on lines %d and %d",
+                    host->name, h->line, sym_line);
+        return (1);
+    }
+
+    sym_get();
+    parse(S_openbra);
+    
+    while (1) {
+	switch (sym_code) {
+        case S_eof:
+            return (0);
+	case S_key:
+	    ASSIGN(host->key);
+            sym_get();
+            continue;
+	
+	case S_type:
+	    ASSIGN(host->type);
+            sym_get();
+            continue;
+	
+	case S_prompt:
+            ASSIGN(host->prompt);
+            sym_get();
+            continue;	
+
+	case S_enable:
+            if (host->enable) {
+		parse_error("Duplicate value for %s %s and %s on line %d",
+			   codestring(sym_code), host->enable,
+			   sym_buf, sym_line);
+		tac_exit(1);
+            }
+	    sym_get();
+	    parse(S_separator);
+	    switch(sym_code) {
+	    
+	    case S_cleartext:
+            case S_des:	
+            	sprintf(buf, "%s ", sym_buf); 
+	    	sym_get(); 
+	    	strcat(buf, sym_buf); 
+	    	host->enable = tac_strdup(buf); 
+            	break;
+	    default:
+		parse_error("expecting 'cleartext' or 'des' keyword after 'enable =' on line %d", sym_line); 
+	    }
+	    sym_get();
+	    continue;	
+	
+	case S_closebra:
+            parse(S_closebra);
+            return (0);
+
+	default:
+	    parse_error("Unrecognised keyword %s for host %s on line %d",
+                        sym_buf, host->name,sym_line);
+
+            return (0);
+        }
+    } /* while */
+} /* finish parse_host */
+
+
+static int
 parse_user()
 {
     USER *n;
@@ -644,6 +820,11 @@
 	switch (sym_code) {
 	case S_eof:
 	    return (0);
+	
+	case S_time:
+	   ASSIGN(user->time);
+	   sym_get(); 
+	   continue;
 
 	case S_before:
 	    sym_get();
@@ -706,16 +887,28 @@
 	    case S_file:
 	    case S_cleartext:
 	    case S_des:
+#ifdef USE_PAM	
+	    case S_pam:	
+#endif /* USE_PAM */		
+#ifdef DB
+	    case S_db:
+#endif /* USE DB */
 		sprintf(buf, "%s ", sym_buf);
 		sym_get();
 		strcat(buf, sym_buf);
 		user->login = tac_strdup(buf);
 		break;
-
+	
 	    default:
+#ifdef USE_PAM
+		parse_error(
+ "expecting 'file', 'cleartext', 'pam'.'nopassword', 'skey', or 'des' keyword after 'login =' on line %d",
+			    sym_line);
+#else	
 		parse_error(
  "expecting 'file', 'cleartext', 'nopassword', 'skey', or 'des' keyword after 'login =' on line %d", 
 			    sym_line);
+#endif /* USE_PAM */			
 	    }
 	    sym_get();
 	    continue;
@@ -733,16 +926,29 @@
 
 	    case S_cleartext:
 	    case S_des:
+#ifdef USE_PAM	
+	    case S_pam:
+#endif /*USE_PAM */		    	
 		sprintf(buf, "%s ", sym_buf);
 		sym_get();
 		strcat(buf, sym_buf);
 		user->pap = tac_strdup(buf);
+		break;	
+
+		sprintf(buf, "%s ", sym_buf);
+		user->pap = tac_strdup(buf);
 		break;
 
 	    default:
+#ifdef USE_PAM
+      		parse_error(
+ "expecting 'cleartext', 'pam', or 'des' keyword after 'pap =' on line %d",
+ sym_line);
+#else
 		parse_error(
  "expecting 'cleartext', or 'des' keyword after 'pap =' on line %d", 
  sym_line);
+#endif /*USE_PAM */
 	    }
 	    sym_get();
 	    continue;
@@ -756,12 +962,13 @@
 	    ASSIGN(user->member);
 	    sym_get();
 	    continue;
+	
 
 	case S_expires:
 	    ASSIGN(user->expires);
 	    sym_get();
 	    continue;
-
+	
 	case S_message:
 	    ASSIGN(user->msg);
 	    sym_get();
@@ -820,7 +1027,7 @@
 	    sym_get();
 	    continue;
 #endif /* MAXSESS */
-
+ 
 	default:
 	    if (STREQ(sym_buf, "password")) {
 		fprintf(stderr,
@@ -1235,6 +1442,10 @@
 	v.intval = user->nopasswd;
 	break;
 	
+    case S_time:
+	v.pval = user->time;
+	break;
+
     default:
 	report(LOG_ERR, "get_value: unknown field %d", field);
 	break;
@@ -1242,6 +1453,47 @@
     return (v);
 }
 
+/* For host , find value of field. Doesn't recursive */
+VALUE
+get_hvalue(host, field)
+HOST *host;
+int field;
+{
+    VALUE v;
+    v.intval = 0;
+    if(!host) {
+	parse_error("get_hvalue: illegal host");
+        return (v);
+    }
+    switch (field) {
+	case S_name:
+        v.pval = host->name;
+        break;
+	
+	case S_key:
+	v.pval = host->key;
+    	break;
+
+	case S_type:
+	v.pval = host->type;
+	break;
+
+	case S_prompt:
+	v.pval = host->prompt;
+	break;
+	
+	case S_enable:
+	v.pval = host->enable;
+	break;
+
+	default:
+        report(LOG_ERR, "get_value: unknown field %d", field);
+        break;
+    }
+    return (v);
+}
+
+
 /* For each user, check she doesn't circularly reference a
    group. Return 1 if it does */
 static int
@@ -1406,6 +1658,56 @@
 	       p ? p : "NULL");
     return(p);
 }
+
+/* For getting host values */
+static VALUE
+cfg_get_hvalue(name, attr)
+char *name;
+int attr;
+{
+    HOST *host;
+    VALUE value;
+
+    value.pval = NULL;
+    if (debug & DEBUG_CONFIG_FLAG)
+        report(LOG_DEBUG, "cfg_get_hvalue: name=%s attr=%s ",
+               name, codestring(attr));
+    
+    /* find the host entry in hash table */
+
+    host = (HOST *) hash_lookup( hosttable, name);
+
+    if (!host) {
+        if (debug & DEBUG_CONFIG_FLAG)
+            report(LOG_DEBUG, "cfg_get_hvalue: no host named %s", name);
+        return (value);
+    }
+
+    /* found the entry. Lookup value from attr=value */
+    value = get_hvalue(host, attr);
+
+    if (value.pval) {
+        return (value);
+    }
+    /* No any value for this host */    
+    value.pval = NULL;
+    return (value);
+}
+
+/* Wrappers for cfg_get_hvalue */
+char *
+cfg_get_phvalue(name, attr)
+char *name;
+int attr;
+{
+    char *p = cfg_get_hvalue(name, attr).pval;
+
+    if (debug & DEBUG_CONFIG_FLAG)
+	report(LOG_DEBUG, "cfg_get_phvalue: returns %s", 
+	       p ? p : "NULL");
+    return(p);
+}
+
 /*
    Read the config file and do some basic sanity checking on
    it. Return 1 if we find any errors. */
@@ -1418,7 +1720,6 @@
     if ((cf = fopen(cfile, "r")) == NULL) {
 	report(LOG_ERR, "read_config: fopen() error for file %s %s, exiting",
 	       cfile, sys_errlist[errno]);
-	fclose(cf);
 	return (1);
     }
     if (parse_decls() || sym_error) {
@@ -1455,6 +1756,16 @@
     return (cfg_get_pvalue(username, TAC_IS_USER, S_expires, recurse));
 }
 
+/* return time string of user. If none, try groups she is a member
+   on, and so on, recursively if recurse is non-zero */
+char *
+cfg_get_timestamp(username, recurse)
+char *username;
+{
+    return (cfg_get_pvalue(username, TAC_IS_USER, S_time, recurse));
+}
+
+
 /* return password string of user. If none, try groups she is a member
    on, and so on, recursively if recurse is non-zero */
 char *
@@ -1526,6 +1837,55 @@
     return (cfg_get_pvalue(user, TAC_IS_USER, S_global, recurse));
 }
 
+#ifdef USE_PAM
+/* Return a pointer to a node representing a PAM Service name */
+char *
+cfg_get_pam_service(user,recurse)
+char *user;
+
+{
+ char *cfg_passwd;
+ char *p;   
+
+cfg_passwd = cfg_get_pap_secret(user, recurse);
+ 
+if (!cfg_passwd) {
+        	cfg_passwd = cfg_get_global_secret(user, recurse);
+}
+ 
+if (!cfg_passwd && !cfg_user_exists(user)) {
+        cfg_passwd = cfg_get_authen_default();
+        switch (cfg_get_authen_default_method()) {
+		case (S_pam): 
+			if (debug & DEBUG_AUTHOR_FLAG)
+                        report(LOG_DEBUG, "Get Default PAM Service :%s",cfg_passwd);
+			return(cfg_passwd);
+			break;
+		default:
+			if (debug & DEBUG_AUTHOR_FLAG)
+                        report(LOG_DEBUG, "I havent find any PAM Service!!");
+			return(NULL);/* Haven't any PAM Service!! */
+	}
+}
+
+p=tac_find_substring("pam ", cfg_passwd);
+
+if(p) {  /* We find PAM services */
+	if (debug & DEBUG_AUTHOR_FLAG)
+		report(LOG_DEBUG, "I get PAM sevice:%s",p);
+return (p);
+}
+
+if (debug & DEBUG_AUTHOR_FLAG)
+	report(LOG_DEBUG, "No any PAM Sevice");
+
+return(NULL);
+}
+
+#endif /* For PAM */
+	
+
+
 /* Return a pointer to a node representing a given service
    authorization, taking care of recursion issues correctly. Protocol
    is only read if the type is N_svc_ppp. svcname is only read if type
@@ -1795,6 +2155,14 @@
     return (authen_default);
 }
 
+/* For describe authentication method(pam,file,db..etc) */
+int 
+cfg_get_authen_default_method()
+{
+   return (authen_default_method);
+}
+
+
 /* Return 1 if this user has any ppp services configured. Used for
    authorizing ppp/lcp requests */
 int
@@ -1875,3 +2243,28 @@
     /* no PPP svc nodes for this user or her containing groups */
     return (0);
 }
+
+/* For getting host key */
+char *
+cfg_get_host_key(host)
+char *host;
+{
+    return (cfg_get_phvalue(host, S_key));
+}
+
+/* For getting host prompt */
+char *
+cfg_get_host_prompt(host)
+char *host;
+{
+    return (cfg_get_phvalue(host, S_prompt));
+}
+
+/* For getting host enable */
+char *
+cfg_get_host_enable(host)
+char *host;
+{
+    return (cfg_get_phvalue(host, S_enable));
+}
+
diff -uNr tac_plus.F4.0.3.alpha/config.guess 081101/config.guess
--- tac_plus.F4.0.3.alpha/config.guess	Thu Jan  1 02:00:00 1970
+++ 081101/config.guess	Wed Oct 31 14:50:28 2001
@@ -0,0 +1,1121 @@
+#! /bin/sh
+# Attempt to guess a canonical system name.
+#   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999
+#   Free Software Foundation, Inc.
+#
+# This file is free software; you can redistribute it and/or modify it
+# under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful, but
+# WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+# General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+#
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+# Written by Per Bothner <bothner@cygnus.com>.
+# The master version of this file is at the FSF in /home/gd/gnu/lib.
+# Please send patches to <autoconf-patches@gnu.org>.
+#
+# This script attempts to guess a canonical system name similar to
+# config.sub.  If it succeeds, it prints the system name on stdout, and
+# exits with 0.  Otherwise, it exits with 1.
+#
+# The plan is that this can be called by configure scripts if you
+# don't specify an explicit system type (host/target name).
+#
+# Only a few systems have been added to this list; please add others
+# (but try to keep the structure clean).
+#
+
+# Use $HOST_CC if defined. $CC may point to a cross-compiler
+if test x"$CC_FOR_BUILD" = x; then
+  if test x"$HOST_CC" != x; then
+    CC_FOR_BUILD="$HOST_CC"
+  else
+    if test x"$CC" != x; then
+      CC_FOR_BUILD="$CC"
+    else
+      CC_FOR_BUILD=cc
+    fi
+  fi
+fi
+
+
+# This is needed to find uname on a Pyramid OSx when run in the BSD universe.
+# (ghazi@noc.rutgers.edu 8/24/94.)
+if (test -f /.attbin/uname) >/dev/null 2>&1 ; then
+	PATH=$PATH:/.attbin ; export PATH
+fi
+
+UNAME_MACHINE=`(uname -m) 2>/dev/null` || UNAME_MACHINE=unknown
+UNAME_RELEASE=`(uname -r) 2>/dev/null` || UNAME_RELEASE=unknown
+UNAME_SYSTEM=`(uname -s) 2>/dev/null` || UNAME_SYSTEM=unknown
+UNAME_VERSION=`(uname -v) 2>/dev/null` || UNAME_VERSION=unknown
+
+dummy=dummy-$$
+trap 'rm -f $dummy.c $dummy.o $dummy; exit 1' 1 2 15
+
+# Note: order is significant - the case branches are not exclusive.
+
+case "${UNAME_MACHINE}:${UNAME_SYSTEM}:${UNAME_RELEASE}:${UNAME_VERSION}" in
+    alpha:OSF1:*:*)
+	if test $UNAME_RELEASE = "V4.0"; then
+		UNAME_RELEASE=`/usr/sbin/sizer -v | awk '{print $3}'`
+	fi
+	# A Vn.n version is a released version.
+	# A Tn.n version is a released field test version.
+	# A Xn.n version is an unreleased experimental baselevel.
+	# 1.2 uses "1.2" for uname -r.
+	cat <<EOF >$dummy.s
+	.globl main
+	.ent main
+main:
+	.frame \$30,0,\$26,0
+	.prologue 0
+	.long 0x47e03d80 # implver $0
+	lda \$2,259
+	.long 0x47e20c21 # amask $2,$1
+	srl \$1,8,\$2
+	sll \$2,2,\$2
+	sll \$0,3,\$0
+	addl \$1,\$0,\$0
+	addl \$2,\$0,\$0
+	ret \$31,(\$26),1
+	.end main
+EOF
+	$CC_FOR_BUILD $dummy.s -o $dummy 2>/dev/null
+	if test "$?" = 0 ; then
+		./$dummy
+		case "$?" in
+			7)
+				UNAME_MACHINE="alpha"
+				;;
+			15)
+				UNAME_MACHINE="alphaev5"
+				;;
+			14)
+				UNAME_MACHINE="alphaev56"
+				;;
+			10)
+				UNAME_MACHINE="alphapca56"
+				;;
+			16)
+				UNAME_MACHINE="alphaev6"
+				;;
+		esac
+	fi
+	rm -f $dummy.s $dummy
+	echo ${UNAME_MACHINE}-dec-osf`echo ${UNAME_RELEASE} | sed -e 's/^[VTX]//' | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
+	exit 0 ;;
+    Alpha\ *:Windows_NT*:*)
+	# How do we know it's Interix rather than the generic POSIX subsystem?
+	# Should we change UNAME_MACHINE based on the output of uname instead
+	# of the specific Alpha model?
+	echo alpha-pc-interix
+	exit 0 ;;
+    21064:Windows_NT:50:3)
+	echo alpha-dec-winnt3.5
+	exit 0 ;;
+    Amiga*:UNIX_System_V:4.0:*)
+	echo m68k-cbm-sysv4
+	exit 0;;
+    amiga:NetBSD:*:*)
+      echo m68k-cbm-netbsd${UNAME_RELEASE}
+      exit 0 ;;
+    amiga:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    *:[Aa]miga[Oo][Ss]:*:*)
+	echo ${UNAME_MACHINE}-unknown-amigaos
+	exit 0 ;;
+    arc64:OpenBSD:*:*)
+	echo mips64el-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    arc:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    hkmips:OpenBSD:*:*)
+	echo mips-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    pmax:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    sgi:OpenBSD:*:*)
+	echo mips-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    wgrisc:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    *:OS/390:*:*)
+	echo i370-ibm-openedition
+	exit 0 ;;
+    arm:RISC*:1.[012]*:*|arm:riscix:1.[012]*:*)
+	echo arm-acorn-riscix${UNAME_RELEASE}
+	exit 0;;
+    arm32:NetBSD:*:*)
+	echo arm-unknown-netbsd`echo ${UNAME_RELEASE}|sed -e 's/[-_].*/\./'`
+	exit 0 ;;
+    SR2?01:HI-UX/MPP:*:*)
+	echo hppa1.1-hitachi-hiuxmpp
+	exit 0;;
+    Pyramid*:OSx*:*:* | MIS*:OSx*:*:* | MIS*:SMP_DC-OSx*:*:*)
+	# akee@wpdis03.wpafb.af.mil (Earle F. Ake) contributed MIS and NILE.
+	if test "`(/bin/universe) 2>/dev/null`" = att ; then
+		echo pyramid-pyramid-sysv3
+	else
+		echo pyramid-pyramid-bsd
+	fi
+	exit 0 ;;
+    NILE*:*:*:dcosx)
+	echo pyramid-pyramid-svr4
+	exit 0 ;;
+    sun4H:SunOS:5.*:*)
+	echo sparc-hal-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    sun4*:SunOS:5.*:* | tadpole*:SunOS:5.*:*)
+	echo sparc-sun-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    i86pc:SunOS:5.*:*)
+	echo i386-pc-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    sun4*:SunOS:6*:*)
+	# According to config.sub, this is the proper way to canonicalize
+	# SunOS6.  Hard to guess exactly what SunOS6 will be like, but
+	# it's likely to be more like Solaris than SunOS4.
+	echo sparc-sun-solaris3`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    sun4*:SunOS:*:*)
+	case "`/usr/bin/arch -k`" in
+	    Series*|S4*)
+		UNAME_RELEASE=`uname -v`
+		;;
+	esac
+	# Japanese Language versions have a version number like `4.1.3-JL'.
+	echo sparc-sun-sunos`echo ${UNAME_RELEASE}|sed -e 's/-/_/'`
+	exit 0 ;;
+    sun3*:SunOS:*:*)
+	echo m68k-sun-sunos${UNAME_RELEASE}
+	exit 0 ;;
+    sun*:*:4.2BSD:*)
+	UNAME_RELEASE=`(head -1 /etc/motd | awk '{print substr($5,1,3)}') 2>/dev/null`
+	test "x${UNAME_RELEASE}" = "x" && UNAME_RELEASE=3
+	case "`/bin/arch`" in
+	    sun3)
+		echo m68k-sun-sunos${UNAME_RELEASE}
+		;;
+	    sun4)
+		echo sparc-sun-sunos${UNAME_RELEASE}
+		;;
+	esac
+	exit 0 ;;
+    aushp:SunOS:*:*)
+	echo sparc-auspex-sunos${UNAME_RELEASE}
+	exit 0 ;;
+    atari*:NetBSD:*:*)
+	echo m68k-atari-netbsd${UNAME_RELEASE}
+	exit 0 ;;
+    atari*:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    # The situation for MiNT is a little confusing.  The machine name
+    # can be virtually everything (everything which is not
+    # "atarist" or "atariste" at least should have a processor 
+    # > m68000).  The system name ranges from "MiNT" over "FreeMiNT"
+    # to the lowercase version "mint" (or "freemint").  Finally
+    # the system name "TOS" denotes a system which is actually not
+    # MiNT.  But MiNT is downward compatible to TOS, so this should
+    # be no problem.
+    atarist[e]:*MiNT:*:* | atarist[e]:*mint:*:* | atarist[e]:*TOS:*:*)
+        echo m68k-atari-mint${UNAME_RELEASE}
+	exit 0 ;;
+    atari*:*MiNT:*:* | atari*:*mint:*:* | atarist[e]:*TOS:*:*)
+	echo m68k-atari-mint${UNAME_RELEASE}
+        exit 0 ;;
+    *falcon*:*MiNT:*:* | *falcon*:*mint:*:* | *falcon*:*TOS:*:*)
+        echo m68k-atari-mint${UNAME_RELEASE}
+	exit 0 ;;
+    milan*:*MiNT:*:* | milan*:*mint:*:* | *milan*:*TOS:*:*)
+        echo m68k-milan-mint${UNAME_RELEASE}
+        exit 0 ;;
+    hades*:*MiNT:*:* | hades*:*mint:*:* | *hades*:*TOS:*:*)
+        echo m68k-hades-mint${UNAME_RELEASE}
+        exit 0 ;;
+    *:*MiNT:*:* | *:*mint:*:* | *:*TOS:*:*)
+        echo m68k-unknown-mint${UNAME_RELEASE}
+        exit 0 ;;
+    sun3*:NetBSD:*:*)
+	echo m68k-sun-netbsd${UNAME_RELEASE}
+	exit 0 ;;
+    sun3*:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mac68k:NetBSD:*:*)
+	echo m68k-apple-netbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mac68k:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mvme68k:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mvme88k:OpenBSD:*:*)
+	echo m88k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    powerpc:machten:*:*)
+	echo powerpc-apple-machten${UNAME_RELEASE}
+	exit 0 ;;
+    macppc:NetBSD:*:*)
+        echo powerpc-apple-netbsd${UNAME_RELEASE}
+        exit 0 ;;
+    RISC*:Mach:*:*)
+	echo mips-dec-mach_bsd4.3
+	exit 0 ;;
+    RISC*:ULTRIX:*:*)
+	echo mips-dec-ultrix${UNAME_RELEASE}
+	exit 0 ;;
+    VAX*:ULTRIX*:*:*)
+	echo vax-dec-ultrix${UNAME_RELEASE}
+	exit 0 ;;
+    2020:CLIX:*:* | 2430:CLIX:*:*)
+	echo clipper-intergraph-clix${UNAME_RELEASE}
+	exit 0 ;;
+    mips:*:*:UMIPS | mips:*:*:RISCos)
+	sed 's/^	//' << EOF >$dummy.c
+#ifdef __cplusplus
+	int main (int argc, char *argv[]) {
+#else
+	int main (argc, argv) int argc; char *argv[]; {
+#endif
+	#if defined (host_mips) && defined (MIPSEB)
+	#if defined (SYSTYPE_SYSV)
+	  printf ("mips-mips-riscos%ssysv\n", argv[1]); exit (0);
+	#endif
+	#if defined (SYSTYPE_SVR4)
+	  printf ("mips-mips-riscos%ssvr4\n", argv[1]); exit (0);
+	#endif
+	#if defined (SYSTYPE_BSD43) || defined(SYSTYPE_BSD)
+	  printf ("mips-mips-riscos%sbsd\n", argv[1]); exit (0);
+	#endif
+	#endif
+	  exit (-1);
+	}
+EOF
+	$CC_FOR_BUILD $dummy.c -o $dummy \
+	  && ./$dummy `echo "${UNAME_RELEASE}" | sed -n 's/\([0-9]*\).*/\1/p'` \
+	  && rm $dummy.c $dummy && exit 0
+	rm -f $dummy.c $dummy
+	echo mips-mips-riscos${UNAME_RELEASE}
+	exit 0 ;;
+    Night_Hawk:Power_UNIX:*:*)
+	echo powerpc-harris-powerunix
+	exit 0 ;;
+    m88k:CX/UX:7*:*)
+	echo m88k-harris-cxux7
+	exit 0 ;;
+    m88k:*:4*:R4*)
+	echo m88k-motorola-sysv4
+	exit 0 ;;
+    m88k:*:3*:R3*)
+	echo m88k-motorola-sysv3
+	exit 0 ;;
+    AViiON:dgux:*:*)
+        # DG/UX returns AViiON for all architectures
+        UNAME_PROCESSOR=`/usr/bin/uname -p`
+	if [ $UNAME_PROCESSOR = mc88100 ] || [ $UNAME_PROCESSOR = mc88110]
+	then
+	    if [ ${TARGET_BINARY_INTERFACE}x = m88kdguxelfx ] || \
+	       [ ${TARGET_BINARY_INTERFACE}x = x ]
+	    then
+		echo m88k-dg-dgux${UNAME_RELEASE}
+	    else
+		echo m88k-dg-dguxbcs${UNAME_RELEASE}
+	    fi
+	else
+	    echo i586-dg-dgux${UNAME_RELEASE}
+	fi
+ 	exit 0 ;;
+    M88*:DolphinOS:*:*)	# DolphinOS (SVR3)
+	echo m88k-dolphin-sysv3
+	exit 0 ;;
+    M88*:*:R3*:*)
+	# Delta 88k system running SVR3
+	echo m88k-motorola-sysv3
+	exit 0 ;;
+    XD88*:*:*:*) # Tektronix XD88 system running UTekV (SVR3)
+	echo m88k-tektronix-sysv3
+	exit 0 ;;
+    Tek43[0-9][0-9]:UTek:*:*) # Tektronix 4300 system running UTek (BSD)
+	echo m68k-tektronix-bsd
+	exit 0 ;;
+    *:IRIX*:*:*)
+	echo mips-sgi-irix`echo ${UNAME_RELEASE}|sed -e 's/-/_/g'`
+	exit 0 ;;
+    ????????:AIX?:[12].1:2)   # AIX 2.2.1 or AIX 2.1.1 is RT/PC AIX.
+	echo romp-ibm-aix      # uname -m gives an 8 hex-code CPU id
+	exit 0 ;;              # Note that: echo "'`uname -s`'" gives 'AIX '
+    i?86:AIX:*:*)
+	echo i386-ibm-aix
+	exit 0 ;;
+    *:AIX:2:3)
+	if grep bos325 /usr/include/stdio.h >/dev/null 2>&1; then
+		sed 's/^		//' << EOF >$dummy.c
+		#include <sys/systemcfg.h>
+
+		main()
+			{
+			if (!__power_pc())
+				exit(1);
+			puts("powerpc-ibm-aix3.2.5");
+			exit(0);
+			}
+EOF
+		$CC_FOR_BUILD $dummy.c -o $dummy && ./$dummy && rm $dummy.c $dummy && exit 0
+		rm -f $dummy.c $dummy
+		echo rs6000-ibm-aix3.2.5
+	elif grep bos324 /usr/include/stdio.h >/dev/null 2>&1; then
+		echo rs6000-ibm-aix3.2.4
+	else
+		echo rs6000-ibm-aix3.2
+	fi
+	exit 0 ;;
+    *:AIX:*:4)
+	IBM_CPU_ID=`/usr/sbin/lsdev -C -c processor -S available | head -1 | awk '{ print $1 }'`
+	if /usr/sbin/lsattr -EHl ${IBM_CPU_ID} | grep POWER >/dev/null 2>&1; then
+		IBM_ARCH=rs6000
+	else
+		IBM_ARCH=powerpc
+	fi
+	if [ -x /usr/bin/oslevel ] ; then
+		IBM_REV=`/usr/bin/oslevel`
+	else
+		IBM_REV=4.${UNAME_RELEASE}
+	fi
+	echo ${IBM_ARCH}-ibm-aix${IBM_REV}
+	exit 0 ;;
+    *:AIX:*:*)
+	echo rs6000-ibm-aix
+	exit 0 ;;
+    ibmrt:4.4BSD:*|romp-ibm:BSD:*)
+	echo romp-ibm-bsd4.4
+	exit 0 ;;
+    ibmrt:*BSD:*|romp-ibm:BSD:*)            # covers RT/PC NetBSD and
+	echo romp-ibm-bsd${UNAME_RELEASE}   # 4.3 with uname added to
+	exit 0 ;;                           # report: romp-ibm BSD 4.3
+    *:BOSX:*:*)
+	echo rs6000-bull-bosx
+	exit 0 ;;
+    DPX/2?00:B.O.S.:*:*)
+	echo m68k-bull-sysv3
+	exit 0 ;;
+    9000/[34]??:4.3bsd:1.*:*)
+	echo m68k-hp-bsd
+	exit 0 ;;
+    hp300:4.4BSD:*:* | 9000/[34]??:4.3bsd:2.*:*)
+	echo m68k-hp-bsd4.4
+	exit 0 ;;
+    9000/[34678]??:HP-UX:*:*)
+	case "${UNAME_MACHINE}" in
+	    9000/31? )            HP_ARCH=m68000 ;;
+	    9000/[34]?? )         HP_ARCH=m68k ;;
+	    9000/[678][0-9][0-9])
+              sed 's/^              //' << EOF >$dummy.c
+              #include <stdlib.h>
+              #include <unistd.h>
+
+              int main ()
+              {
+              #if defined(_SC_KERNEL_BITS)
+                  long bits = sysconf(_SC_KERNEL_BITS);
+              #endif
+                  long cpu  = sysconf (_SC_CPU_VERSION);
+
+                  switch (cpu)
+              	{
+              	case CPU_PA_RISC1_0: puts ("hppa1.0"); break;
+              	case CPU_PA_RISC1_1: puts ("hppa1.1"); break;
+              	case CPU_PA_RISC2_0:
+              #if defined(_SC_KERNEL_BITS)
+              	    switch (bits)
+              		{
+              		case 64: puts ("hppa2.0w"); break;
+              		case 32: puts ("hppa2.0n"); break;
+              		default: puts ("hppa2.0"); break;
+              		} break;
+              #else  /* !defined(_SC_KERNEL_BITS) */
+              	    puts ("hppa2.0"); break;
+              #endif
+              	default: puts ("hppa1.0"); break;
+              	}
+                  exit (0);
+              }
+EOF
+	(CCOPTS= $CC_FOR_BUILD $dummy.c -o $dummy 2>/dev/null ) && HP_ARCH=`./$dummy`
+	rm -f $dummy.c $dummy
+	esac
+	HPUX_REV=`echo ${UNAME_RELEASE}|sed -e 's/[^.]*.[0B]*//'`
+	echo ${HP_ARCH}-hp-hpux${HPUX_REV}
+	exit 0 ;;
+    3050*:HI-UX:*:*)
+	sed 's/^	//' << EOF >$dummy.c
+	#include <unistd.h>
+	int
+	main ()
+	{
+	  long cpu = sysconf (_SC_CPU_VERSION);
+	  /* The order matters, because CPU_IS_HP_MC68K erroneously returns
+	     true for CPU_PA_RISC1_0.  CPU_IS_PA_RISC returns correct
+	     results, however.  */
+	  if (CPU_IS_PA_RISC (cpu))
+	    {
+	      switch (cpu)
+		{
+		  case CPU_PA_RISC1_0: puts ("hppa1.0-hitachi-hiuxwe2"); break;
+		  case CPU_PA_RISC1_1: puts ("hppa1.1-hitachi-hiuxwe2"); break;
+		  case CPU_PA_RISC2_0: puts ("hppa2.0-hitachi-hiuxwe2"); break;
+		  default: puts ("hppa-hitachi-hiuxwe2"); break;
+		}
+	    }
+	  else if (CPU_IS_HP_MC68K (cpu))
+	    puts ("m68k-hitachi-hiuxwe2");
+	  else puts ("unknown-hitachi-hiuxwe2");
+	  exit (0);
+	}
+EOF
+	$CC_FOR_BUILD $dummy.c -o $dummy && ./$dummy && rm $dummy.c $dummy && exit 0
+	rm -f $dummy.c $dummy
+	echo unknown-hitachi-hiuxwe2
+	exit 0 ;;
+    9000/7??:4.3bsd:*:* | 9000/8?[79]:4.3bsd:*:* )
+	echo hppa1.1-hp-bsd
+	exit 0 ;;
+    9000/8??:4.3bsd:*:*)
+	echo hppa1.0-hp-bsd
+	exit 0 ;;
+    *9??*:MPE/iX:*:*)
+	echo hppa1.0-hp-mpeix
+	exit 0 ;;
+    hp7??:OSF1:*:* | hp8?[79]:OSF1:*:* )
+	echo hppa1.1-hp-osf
+	exit 0 ;;
+    hp8??:OSF1:*:*)
+	echo hppa1.0-hp-osf
+	exit 0 ;;
+    i?86:OSF1:*:*)
+	if [ -x /usr/sbin/sysversion ] ; then
+	    echo ${UNAME_MACHINE}-unknown-osf1mk
+	else
+	    echo ${UNAME_MACHINE}-unknown-osf1
+	fi
+	exit 0 ;;
+    parisc*:Lites*:*:*)
+	echo hppa1.1-hp-lites
+	exit 0 ;;
+    hppa*:OpenBSD:*:*)
+	echo hppa-unknown-openbsd
+	exit 0 ;;
+    C1*:ConvexOS:*:* | convex:ConvexOS:C1*:*)
+	echo c1-convex-bsd
+        exit 0 ;;
+    C2*:ConvexOS:*:* | convex:ConvexOS:C2*:*)
+	if getsysinfo -f scalar_acc
+	then echo c32-convex-bsd
+	else echo c2-convex-bsd
+	fi
+        exit 0 ;;
+    C34*:ConvexOS:*:* | convex:ConvexOS:C34*:*)
+	echo c34-convex-bsd
+        exit 0 ;;
+    C38*:ConvexOS:*:* | convex:ConvexOS:C38*:*)
+	echo c38-convex-bsd
+        exit 0 ;;
+    C4*:ConvexOS:*:* | convex:ConvexOS:C4*:*)
+	echo c4-convex-bsd
+        exit 0 ;;
+    CRAY*X-MP:*:*:*)
+	echo xmp-cray-unicos
+        exit 0 ;;
+    CRAY*Y-MP:*:*:*)
+	echo ymp-cray-unicos${UNAME_RELEASE}
+	exit 0 ;;
+    CRAY*[A-Z]90:*:*:*)
+	echo ${UNAME_MACHINE}-cray-unicos${UNAME_RELEASE} \
+	| sed -e 's/CRAY.*\([A-Z]90\)/\1/' \
+	      -e y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/
+	exit 0 ;;
+    CRAY*TS:*:*:*)
+	echo t90-cray-unicos${UNAME_RELEASE}
+	exit 0 ;;
+    CRAY*T3E:*:*:*)
+	echo alpha-cray-unicosmk${UNAME_RELEASE}
+	exit 0 ;;
+    CRAY-2:*:*:*)
+	echo cray2-cray-unicos
+        exit 0 ;;
+    F300:UNIX_System_V:*:*)
+        FUJITSU_SYS=`uname -p | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz' | sed -e 's/\///'`
+        FUJITSU_REL=`echo ${UNAME_RELEASE} | sed -e 's/ /_/'`
+        echo "f300-fujitsu-${FUJITSU_SYS}${FUJITSU_REL}"
+        exit 0 ;;
+    F301:UNIX_System_V:*:*)
+       echo f301-fujitsu-uxpv`echo $UNAME_RELEASE | sed 's/ .*//'`
+       exit 0 ;;
+    hp3[0-9][05]:NetBSD:*:*)
+	echo m68k-hp-netbsd${UNAME_RELEASE}
+	exit 0 ;;
+    hp300:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    i?86:BSD/386:*:* | i?86:BSD/OS:*:*)
+	echo ${UNAME_MACHINE}-pc-bsdi${UNAME_RELEASE}
+	exit 0 ;;
+    sparc*:BSD/OS:*:*)
+	echo sparc-unknown-bsdi${UNAME_RELEASE}
+	exit 0 ;;
+    *:BSD/OS:*:*)
+	echo ${UNAME_MACHINE}-unknown-bsdi${UNAME_RELEASE}
+	exit 0 ;;
+    *:FreeBSD:*:*)
+	if test -x /usr/bin/objformat; then
+	    if test "elf" = "`/usr/bin/objformat`"; then
+		echo ${UNAME_MACHINE}-unknown-freebsdelf`echo ${UNAME_RELEASE}|sed -e 's/[-_].*//'`
+		exit 0
+	    fi
+	fi
+	echo ${UNAME_MACHINE}-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`
+	exit 0 ;;
+    *:NetBSD:*:*)
+	echo ${UNAME_MACHINE}-unknown-netbsd`echo ${UNAME_RELEASE}|sed -e 's/[-_].*//'`
+	exit 0 ;;
+    *:OpenBSD:*:*)
+	echo ${UNAME_MACHINE}-unknown-openbsd`echo ${UNAME_RELEASE}|sed -e 's/[-_].*/\./'`
+	exit 0 ;;
+    i*:CYGWIN*:*)
+	echo ${UNAME_MACHINE}-pc-cygwin
+	exit 0 ;;
+    i*:MINGW*:*)
+	echo ${UNAME_MACHINE}-pc-mingw32
+	exit 0 ;;
+    i*:Windows_NT*:* | Pentium*:Windows_NT*:*)
+	# How do we know it's Interix rather than the generic POSIX subsystem?
+	# It also conflicts with pre-2.0 versions of AT&T UWIN. Should we
+	# UNAME_MACHINE based on the output of uname instead of i386?
+	echo i386-pc-interix
+	exit 0 ;;
+    i*:UWIN*:*)
+	echo ${UNAME_MACHINE}-pc-uwin
+	exit 0 ;;
+    p*:CYGWIN*:*)
+	echo powerpcle-unknown-cygwin
+	exit 0 ;;
+    prep*:SunOS:5.*:*)
+	echo powerpcle-unknown-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    *:GNU:*:*)
+	echo `echo ${UNAME_MACHINE}|sed -e 's,[-/].*$,,'`-unknown-gnu`echo ${UNAME_RELEASE}|sed -e 's,/.*$,,'`
+	exit 0 ;;
+    *:Linux:*:*)
+
+	# The BFD linker knows what the default object file format is, so
+	# first see if it will tell us. cd to the root directory to prevent
+	# problems with other programs or directories called `ld' in the path.
+	ld_help_string=`cd /; ld --help 2>&1`
+	ld_supported_emulations=`echo $ld_help_string \
+			 | sed -ne '/supported emulations:/!d
+				    s/[ 	][ 	]*/ /g
+				    s/.*supported emulations: *//
+				    s/ .*//
+				    p'`
+        case "$ld_supported_emulations" in
+	  *ia64)
+		echo "${UNAME_MACHINE}-unknown-linux"
+		exit 0
+		;;
+	  i?86linux)
+		echo "${UNAME_MACHINE}-pc-linux-gnuaout"
+		exit 0
+		;;
+	  i?86coff)
+		echo "${UNAME_MACHINE}-pc-linux-gnucoff"
+		exit 0
+		;;
+	  sparclinux)
+		echo "${UNAME_MACHINE}-unknown-linux-gnuaout"
+		exit 0
+		;;
+	  armlinux)
+		echo "${UNAME_MACHINE}-unknown-linux-gnuaout"
+		exit 0
+		;;
+	  elf32arm*)
+		echo "${UNAME_MACHINE}-unknown-linux-gnu"
+		exit 0
+		;;
+	  armelf_linux*)
+		echo "${UNAME_MACHINE}-unknown-linux-gnu"
+		exit 0
+		;;
+	  m68klinux)
+		echo "${UNAME_MACHINE}-unknown-linux-gnuaout"
+		exit 0
+		;;
+	  elf32ppc)
+		# Determine Lib Version
+		cat >$dummy.c <<EOF
+#include <features.h>
+#if defined(__GLIBC__)
+extern char __libc_version[];
+extern char __libc_release[];
+#endif
+main(argc, argv)
+     int argc;
+     char *argv[];
+{
+#if defined(__GLIBC__)
+  printf("%s %s\n", __libc_version, __libc_release);
+#else
+  printf("unkown\n");
+#endif
+  return 0;
+}
+EOF
+		LIBC=""
+		$CC_FOR_BUILD $dummy.c -o $dummy 2>/dev/null
+		if test "$?" = 0 ; then
+			./$dummy | grep 1\.99 > /dev/null
+			if test "$?" = 0 ; then
+				LIBC="libc1"
+			fi
+		fi	
+		rm -f $dummy.c $dummy
+		echo powerpc-unknown-linux-gnu${LIBC}
+		exit 0
+		;;
+	esac
+
+	if test "${UNAME_MACHINE}" = "alpha" ; then
+		sed 's/^	//'  <<EOF >$dummy.s
+		.globl main
+		.ent main
+	main:
+		.frame \$30,0,\$26,0
+		.prologue 0
+		.long 0x47e03d80 # implver $0
+		lda \$2,259
+		.long 0x47e20c21 # amask $2,$1
+		srl \$1,8,\$2
+		sll \$2,2,\$2
+		sll \$0,3,\$0
+		addl \$1,\$0,\$0
+		addl \$2,\$0,\$0
+		ret \$31,(\$26),1
+		.end main
+EOF
+		LIBC=""
+		$CC_FOR_BUILD $dummy.s -o $dummy 2>/dev/null
+		if test "$?" = 0 ; then
+			./$dummy
+			case "$?" in
+			7)
+				UNAME_MACHINE="alpha"
+				;;
+			15)
+				UNAME_MACHINE="alphaev5"
+				;;
+			14)
+				UNAME_MACHINE="alphaev56"
+				;;
+			10)
+				UNAME_MACHINE="alphapca56"
+				;;
+			16)
+				UNAME_MACHINE="alphaev6"
+				;;
+			esac
+
+			objdump --private-headers $dummy | \
+			  grep ld.so.1 > /dev/null
+			if test "$?" = 0 ; then
+				LIBC="libc1"
+			fi
+		fi
+		rm -f $dummy.s $dummy
+		echo ${UNAME_MACHINE}-unknown-linux-gnu${LIBC} ; exit 0
+	elif test "${UNAME_MACHINE}" = "mips" ; then
+	  cat >$dummy.c <<EOF
+#ifdef __cplusplus
+	int main (int argc, char *argv[]) {
+#else
+	int main (argc, argv) int argc; char *argv[]; {
+#endif
+#ifdef __MIPSEB__
+  printf ("%s-unknown-linux-gnu\n", argv[1]);
+#endif
+#ifdef __MIPSEL__
+  printf ("%sel-unknown-linux-gnu\n", argv[1]);
+#endif
+  return 0;
+}
+EOF
+	  $CC_FOR_BUILD $dummy.c -o $dummy 2>/dev/null && ./$dummy "${UNAME_MACHINE}" && rm $dummy.c $dummy && exit 0
+	  rm -f $dummy.c $dummy
+	else
+	  # Either a pre-BFD a.out linker (linux-gnuoldld)
+	  # or one that does not give us useful --help.
+	  # GCC wants to distinguish between linux-gnuoldld and linux-gnuaout.
+	  # If ld does not provide *any* "supported emulations:"
+	  # that means it is gnuoldld.
+	  echo "$ld_help_string" | grep >/dev/null 2>&1 "supported emulations:"
+	  test $? != 0 && echo "${UNAME_MACHINE}-pc-linux-gnuoldld" && exit 0
+
+	  case "${UNAME_MACHINE}" in
+	  i?86)
+	    VENDOR=pc;
+	    ;;
+	  *)
+	    VENDOR=unknown;
+	    ;;
+	  esac
+	  # Determine whether the default compiler is a.out or elf
+	  cat >$dummy.c <<EOF
+#include <features.h>
+#ifdef __cplusplus
+	int main (int argc, char *argv[]) {
+#else
+	int main (argc, argv) int argc; char *argv[]; {
+#endif
+#ifdef __ELF__
+# ifdef __GLIBC__
+#  if __GLIBC__ >= 2
+    printf ("%s-${VENDOR}-linux-gnu\n", argv[1]);
+#  else
+    printf ("%s-${VENDOR}-linux-gnulibc1\n", argv[1]);
+#  endif
+# else
+   printf ("%s-${VENDOR}-linux-gnulibc1\n", argv[1]);
+# endif
+#else
+  printf ("%s-${VENDOR}-linux-gnuaout\n", argv[1]);
+#endif
+  return 0;
+}
+EOF
+	  $CC_FOR_BUILD $dummy.c -o $dummy 2>/dev/null && ./$dummy "${UNAME_MACHINE}" && rm $dummy.c $dummy && exit 0
+	  rm -f $dummy.c $dummy
+	fi ;;
+# ptx 4.0 does uname -s correctly, with DYNIX/ptx in there.  earlier versions
+# are messed up and put the nodename in both sysname and nodename.
+    i?86:DYNIX/ptx:4*:*)
+	echo i386-sequent-sysv4
+	exit 0 ;;
+    i?86:UNIX_SV:4.2MP:2.*)
+        # Unixware is an offshoot of SVR4, but it has its own version
+        # number series starting with 2...
+        # I am not positive that other SVR4 systems won't match this,
+	# I just have to hope.  -- rms.
+        # Use sysv4.2uw... so that sysv4* matches it.
+	echo ${UNAME_MACHINE}-pc-sysv4.2uw${UNAME_VERSION}
+	exit 0 ;;
+    i?86:*:4.*:* | i?86:SYSTEM_V:4.*:*)
+	UNAME_REL=`echo ${UNAME_RELEASE} | sed 's/\/MP$//'`
+	if grep Novell /usr/include/link.h >/dev/null 2>/dev/null; then
+		echo ${UNAME_MACHINE}-univel-sysv${UNAME_REL}
+	else
+		echo ${UNAME_MACHINE}-pc-sysv${UNAME_REL}
+	fi
+	exit 0 ;;
+    i?86:*:5:7*)
+        # Fixed at (any) Pentium or better
+        UNAME_MACHINE=i586
+        if [ ${UNAME_SYSTEM} = "UnixWare" ] ; then
+	    echo ${UNAME_MACHINE}-sco-sysv${UNAME_RELEASE}uw${UNAME_VERSION}
+	else
+	    echo ${UNAME_MACHINE}-pc-sysv${UNAME_RELEASE}
+	fi
+	exit 0 ;;
+    i?86:*:3.2:*)
+	if test -f /usr/options/cb.name; then
+		UNAME_REL=`sed -n 's/.*Version //p' </usr/options/cb.name`
+		echo ${UNAME_MACHINE}-pc-isc$UNAME_REL
+	elif /bin/uname -X 2>/dev/null >/dev/null ; then
+		UNAME_REL=`(/bin/uname -X|egrep Release|sed -e 's/.*= //')`
+		(/bin/uname -X|egrep i80486 >/dev/null) && UNAME_MACHINE=i486
+		(/bin/uname -X|egrep '^Machine.*Pentium' >/dev/null) \
+			&& UNAME_MACHINE=i586
+		(/bin/uname -X|egrep '^Machine.*Pent ?II' >/dev/null) \
+			&& UNAME_MACHINE=i686
+		(/bin/uname -X|egrep '^Machine.*Pentium Pro' >/dev/null) \
+			&& UNAME_MACHINE=i686
+		echo ${UNAME_MACHINE}-pc-sco$UNAME_REL
+	else
+		echo ${UNAME_MACHINE}-pc-sysv32
+	fi
+	exit 0 ;;
+    pc:*:*:*)
+        # uname -m prints for DJGPP always 'pc', but it prints nothing about
+        # the processor, so we play safe by assuming i386.
+	echo i386-pc-msdosdjgpp
+        exit 0 ;;
+    Intel:Mach:3*:*)
+	echo i386-pc-mach3
+	exit 0 ;;
+    paragon:*:*:*)
+	echo i860-intel-osf1
+	exit 0 ;;
+    i860:*:4.*:*) # i860-SVR4
+	if grep Stardent /usr/include/sys/uadmin.h >/dev/null 2>&1 ; then
+	  echo i860-stardent-sysv${UNAME_RELEASE} # Stardent Vistra i860-SVR4
+	else # Add other i860-SVR4 vendors below as they are discovered.
+	  echo i860-unknown-sysv${UNAME_RELEASE}  # Unknown i860-SVR4
+	fi
+	exit 0 ;;
+    mini*:CTIX:SYS*5:*)
+	# "miniframe"
+	echo m68010-convergent-sysv
+	exit 0 ;;
+    M68*:*:R3V[567]*:*)
+	test -r /sysV68 && echo 'm68k-motorola-sysv' && exit 0 ;;
+    3[34]??:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 4850:*:4.0:3.0)
+	OS_REL=''
+	test -r /etc/.relid \
+	&& OS_REL=.`sed -n 's/[^ ]* [^ ]* \([0-9][0-9]\).*/\1/p' < /etc/.relid`
+	/bin/uname -p 2>/dev/null | grep 86 >/dev/null \
+	  && echo i486-ncr-sysv4.3${OS_REL} && exit 0
+	/bin/uname -p 2>/dev/null | /bin/grep entium >/dev/null \
+	  && echo i586-ncr-sysv4.3${OS_REL} && exit 0 ;;
+    3[34]??:*:4.0:* | 3[34]??,*:*:4.0:*)
+        /bin/uname -p 2>/dev/null | grep 86 >/dev/null \
+          && echo i486-ncr-sysv4 && exit 0 ;;
+    m68*:LynxOS:2.*:*)
+	echo m68k-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    mc68030:UNIX_System_V:4.*:*)
+	echo m68k-atari-sysv4
+	exit 0 ;;
+    i?86:LynxOS:2.*:* | i?86:LynxOS:3.[01]*:*)
+	echo i386-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    TSUNAMI:LynxOS:2.*:*)
+	echo sparc-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    rs6000:LynxOS:2.*:* | PowerPC:LynxOS:2.*:*)
+	echo rs6000-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    SM[BE]S:UNIX_SV:*:*)
+	echo mips-dde-sysv${UNAME_RELEASE}
+	exit 0 ;;
+    RM*:ReliantUNIX-*:*:*)
+	echo mips-sni-sysv4
+	exit 0 ;;
+    RM*:SINIX-*:*:*)
+	echo mips-sni-sysv4
+	exit 0 ;;
+    *:SINIX-*:*:*)
+	if uname -p 2>/dev/null >/dev/null ; then
+		UNAME_MACHINE=`(uname -p) 2>/dev/null`
+		echo ${UNAME_MACHINE}-sni-sysv4
+	else
+		echo ns32k-sni-sysv
+	fi
+	exit 0 ;;
+    PENTIUM:CPunix:4.0*:*) # Unisys `ClearPath HMP IX 4000' SVR4/MP effort
+                           # says <Richard.M.Bartel@ccMail.Census.GOV>
+        echo i586-unisys-sysv4
+        exit 0 ;;
+    *:UNIX_System_V:4*:FTX*)
+	# From Gerald Hewes <hewes@openmarket.com>.
+	# How about differentiating between stratus architectures? -djm
+	echo hppa1.1-stratus-sysv4
+	exit 0 ;;
+    *:*:*:FTX*)
+	# From seanf@swdc.stratus.com.
+	echo i860-stratus-sysv4
+	exit 0 ;;
+    mc68*:A/UX:*:*)
+	echo m68k-apple-aux${UNAME_RELEASE}
+	exit 0 ;;
+    news*:NEWS-OS:*:6*)
+	echo mips-sony-newsos6
+	exit 0 ;;
+    R[34]000:*System_V*:*:* | R4000:UNIX_SYSV:*:* | R*000:UNIX_SV:*:*)
+	if [ -d /usr/nec ]; then
+	        echo mips-nec-sysv${UNAME_RELEASE}
+	else
+	        echo mips-unknown-sysv${UNAME_RELEASE}
+	fi
+        exit 0 ;;
+    BeBox:BeOS:*:*)	# BeOS running on hardware made by Be, PPC only.
+	echo powerpc-be-beos
+	exit 0 ;;
+    BeMac:BeOS:*:*)	# BeOS running on Mac or Mac clone, PPC only.
+	echo powerpc-apple-beos
+	exit 0 ;;
+    BePC:BeOS:*:*)	# BeOS running on Intel PC compatible.
+	echo i586-pc-beos
+	exit 0 ;;
+    SX-4:SUPER-UX:*:*)
+	echo sx4-nec-superux${UNAME_RELEASE}
+	exit 0 ;;
+    SX-5:SUPER-UX:*:*)
+	echo sx5-nec-superux${UNAME_RELEASE}
+	exit 0 ;;
+    Power*:Rhapsody:*:*)
+	echo powerpc-apple-rhapsody${UNAME_RELEASE}
+	exit 0 ;;
+    *:Rhapsody:*:*)
+	echo ${UNAME_MACHINE}-apple-rhapsody${UNAME_RELEASE}
+	exit 0 ;;
+    *:QNX:*:4*)
+	echo i386-qnx-qnx${UNAME_VERSION}
+	exit 0 ;;
+esac
+
+#echo '(No uname command or uname output not recognized.)' 1>&2
+#echo "${UNAME_MACHINE}:${UNAME_SYSTEM}:${UNAME_RELEASE}:${UNAME_VERSION}" 1>&2
+
+cat >$dummy.c <<EOF
+#ifdef _SEQUENT_
+# include <sys/types.h>
+# include <sys/utsname.h>
+#endif
+main ()
+{
+#if defined (sony)
+#if defined (MIPSEB)
+  /* BFD wants "bsd" instead of "newsos".  Perhaps BFD should be changed,
+     I don't know....  */
+  printf ("mips-sony-bsd\n"); exit (0);
+#else
+#include <sys/param.h>
+  printf ("m68k-sony-newsos%s\n",
+#ifdef NEWSOS4
+          "4"
+#else
+	  ""
+#endif
+         ); exit (0);
+#endif
+#endif
+
+#if defined (__arm) && defined (__acorn) && defined (__unix)
+  printf ("arm-acorn-riscix"); exit (0);
+#endif
+
+#if defined (hp300) && !defined (hpux)
+  printf ("m68k-hp-bsd\n"); exit (0);
+#endif
+
+#if defined (NeXT)
+#if !defined (__ARCHITECTURE__)
+#define __ARCHITECTURE__ "m68k"
+#endif
+  int version;
+  version=`(hostinfo | sed -n 's/.*NeXT Mach \([0-9]*\).*/\1/p') 2>/dev/null`;
+  if (version < 4)
+    printf ("%s-next-nextstep%d\n", __ARCHITECTURE__, version);
+  else
+    printf ("%s-next-openstep%d\n", __ARCHITECTURE__, version);
+  exit (0);
+#endif
+
+#if defined (MULTIMAX) || defined (n16)
+#if defined (UMAXV)
+  printf ("ns32k-encore-sysv\n"); exit (0);
+#else
+#if defined (CMU)
+  printf ("ns32k-encore-mach\n"); exit (0);
+#else
+  printf ("ns32k-encore-bsd\n"); exit (0);
+#endif
+#endif
+#endif
+
+#if defined (__386BSD__)
+  printf ("i386-pc-bsd\n"); exit (0);
+#endif
+
+#if defined (sequent)
+#if defined (i386)
+  printf ("i386-sequent-dynix\n"); exit (0);
+#endif
+#if defined (ns32000)
+  printf ("ns32k-sequent-dynix\n"); exit (0);
+#endif
+#endif
+
+#if defined (_SEQUENT_)
+    struct utsname un;
+
+    uname(&un);
+
+    if (strncmp(un.version, "V2", 2) == 0) {
+	printf ("i386-sequent-ptx2\n"); exit (0);
+    }
+    if (strncmp(un.version, "V1", 2) == 0) { /* XXX is V1 correct? */
+	printf ("i386-sequent-ptx1\n"); exit (0);
+    }
+    printf ("i386-sequent-ptx\n"); exit (0);
+
+#endif
+
+#if defined (vax)
+#if !defined (ultrix)
+  printf ("vax-dec-bsd\n"); exit (0);
+#else
+  printf ("vax-dec-ultrix\n"); exit (0);
+#endif
+#endif
+
+#if defined (alliant) && defined (i860)
+  printf ("i860-alliant-bsd\n"); exit (0);
+#endif
+
+  exit (1);
+}
+EOF
+
+$CC_FOR_BUILD $dummy.c -o $dummy 2>/dev/null && ./$dummy && rm $dummy.c $dummy && exit 0
+rm -f $dummy.c $dummy
+
+# Apollos put the system type in the environment.
+
+test -d /usr/apollo && { echo ${ISP}-apollo-${SYSTYPE}; exit 0; }
+
+# Convex versions that predate uname can use getsysinfo(1)
+
+if [ -x /usr/convex/getsysinfo ]
+then
+    case `getsysinfo -f cpu_type` in
+    c1*)
+	echo c1-convex-bsd
+	exit 0 ;;
+    c2*)
+	if getsysinfo -f scalar_acc
+	then echo c32-convex-bsd
+	else echo c2-convex-bsd
+	fi
+	exit 0 ;;
+    c34*)
+	echo c34-convex-bsd
+	exit 0 ;;
+    c38*)
+	echo c38-convex-bsd
+	exit 0 ;;
+    c4*)
+	echo c4-convex-bsd
+	exit 0 ;;
+    esac
+fi
+
+#echo '(Unable to guess system type)' 1>&2
+
+exit 1
diff -uNr tac_plus.F4.0.3.alpha/config.h.in 081101/config.h.in
--- tac_plus.F4.0.3.alpha/config.h.in	Thu Jan  1 02:00:00 1970
+++ 081101/config.h.in	Wed Oct 31 14:50:28 2001
@@ -0,0 +1,91 @@
+/* config.h.in.  Generated automatically from configure.in by autoheader.  */
+
+/* Define to empty if the keyword does not work.  */
+#undef const
+
+/* Define if you don't have vprintf but do have _doprnt.  */
+#undef HAVE_DOPRNT
+
+/* Define if you have the vprintf function.  */
+#undef HAVE_VPRINTF
+
+/* Define if you have the wait3 system call.  */
+#undef HAVE_WAIT3
+
+/* Define as the return type of signal handlers (int or void).  */
+#undef RETSIGTYPE
+
+/* Define if the `setpgrp' function takes no argument.  */
+#undef SETPGRP_VOID
+
+/* Define if you have the ANSI C header files.  */
+#undef STDC_HEADERS
+
+/* Define if you can safely include both <sys/time.h> and <time.h>.  */
+#undef TIME_WITH_SYS_TIME
+
+/* Define if you have the regcomp function.  */
+#undef HAVE_REGCOMP
+
+/* Define if you have the select function.  */
+#undef HAVE_SELECT
+
+/* Define if you have the socket function.  */
+#undef HAVE_SOCKET
+
+/* Define if you have the strcspn function.  */
+#undef HAVE_STRCSPN
+
+/* Define if you have the strdup function.  */
+#undef HAVE_STRDUP
+
+/* Define if you have the strstr function.  */
+#undef HAVE_STRSTR
+
+/* Define if you have the strtol function.  */
+#undef HAVE_STRTOL
+
+/* Define if you have the <fcntl.h> header file.  */
+#undef HAVE_FCNTL_H
+
+/* Define if you have the <malloc.h> header file.  */
+#undef HAVE_MALLOC_H
+
+/* Define if you have the <strings.h> header file.  */
+#undef HAVE_STRINGS_H
+
+/* Define if you have the <sys/file.h> header file.  */
+#undef HAVE_SYS_FILE_H
+
+/* Define if you have the <sys/ioctl.h> header file.  */
+#undef HAVE_SYS_IOCTL_H
+
+/* Define if you have the <sys/time.h> header file.  */
+#undef HAVE_SYS_TIME_H
+
+/* Define if you have the <syslog.h> header file.  */
+#undef HAVE_SYSLOG_H
+
+/* Define if you have the <unistd.h> header file.  */
+#undef HAVE_UNISTD_H
+
+/* Define if you have the c library (-lc).  */
+#undef HAVE_LIBC
+
+/* Define if you have the crypt library (-lcrypt).  */
+#undef HAVE_LIBCRYPT
+
+/* Define if you have the dl library (-ldl).  */
+#undef HAVE_LIBDL
+
+/* Define if you have the og library (-log).  */
+#undef HAVE_LIBOG
+
+/* Define if you have the pam library (-lpam).  */
+#undef HAVE_LIBPAM
+
+/* Define this if you have shadow passwords in /etc/passwd and
+ * /etc/shadow. Note that you usually need to be root to read
+ * /etc/shadow */
+#undef SHADOW_PASSWORDS
+
diff -uNr tac_plus.F4.0.3.alpha/config.sub 081101/config.sub
--- tac_plus.F4.0.3.alpha/config.sub	Thu Jan  1 02:00:00 1970
+++ 081101/config.sub	Wed Oct 31 14:50:28 2001
@@ -0,0 +1,1232 @@
+#! /bin/sh
+# Configuration validation subroutine script, version 1.1.
+#   Copyright (C) 1991, 92-97, 1998, 1999 Free Software Foundation, Inc.
+# This file is (in principle) common to ALL GNU software.
+# The presence of a machine in this file suggests that SOME GNU software
+# can handle that machine.  It does not imply ALL GNU software can.
+#
+# This file is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330,
+# Boston, MA 02111-1307, USA.
+
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+# Configuration subroutine to validate and canonicalize a configuration type.
+# Supply the specified configuration type as an argument.
+# If it is invalid, we print an error message on stderr and exit with code 1.
+# Otherwise, we print the canonical config type on stdout and succeed.
+
+# This file is supposed to be the same for all GNU packages
+# and recognize all the CPU types, system types and aliases
+# that are meaningful with *any* GNU software.
+# Each package is responsible for reporting which valid configurations
+# it does not support.  The user should be able to distinguish
+# a failure to support a valid configuration from a meaningless
+# configuration.
+
+# The goal of this file is to map all the various variations of a given
+# machine specification into a single specification in the form:
+#	CPU_TYPE-MANUFACTURER-OPERATING_SYSTEM
+# or in some cases, the newer four-part form:
+#	CPU_TYPE-MANUFACTURER-KERNEL-OPERATING_SYSTEM
+# It is wrong to echo any other type of specification.
+
+if [ x$1 = x ]
+then
+	echo Configuration name missing. 1>&2
+	echo "Usage: $0 CPU-MFR-OPSYS" 1>&2
+	echo "or     $0 ALIAS" 1>&2
+	echo where ALIAS is a recognized configuration type. 1>&2
+	exit 1
+fi
+
+# First pass through any local machine types.
+case $1 in
+	*local*)
+		echo $1
+		exit 0
+		;;
+	*)
+	;;
+esac
+
+# Separate what the user gave into CPU-COMPANY and OS or KERNEL-OS (if any).
+# Here we must recognize all the valid KERNEL-OS combinations.
+maybe_os=`echo $1 | sed 's/^\(.*\)-\([^-]*-[^-]*\)$/\2/'`
+case $maybe_os in
+  linux-gnu*)
+    os=-$maybe_os
+    basic_machine=`echo $1 | sed 's/^\(.*\)-\([^-]*-[^-]*\)$/\1/'`
+    ;;
+  *)
+    basic_machine=`echo $1 | sed 's/-[^-]*$//'`
+    if [ $basic_machine != $1 ]
+    then os=`echo $1 | sed 's/.*-/-/'`
+    else os=; fi
+    ;;
+esac
+
+### Let's recognize common machines as not being operating systems so
+### that things like config.sub decstation-3100 work.  We also
+### recognize some manufacturers as not being operating systems, so we
+### can provide default operating systems below.
+case $os in
+	-sun*os*)
+		# Prevent following clause from handling this invalid input.
+		;;
+	-dec* | -mips* | -sequent* | -encore* | -pc532* | -sgi* | -sony* | \
+	-att* | -7300* | -3300* | -delta* | -motorola* | -sun[234]* | \
+	-unicom* | -ibm* | -next | -hp | -isi* | -apollo | -altos* | \
+	-convergent* | -ncr* | -news | -32* | -3600* | -3100* | -hitachi* |\
+	-c[123]* | -convex* | -sun | -crds | -omron* | -dg | -ultra | -tti* | \
+	-harris | -dolphin | -highlevel | -gould | -cbm | -ns | -masscomp | \
+	-apple)
+		os=
+		basic_machine=$1
+		;;
+	-sim | -cisco | -oki | -wec | -winbond)
+		os=
+		basic_machine=$1
+		;;
+	-scout)
+		;;
+	-wrs)
+		os=-vxworks
+		basic_machine=$1
+		;;
+	-hiux*)
+		os=-hiuxwe2
+		;;
+	-sco5)
+		os=-sco3.2v5
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco4)
+		os=-sco3.2v4
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco3.2.[4-9]*)
+		os=`echo $os | sed -e 's/sco3.2./sco3.2v/'`
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco3.2v[4-9]*)
+		# Don't forget version if it is 3.2v4 or newer.
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco*)
+		os=-sco3.2v2
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-udk*)
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-isc)
+		os=-isc2.2
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-clix*)
+		basic_machine=clipper-intergraph
+		;;
+	-isc*)
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-lynx*)
+		os=-lynxos
+		;;
+	-ptx*)
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-sequent/'`
+		;;
+	-windowsnt*)
+		os=`echo $os | sed -e 's/windowsnt/winnt/'`
+		;;
+	-psos*)
+		os=-psos
+		;;
+	-mint | -mint[0-9]*)
+		basic_machine=m68k-atari
+		os=-mint
+		;;
+esac
+
+# Decode aliases for certain CPU-COMPANY combinations.
+case $basic_machine in
+	# Recognize the basic CPU types without company name.
+	# Some are omitted here because they have special meanings below.
+	tahoe | i860 | ia64 | m32r | m68k | m68000 | m88k | ns32k | arc | arm \
+		| arme[lb] | pyramid | mn10200 | mn10300 | tron | a29k \
+		| 580 | i960 | h8300 \
+		| hppa | hppa1.0 | hppa1.1 | hppa2.0 | hppa2.0w | hppa2.0n \
+		| alpha | alphaev[4-7] | alphaev56 | alphapca5[67] \
+		| we32k | ns16k | clipper | i370 | sh | powerpc | powerpcle \
+		| 1750a | dsp16xx | pdp11 | mips16 | mips64 | mipsel | mips64el \
+		| mips64orion | mips64orionel | mipstx39 | mipstx39el \
+		| mips64vr4300 | mips64vr4300el | mips64vr4100 | mips64vr4100el \
+		| mips64vr5000 | miprs64vr5000el | mcore \
+		| sparc | sparclet | sparclite | sparc64 | sparcv9 | v850 | c4x \
+		| thumb | d10v | fr30)
+		basic_machine=$basic_machine-unknown
+		;;
+	m88110 | m680[12346]0 | m683?2 | m68360 | m5200 | z8k | v70 | h8500 | w65 | pj | pjl)
+		;;
+
+	# We use `pc' rather than `unknown'
+	# because (1) that's what they normally are, and
+	# (2) the word "unknown" tends to confuse beginning users.
+	i[34567]86)
+	  basic_machine=$basic_machine-pc
+	  ;;
+	# Object if more than one company name word.
+	*-*-*)
+		echo Invalid configuration \`$1\': machine \`$basic_machine\' not recognized 1>&2
+		exit 1
+		;;
+	# Recognize the basic CPU types with company name.
+	# FIXME: clean up the formatting here.
+	vax-* | tahoe-* | i[34567]86-* | i860-* | ia64-* | m32r-* | m68k-* | m68000-* \
+	      | m88k-* | sparc-* | ns32k-* | fx80-* | arc-* | arm-* | c[123]* \
+	      | mips-* | pyramid-* | tron-* | a29k-* | romp-* | rs6000-* \
+	      | power-* | none-* | 580-* | cray2-* | h8300-* | h8500-* | i960-* \
+	      | xmp-* | ymp-* \
+	      | hppa-* | hppa1.0-* | hppa1.1-* | hppa2.0-* | hppa2.0w-* | hppa2.0n-* \
+	      | alpha-* | alphaev[4-7]-* | alphaev56-* | alphapca5[67]-* \
+	      | we32k-* | cydra-* | ns16k-* | pn-* | np1-* | xps100-* \
+	      | clipper-* | orion-* \
+	      | sparclite-* | pdp11-* | sh-* | powerpc-* | powerpcle-* \
+	      | sparc64-* | sparcv9-* | sparc86x-* | mips16-* | mips64-* | mipsel-* \
+	      | mips64el-* | mips64orion-* | mips64orionel-* \
+	      | mips64vr4100-* | mips64vr4100el-* | mips64vr4300-* | mips64vr4300el-* \
+	      | mipstx39-* | mipstx39el-* | mcore-* \
+	      | f301-* | armv*-* | t3e-* \
+	      | m88110-* | m680[01234]0-* | m683?2-* | m68360-* | z8k-* | d10v-* \
+	      | thumb-* | v850-* | d30v-* | tic30-* | c30-* | fr30-* )
+		;;
+	# Recognize the various machine names and aliases which stand
+	# for a CPU type and a company and sometimes even an OS.
+	386bsd)
+		basic_machine=i386-unknown
+		os=-bsd
+		;;
+	3b1 | 7300 | 7300-att | att-7300 | pc7300 | safari | unixpc)
+		basic_machine=m68000-att
+		;;
+	3b*)
+		basic_machine=we32k-att
+		;;
+	a29khif)
+		basic_machine=a29k-amd
+		os=-udi
+		;;
+	adobe68k)
+		basic_machine=m68010-adobe
+		os=-scout
+		;;
+	alliant | fx80)
+		basic_machine=fx80-alliant
+		;;
+	altos | altos3068)
+		basic_machine=m68k-altos
+		;;
+	am29k)
+		basic_machine=a29k-none
+		os=-bsd
+		;;
+	amdahl)
+		basic_machine=580-amdahl
+		os=-sysv
+		;;
+	amiga | amiga-*)
+		basic_machine=m68k-cbm
+		;;
+	amigaos | amigados)
+		basic_machine=m68k-cbm
+		os=-amigaos
+		;;
+	amigaunix | amix)
+		basic_machine=m68k-cbm
+		os=-sysv4
+		;;
+	apollo68)
+		basic_machine=m68k-apollo
+		os=-sysv
+		;;
+	apollo68bsd)
+		basic_machine=m68k-apollo
+		os=-bsd
+		;;
+	aux)
+		basic_machine=m68k-apple
+		os=-aux
+		;;
+	balance)
+		basic_machine=ns32k-sequent
+		os=-dynix
+		;;
+	convex-c1)
+		basic_machine=c1-convex
+		os=-bsd
+		;;
+	convex-c2)
+		basic_machine=c2-convex
+		os=-bsd
+		;;
+	convex-c32)
+		basic_machine=c32-convex
+		os=-bsd
+		;;
+	convex-c34)
+		basic_machine=c34-convex
+		os=-bsd
+		;;
+	convex-c38)
+		basic_machine=c38-convex
+		os=-bsd
+		;;
+	cray | ymp)
+		basic_machine=ymp-cray
+		os=-unicos
+		;;
+	cray2)
+		basic_machine=cray2-cray
+		os=-unicos
+		;;
+	[ctj]90-cray)
+		basic_machine=c90-cray
+		os=-unicos
+		;;
+	crds | unos)
+		basic_machine=m68k-crds
+		;;
+	da30 | da30-*)
+		basic_machine=m68k-da30
+		;;
+	decstation | decstation-3100 | pmax | pmax-* | pmin | dec3100 | decstatn)
+		basic_machine=mips-dec
+		;;
+	delta | 3300 | motorola-3300 | motorola-delta \
+	      | 3300-motorola | delta-motorola)
+		basic_machine=m68k-motorola
+		;;
+	delta88)
+		basic_machine=m88k-motorola
+		os=-sysv3
+		;;
+	dpx20 | dpx20-*)
+		basic_machine=rs6000-bull
+		os=-bosx
+		;;
+	dpx2* | dpx2*-bull)
+		basic_machine=m68k-bull
+		os=-sysv3
+		;;
+	ebmon29k)
+		basic_machine=a29k-amd
+		os=-ebmon
+		;;
+	elxsi)
+		basic_machine=elxsi-elxsi
+		os=-bsd
+		;;
+	encore | umax | mmax)
+		basic_machine=ns32k-encore
+		;;
+	es1800 | OSE68k | ose68k | ose | OSE)
+		basic_machine=m68k-ericsson
+		os=-ose
+		;;
+	fx2800)
+		basic_machine=i860-alliant
+		;;
+	genix)
+		basic_machine=ns32k-ns
+		;;
+	gmicro)
+		basic_machine=tron-gmicro
+		os=-sysv
+		;;
+	h3050r* | hiux*)
+		basic_machine=hppa1.1-hitachi
+		os=-hiuxwe2
+		;;
+	h8300hms)
+		basic_machine=h8300-hitachi
+		os=-hms
+		;;
+	h8300xray)
+		basic_machine=h8300-hitachi
+		os=-xray
+		;;
+	h8500hms)
+		basic_machine=h8500-hitachi
+		os=-hms
+		;;
+	harris)
+		basic_machine=m88k-harris
+		os=-sysv3
+		;;
+	hp300-*)
+		basic_machine=m68k-hp
+		;;
+	hp300bsd)
+		basic_machine=m68k-hp
+		os=-bsd
+		;;
+	hp300hpux)
+		basic_machine=m68k-hp
+		os=-hpux
+		;;
+	hp3k9[0-9][0-9] | hp9[0-9][0-9])
+		basic_machine=hppa1.0-hp
+		;;
+	hp9k2[0-9][0-9] | hp9k31[0-9])
+		basic_machine=m68000-hp
+		;;
+	hp9k3[2-9][0-9])
+		basic_machine=m68k-hp
+		;;
+	hp9k6[0-9][0-9] | hp6[0-9][0-9])
+		basic_machine=hppa1.0-hp
+		;;
+	hp9k7[0-79][0-9] | hp7[0-79][0-9])
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k78[0-9] | hp78[0-9])
+		# FIXME: really hppa2.0-hp
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k8[67]1 | hp8[67]1 | hp9k80[24] | hp80[24] | hp9k8[78]9 | hp8[78]9 | hp9k893 | hp893)
+		# FIXME: really hppa2.0-hp
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k8[0-9][13679] | hp8[0-9][13679])
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k8[0-9][0-9] | hp8[0-9][0-9])
+		basic_machine=hppa1.0-hp
+		;;
+	hppa-next)
+		os=-nextstep3
+		;;
+	hppaosf)
+		basic_machine=hppa1.1-hp
+		os=-osf
+		;;
+	hppro)
+		basic_machine=hppa1.1-hp
+		os=-proelf
+		;;
+	i370-ibm* | ibm*)
+		basic_machine=i370-ibm
+		;;
+# I'm not sure what "Sysv32" means.  Should this be sysv3.2?
+	i[34567]86v32)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-sysv32
+		;;
+	i[34567]86v4*)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-sysv4
+		;;
+	i[34567]86v)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-sysv
+		;;
+	i[34567]86sol2)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-solaris2
+		;;
+	i386mach)
+		basic_machine=i386-mach
+		os=-mach
+		;;
+	i386-vsta | vsta)
+		basic_machine=i386-unknown
+		os=-vsta
+		;;
+	i386-go32 | go32)
+		basic_machine=i386-unknown
+		os=-go32
+		;;
+	i386-mingw32 | mingw32)
+		basic_machine=i386-unknown
+		os=-mingw32
+		;;
+	i386-qnx | qnx)
+		basic_machine=i386-qnx
+		;;
+	iris | iris4d)
+		basic_machine=mips-sgi
+		case $os in
+		    -irix*)
+			;;
+		    *)
+			os=-irix4
+			;;
+		esac
+		;;
+	isi68 | isi)
+		basic_machine=m68k-isi
+		os=-sysv
+		;;
+	m88k-omron*)
+		basic_machine=m88k-omron
+		;;
+	magnum | m3230)
+		basic_machine=mips-mips
+		os=-sysv
+		;;
+	merlin)
+		basic_machine=ns32k-utek
+		os=-sysv
+		;;
+	miniframe)
+		basic_machine=m68000-convergent
+		;;
+	*mint | -mint[0-9]* | *MiNT | *MiNT[0-9]*)
+		basic_machine=m68k-atari
+		os=-mint
+		;;
+	mipsel*-linux*)
+		basic_machine=mipsel-unknown
+		os=-linux-gnu
+		;;
+	mips*-linux*)
+		basic_machine=mips-unknown
+		os=-linux-gnu
+		;;
+	mips3*-*)
+		basic_machine=`echo $basic_machine | sed -e 's/mips3/mips64/'`
+		;;
+	mips3*)
+		basic_machine=`echo $basic_machine | sed -e 's/mips3/mips64/'`-unknown
+		;;
+	monitor)
+		basic_machine=m68k-rom68k
+		os=-coff
+		;;
+	msdos)
+		basic_machine=i386-unknown
+		os=-msdos
+		;;
+	mvs)
+		basic_machine=i370-ibm
+		os=-mvs
+		;;
+	ncr3000)
+		basic_machine=i486-ncr
+		os=-sysv4
+		;;
+	netbsd386)
+		basic_machine=i386-unknown
+		os=-netbsd
+		;;
+	netwinder)
+		basic_machine=armv4l-rebel
+		os=-linux
+		;;
+	news | news700 | news800 | news900)
+		basic_machine=m68k-sony
+		os=-newsos
+		;;
+	news1000)
+		basic_machine=m68030-sony
+		os=-newsos
+		;;
+	news-3600 | risc-news)
+		basic_machine=mips-sony
+		os=-newsos
+		;;
+	necv70)
+		basic_machine=v70-nec
+		os=-sysv
+		;;
+	next | m*-next )
+		basic_machine=m68k-next
+		case $os in
+		    -nextstep* )
+			;;
+		    -ns2*)
+		      os=-nextstep2
+			;;
+		    *)
+		      os=-nextstep3
+			;;
+		esac
+		;;
+	nh3000)
+		basic_machine=m68k-harris
+		os=-cxux
+		;;
+	nh[45]000)
+		basic_machine=m88k-harris
+		os=-cxux
+		;;
+	nindy960)
+		basic_machine=i960-intel
+		os=-nindy
+		;;
+	mon960)
+		basic_machine=i960-intel
+		os=-mon960
+		;;
+	np1)
+		basic_machine=np1-gould
+		;;
+	op50n-* | op60c-*)
+		basic_machine=hppa1.1-oki
+		os=-proelf
+		;;
+	OSE68000 | ose68000)
+		basic_machine=m68000-ericsson
+		os=-ose
+		;;
+	os68k)
+		basic_machine=m68k-none
+		os=-os68k
+		;;
+	pa-hitachi)
+		basic_machine=hppa1.1-hitachi
+		os=-hiuxwe2
+		;;
+	paragon)
+		basic_machine=i860-intel
+		os=-osf
+		;;
+	pbd)
+		basic_machine=sparc-tti
+		;;
+	pbb)
+		basic_machine=m68k-tti
+		;;
+        pc532 | pc532-*)
+		basic_machine=ns32k-pc532
+		;;
+	pentium | p5 | k5 | k6 | nexen)
+		basic_machine=i586-pc
+		;;
+	pentiumpro | p6 | 6x86)
+		basic_machine=i686-pc
+		;;
+	pentiumii | pentium2)
+		basic_machine=i786-pc
+		;;
+	pentium-* | p5-* | k5-* | k6-* | nexen-*)
+		basic_machine=i586-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	pentiumpro-* | p6-* | 6x86-*)
+		basic_machine=i686-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	pentiumii-* | pentium2-*)
+		basic_machine=i786-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	pn)
+		basic_machine=pn-gould
+		;;
+	power)	basic_machine=rs6000-ibm
+		;;
+	ppc)	basic_machine=powerpc-unknown
+	        ;;
+	ppc-*)	basic_machine=powerpc-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	ppcle | powerpclittle | ppc-le | powerpc-little)
+		basic_machine=powerpcle-unknown
+	        ;;
+	ppcle-* | powerpclittle-*)
+		basic_machine=powerpcle-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	ps2)
+		basic_machine=i386-ibm
+		;;
+	rom68k)
+		basic_machine=m68k-rom68k
+		os=-coff
+		;;
+	rm[46]00)
+		basic_machine=mips-siemens
+		;;
+	rtpc | rtpc-*)
+		basic_machine=romp-ibm
+		;;
+	sa29200)
+		basic_machine=a29k-amd
+		os=-udi
+		;;
+	sequent)
+		basic_machine=i386-sequent
+		;;
+	sh)
+		basic_machine=sh-hitachi
+		os=-hms
+		;;
+	sparclite-wrs)
+		basic_machine=sparclite-wrs
+		os=-vxworks
+		;;
+	sps7)
+		basic_machine=m68k-bull
+		os=-sysv2
+		;;
+	spur)
+		basic_machine=spur-unknown
+		;;
+	st2000)
+		basic_machine=m68k-tandem
+		;;
+	stratus)
+		basic_machine=i860-stratus
+		os=-sysv4
+		;;
+	sun2)
+		basic_machine=m68000-sun
+		;;
+	sun2os3)
+		basic_machine=m68000-sun
+		os=-sunos3
+		;;
+	sun2os4)
+		basic_machine=m68000-sun
+		os=-sunos4
+		;;
+	sun3os3)
+		basic_machine=m68k-sun
+		os=-sunos3
+		;;
+	sun3os4)
+		basic_machine=m68k-sun
+		os=-sunos4
+		;;
+	sun4os3)
+		basic_machine=sparc-sun
+		os=-sunos3
+		;;
+	sun4os4)
+		basic_machine=sparc-sun
+		os=-sunos4
+		;;
+	sun4sol2)
+		basic_machine=sparc-sun
+		os=-solaris2
+		;;
+	sun3 | sun3-*)
+		basic_machine=m68k-sun
+		;;
+	sun4)
+		basic_machine=sparc-sun
+		;;
+	sun386 | sun386i | roadrunner)
+		basic_machine=i386-sun
+		;;
+	symmetry)
+		basic_machine=i386-sequent
+		os=-dynix
+		;;
+	t3e)
+		basic_machine=t3e-cray
+		os=-unicos
+		;;
+	tx39)
+		basic_machine=mipstx39-unknown
+		;;
+	tx39el)
+		basic_machine=mipstx39el-unknown
+		;;
+	tower | tower-32)
+		basic_machine=m68k-ncr
+		;;
+	udi29k)
+		basic_machine=a29k-amd
+		os=-udi
+		;;
+	ultra3)
+		basic_machine=a29k-nyu
+		os=-sym1
+		;;
+	v810 | necv810)
+		basic_machine=v810-nec
+		os=-none
+		;;
+	vaxv)
+		basic_machine=vax-dec
+		os=-sysv
+		;;
+	vms)
+		basic_machine=vax-dec
+		os=-vms
+		;;
+	vpp*|vx|vx-*)
+               basic_machine=f301-fujitsu
+               ;;
+	vxworks960)
+		basic_machine=i960-wrs
+		os=-vxworks
+		;;
+	vxworks68)
+		basic_machine=m68k-wrs
+		os=-vxworks
+		;;
+	vxworks29k)
+		basic_machine=a29k-wrs
+		os=-vxworks
+		;;
+	w65*)
+		basic_machine=w65-wdc
+		os=-none
+		;;
+	w89k-*)
+		basic_machine=hppa1.1-winbond
+		os=-proelf
+		;;
+	xmp)
+		basic_machine=xmp-cray
+		os=-unicos
+		;;
+        xps | xps100)
+		basic_machine=xps100-honeywell
+		;;
+	z8k-*-coff)
+		basic_machine=z8k-unknown
+		os=-sim
+		;;
+	none)
+		basic_machine=none-none
+		os=-none
+		;;
+
+# Here we handle the default manufacturer of certain CPU types.  It is in
+# some cases the only manufacturer, in others, it is the most popular.
+	w89k)
+		basic_machine=hppa1.1-winbond
+		;;
+	op50n)
+		basic_machine=hppa1.1-oki
+		;;
+	op60c)
+		basic_machine=hppa1.1-oki
+		;;
+	mips)
+		if [ x$os = x-linux-gnu ]; then
+			basic_machine=mips-unknown
+		else
+			basic_machine=mips-mips
+		fi
+		;;
+	romp)
+		basic_machine=romp-ibm
+		;;
+	rs6000)
+		basic_machine=rs6000-ibm
+		;;
+	vax)
+		basic_machine=vax-dec
+		;;
+	pdp11)
+		basic_machine=pdp11-dec
+		;;
+	we32k)
+		basic_machine=we32k-att
+		;;
+	sparc | sparcv9)
+		basic_machine=sparc-sun
+		;;
+        cydra)
+		basic_machine=cydra-cydrome
+		;;
+	orion)
+		basic_machine=orion-highlevel
+		;;
+	orion105)
+		basic_machine=clipper-highlevel
+		;;
+	mac | mpw | mac-mpw)
+		basic_machine=m68k-apple
+		;;
+	pmac | pmac-mpw)
+		basic_machine=powerpc-apple
+		;;
+	c4x*)
+		basic_machine=c4x-none
+		os=-coff
+		;;
+	*)
+		echo Invalid configuration \`$1\': machine \`$basic_machine\' not recognized 1>&2
+		exit 1
+		;;
+esac
+
+# Here we canonicalize certain aliases for manufacturers.
+case $basic_machine in
+	*-digital*)
+		basic_machine=`echo $basic_machine | sed 's/digital.*/dec/'`
+		;;
+	*-commodore*)
+		basic_machine=`echo $basic_machine | sed 's/commodore.*/cbm/'`
+		;;
+	*)
+		;;
+esac
+
+# Decode manufacturer-specific aliases for certain operating systems.
+
+if [ x"$os" != x"" ]
+then
+case $os in
+        # First match some system type aliases
+        # that might get confused with valid system types.
+	# -solaris* is a basic system type, with this one exception.
+	-solaris1 | -solaris1.*)
+		os=`echo $os | sed -e 's|solaris1|sunos4|'`
+		;;
+	-solaris)
+		os=-solaris2
+		;;
+	-svr4*)
+		os=-sysv4
+		;;
+	-unixware*)
+		os=-sysv4.2uw
+		;;
+	-gnu/linux*)
+		os=`echo $os | sed -e 's|gnu/linux|linux-gnu|'`
+		;;
+	# First accept the basic system types.
+	# The portable systems comes first.
+	# Each alternative MUST END IN A *, to match a version number.
+	# -sysv* is not here because it comes later, after sysvr4.
+	-gnu* | -bsd* | -mach* | -minix* | -genix* | -ultrix* | -irix* \
+	      | -*vms* | -sco* | -esix* | -isc* | -aix* | -sunos | -sunos[34]*\
+	      | -hpux* | -unos* | -osf* | -luna* | -dgux* | -solaris* | -sym* \
+	      | -amigaos* | -amigados* | -msdos* | -newsos* | -unicos* | -aof* \
+	      | -aos* \
+	      | -nindy* | -vxsim* | -vxworks* | -ebmon* | -hms* | -mvs* \
+	      | -clix* | -riscos* | -uniplus* | -iris* | -rtu* | -xenix* \
+	      | -hiux* | -386bsd* | -netbsd* | -openbsd* | -freebsd* | -riscix* \
+	      | -lynxos* | -bosx* | -nextstep* | -cxux* | -aout* | -elf* | -oabi* \
+	      | -ptx* | -coff* | -ecoff* | -winnt* | -domain* | -vsta* \
+	      | -udi* | -eabi* | -lites* | -ieee* | -go32* | -aux* \
+	      | -cygwin* | -pe* | -psos* | -moss* | -proelf* | -rtems* \
+	      | -mingw32* | -linux-gnu* | -uxpv* | -beos* | -mpeix* | -udk* \
+	      | -interix* | -uwin* | -rhapsody* | -opened* | -openstep* | -oskit*)
+	# Remember, each alternative MUST END IN *, to match a version number.
+		;;
+	-sim | -es1800* | -hms* | -xray | -os68k* | -none* | -v88r* \
+	      | -windows* | -osx | -abug | -netware* | -os9* | -beos* \
+	      | -macos* | -mpw* | -magic* | -mon960* | -lnews*)
+		;;
+	-mac*)
+		os=`echo $os | sed -e 's|mac|macos|'`
+		;;
+	-linux*)
+		os=`echo $os | sed -e 's|linux|linux-gnu|'`
+		;;
+	-sunos5*)
+		os=`echo $os | sed -e 's|sunos5|solaris2|'`
+		;;
+	-sunos6*)
+		os=`echo $os | sed -e 's|sunos6|solaris3|'`
+		;;
+	-opened*)
+		os=-openedition
+		;;
+	-osfrose*)
+		os=-osfrose
+		;;
+	-osf*)
+		os=-osf
+		;;
+	-utek*)
+		os=-bsd
+		;;
+	-dynix*)
+		os=-bsd
+		;;
+	-acis*)
+		os=-aos
+		;;
+	-386bsd)
+		os=-bsd
+		;;
+	-ctix* | -uts*)
+		os=-sysv
+		;;
+	-ns2 )
+	        os=-nextstep2
+		;;
+	# Preserve the version number of sinix5.
+	-sinix5.*)
+		os=`echo $os | sed -e 's|sinix|sysv|'`
+		;;
+	-sinix*)
+		os=-sysv4
+		;;
+	-triton*)
+		os=-sysv3
+		;;
+	-oss*)
+		os=-sysv3
+		;;
+        -qnx)
+		os=-qnx4
+		;;
+	-svr4)
+		os=-sysv4
+		;;
+	-svr3)
+		os=-sysv3
+		;;
+	-sysvr4)
+		os=-sysv4
+		;;
+	# This must come after -sysvr4.
+	-sysv*)
+		;;
+	-ose*)
+		os=-ose
+		;;
+	-es1800*)
+		os=-ose
+		;;
+	-xenix)
+		os=-xenix
+		;;
+        -*mint | -*MiNT)
+	        os=-mint
+		;;
+	-none)
+		;;
+	*)
+		# Get rid of the `-' at the beginning of $os.
+		os=`echo $os | sed 's/[^-]*-//'`
+		echo Invalid configuration \`$1\': system \`$os\' not recognized 1>&2
+		exit 1
+		;;
+esac
+else
+
+# Here we handle the default operating systems that come with various machines.
+# The value should be what the vendor currently ships out the door with their
+# machine or put another way, the most popular os provided with the machine.
+
+# Note that if you're going to try to match "-MANUFACTURER" here (say,
+# "-sun"), then you have to tell the case statement up towards the top
+# that MANUFACTURER isn't an operating system.  Otherwise, code above
+# will signal an error saying that MANUFACTURER isn't an operating
+# system, and we'll never get to this point.
+
+case $basic_machine in
+	*-acorn)
+		os=-riscix1.2
+		;;
+	arm*-rebel)
+		os=-linux
+		;;
+	arm*-semi)
+		os=-aout
+		;;
+        pdp11-*)
+		os=-none
+		;;
+	*-dec | vax-*)
+		os=-ultrix4.2
+		;;
+	m68*-apollo)
+		os=-domain
+		;;
+	i386-sun)
+		os=-sunos4.0.2
+		;;
+	m68000-sun)
+		os=-sunos3
+		# This also exists in the configure program, but was not the
+		# default.
+		# os=-sunos4
+		;;
+	m68*-cisco)
+		os=-aout
+		;;
+	mips*-cisco)
+		os=-elf
+		;;
+	mips*-*)
+		os=-elf
+		;;
+	*-tti)	# must be before sparc entry or we get the wrong os.
+		os=-sysv3
+		;;
+	sparc-* | *-sun)
+		os=-sunos4.1.1
+		;;
+	*-be)
+		os=-beos
+		;;
+	*-ibm)
+		os=-aix
+		;;
+	*-wec)
+		os=-proelf
+		;;
+	*-winbond)
+		os=-proelf
+		;;
+	*-oki)
+		os=-proelf
+		;;
+	*-hp)
+		os=-hpux
+		;;
+	*-hitachi)
+		os=-hiux
+		;;
+	i860-* | *-att | *-ncr | *-altos | *-motorola | *-convergent)
+		os=-sysv
+		;;
+	*-cbm)
+		os=-amigaos
+		;;
+	*-dg)
+		os=-dgux
+		;;
+	*-dolphin)
+		os=-sysv3
+		;;
+	m68k-ccur)
+		os=-rtu
+		;;
+	m88k-omron*)
+		os=-luna
+		;;
+	*-next )
+		os=-nextstep
+		;;
+	*-sequent)
+		os=-ptx
+		;;
+	*-crds)
+		os=-unos
+		;;
+	*-ns)
+		os=-genix
+		;;
+	i370-*)
+		os=-mvs
+		;;
+	*-next)
+		os=-nextstep3
+		;;
+        *-gould)
+		os=-sysv
+		;;
+        *-highlevel)
+		os=-bsd
+		;;
+	*-encore)
+		os=-bsd
+		;;
+        *-sgi)
+		os=-irix
+		;;
+        *-siemens)
+		os=-sysv4
+		;;
+	*-masscomp)
+		os=-rtu
+		;;
+	f301-fujitsu)
+		os=-uxpv
+		;;
+	*-rom68k)
+		os=-coff
+		;;
+	*-*bug)
+		os=-coff
+		;;
+	*-apple)
+		os=-macos
+		;;
+	*-atari*)
+		os=-mint
+		;;
+	*)
+		os=-none
+		;;
+esac
+fi
+
+# Here we handle the case where we know the os, and the CPU type, but not the
+# manufacturer.  We pick the logical manufacturer.
+vendor=unknown
+case $basic_machine in
+	*-unknown)
+		case $os in
+			-riscix*)
+				vendor=acorn
+				;;
+			-sunos*)
+				vendor=sun
+				;;
+			-aix*)
+				vendor=ibm
+				;;
+			-beos*)
+				vendor=be
+				;;
+			-hpux*)
+				vendor=hp
+				;;
+			-mpeix*)
+				vendor=hp
+				;;
+			-hiux*)
+				vendor=hitachi
+				;;
+			-unos*)
+				vendor=crds
+				;;
+			-dgux*)
+				vendor=dg
+				;;
+			-luna*)
+				vendor=omron
+				;;
+			-genix*)
+				vendor=ns
+				;;
+			-mvs* | -opened*)
+				vendor=ibm
+				;;
+			-ptx*)
+				vendor=sequent
+				;;
+			-vxsim* | -vxworks*)
+				vendor=wrs
+				;;
+			-aux*)
+				vendor=apple
+				;;
+			-hms*)
+				vendor=hitachi
+				;;
+			-mpw* | -macos*)
+				vendor=apple
+				;;
+			-*mint | -*MiNT)
+				vendor=atari
+				;;
+		esac
+		basic_machine=`echo $basic_machine | sed "s/unknown/$vendor/"`
+		;;
+esac
+
+echo $basic_machine$os
diff -uNr tac_plus.F4.0.3.alpha/configure 081101/configure
--- tac_plus.F4.0.3.alpha/configure	Thu Jan  1 02:00:00 1970
+++ 081101/configure	Thu Nov  8 12:25:47 2001
@@ -0,0 +1,2926 @@
+#! /bin/sh
+
+# Guess values for system-dependent variables and create Makefiles.
+# Generated automatically using autoconf version 2.13 
+# Copyright (C) 1992, 93, 94, 95, 96 Free Software Foundation, Inc.
+#
+# This configure script is free software; the Free Software Foundation
+# gives unlimited permission to copy, distribute and modify it.
+
+# Defaults:
+ac_help=
+ac_default_prefix=/usr/local
+# Any additions from configure.in:
+ac_help="$ac_help
+  --with-pam		With PAM Support   "
+ac_help="$ac_help
+  --with-ldap		With LDAP Support   "
+ac_help="$ac_help
+  --with-db		For DB Support   "
+ac_help="$ac_help
+  --with-mysql		With MySQL Support   "
+ac_help="$ac_help
+  --with-mysql-include-dir=PREFIX  Mysql include path [default=/usr/include/mysql]"
+ac_help="$ac_help
+  --with-mysql-lib-dir=PREFIX  Mysql library path [default=/usr/lib/mysql]"
+ac_help="$ac_help
+  --with-pgsql		With PgSQL Support   "
+ac_help="$ac_help
+  --with-pgsql-include-dir=PREFIX  PgSQL include path [default=/usr/include/pgsql]"
+ac_help="$ac_help
+  --with-pgsql-lib-dir=PREFIX  PgSQL library path [default=/usr/lib/pgsql]"
+ac_help="$ac_help
+  --with-tacuid=ID	If you want to run tac_plus other than root user (no default value) "
+ac_help="$ac_help
+  --with-tacgid=GID	If you want to run tac_plus other than root group(no default value) "
+ac_help="$ac_help
+  --enable-maxsess	Enable maxsess feature "
+ac_help="$ac_help
+  --with-tacplus_pid=PREFIX  Tac_plus pid file location [default=/var/run] "
+ac_help="$ac_help
+  --with-libwrap[=PATH]   Compile in libwrap (tcp_wrappers) support."
+ac_help="$ac_help
+  --enable-finger	Enable finger at maxsess check "
+
+# Initialize some variables set by options.
+# The variables have the same names as the options, with
+# dashes changed to underlines.
+build=NONE
+cache_file=./config.cache
+exec_prefix=NONE
+host=NONE
+no_create=
+nonopt=NONE
+no_recursion=
+prefix=NONE
+program_prefix=NONE
+program_suffix=NONE
+program_transform_name=s,x,x,
+silent=
+site=
+srcdir=
+target=NONE
+verbose=
+x_includes=NONE
+x_libraries=NONE
+bindir='${exec_prefix}/bin'
+sbindir='${exec_prefix}/sbin'
+libexecdir='${exec_prefix}/libexec'
+datadir='${prefix}/share'
+sysconfdir='${prefix}/etc'
+sharedstatedir='${prefix}/com'
+localstatedir='${prefix}/var'
+libdir='${exec_prefix}/lib'
+includedir='${prefix}/include'
+oldincludedir='/usr/include'
+infodir='${prefix}/info'
+mandir='${prefix}/man'
+
+# Initialize some other variables.
+subdirs=
+MFLAGS= MAKEFLAGS=
+SHELL=${CONFIG_SHELL-/bin/sh}
+# Maximum number of lines to put in a shell here document.
+ac_max_here_lines=12
+
+ac_prev=
+for ac_option
+do
+
+  # If the previous option needs an argument, assign it.
+  if test -n "$ac_prev"; then
+    eval "$ac_prev=\$ac_option"
+    ac_prev=
+    continue
+  fi
+
+  case "$ac_option" in
+  -*=*) ac_optarg=`echo "$ac_option" | sed 's/[-_a-zA-Z0-9]*=//'` ;;
+  *) ac_optarg= ;;
+  esac
+
+  # Accept the important Cygnus configure options, so we can diagnose typos.
+
+  case "$ac_option" in
+
+  -bindir | --bindir | --bindi | --bind | --bin | --bi)
+    ac_prev=bindir ;;
+  -bindir=* | --bindir=* | --bindi=* | --bind=* | --bin=* | --bi=*)
+    bindir="$ac_optarg" ;;
+
+  -build | --build | --buil | --bui | --bu)
+    ac_prev=build ;;
+  -build=* | --build=* | --buil=* | --bui=* | --bu=*)
+    build="$ac_optarg" ;;
+
+  -cache-file | --cache-file | --cache-fil | --cache-fi \
+  | --cache-f | --cache- | --cache | --cach | --cac | --ca | --c)
+    ac_prev=cache_file ;;
+  -cache-file=* | --cache-file=* | --cache-fil=* | --cache-fi=* \
+  | --cache-f=* | --cache-=* | --cache=* | --cach=* | --cac=* | --ca=* | --c=*)
+    cache_file="$ac_optarg" ;;
+
+  -datadir | --datadir | --datadi | --datad | --data | --dat | --da)
+    ac_prev=datadir ;;
+  -datadir=* | --datadir=* | --datadi=* | --datad=* | --data=* | --dat=* \
+  | --da=*)
+    datadir="$ac_optarg" ;;
+
+  -disable-* | --disable-*)
+    ac_feature=`echo $ac_option|sed -e 's/-*disable-//'`
+    # Reject names that are not valid shell variable names.
+    if test -n "`echo $ac_feature| sed 's/[-a-zA-Z0-9_]//g'`"; then
+      { echo "configure: error: $ac_feature: invalid feature name" 1>&2; exit 1; }
+    fi
+    ac_feature=`echo $ac_feature| sed 's/-/_/g'`
+    eval "enable_${ac_feature}=no" ;;
+
+  -enable-* | --enable-*)
+    ac_feature=`echo $ac_option|sed -e 's/-*enable-//' -e 's/=.*//'`
+    # Reject names that are not valid shell variable names.
+    if test -n "`echo $ac_feature| sed 's/[-_a-zA-Z0-9]//g'`"; then
+      { echo "configure: error: $ac_feature: invalid feature name" 1>&2; exit 1; }
+    fi
+    ac_feature=`echo $ac_feature| sed 's/-/_/g'`
+    case "$ac_option" in
+      *=*) ;;
+      *) ac_optarg=yes ;;
+    esac
+    eval "enable_${ac_feature}='$ac_optarg'" ;;
+
+  -exec-prefix | --exec_prefix | --exec-prefix | --exec-prefi \
+  | --exec-pref | --exec-pre | --exec-pr | --exec-p | --exec- \
+  | --exec | --exe | --ex)
+    ac_prev=exec_prefix ;;
+  -exec-prefix=* | --exec_prefix=* | --exec-prefix=* | --exec-prefi=* \
+  | --exec-pref=* | --exec-pre=* | --exec-pr=* | --exec-p=* | --exec-=* \
+  | --exec=* | --exe=* | --ex=*)
+    exec_prefix="$ac_optarg" ;;
+
+  -gas | --gas | --ga | --g)
+    # Obsolete; use --with-gas.
+    with_gas=yes ;;
+
+  -help | --help | --hel | --he)
+    # Omit some internal or obsolete options to make the list less imposing.
+    # This message is too long to be a string in the A/UX 3.1 sh.
+    cat << EOF
+Usage: configure [options] [host]
+Options: [defaults in brackets after descriptions]
+Configuration:
+  --cache-file=FILE       cache test results in FILE
+  --help                  print this message
+  --no-create             do not create output files
+  --quiet, --silent       do not print \`checking...' messages
+  --version               print the version of autoconf that created configure
+Directory and file names:
+  --prefix=PREFIX         install architecture-independent files in PREFIX
+                          [$ac_default_prefix]
+  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
+                          [same as prefix]
+  --bindir=DIR            user executables in DIR [EPREFIX/bin]
+  --sbindir=DIR           system admin executables in DIR [EPREFIX/sbin]
+  --libexecdir=DIR        program executables in DIR [EPREFIX/libexec]
+  --datadir=DIR           read-only architecture-independent data in DIR
+                          [PREFIX/share]
+  --sysconfdir=DIR        read-only single-machine data in DIR [PREFIX/etc]
+  --sharedstatedir=DIR    modifiable architecture-independent data in DIR
+                          [PREFIX/com]
+  --localstatedir=DIR     modifiable single-machine data in DIR [PREFIX/var]
+  --libdir=DIR            object code libraries in DIR [EPREFIX/lib]
+  --includedir=DIR        C header files in DIR [PREFIX/include]
+  --oldincludedir=DIR     C header files for non-gcc in DIR [/usr/include]
+  --infodir=DIR           info documentation in DIR [PREFIX/info]
+  --mandir=DIR            man documentation in DIR [PREFIX/man]
+  --srcdir=DIR            find the sources in DIR [configure dir or ..]
+  --program-prefix=PREFIX prepend PREFIX to installed program names
+  --program-suffix=SUFFIX append SUFFIX to installed program names
+  --program-transform-name=PROGRAM
+                          run sed PROGRAM on installed program names
+EOF
+    cat << EOF
+Host type:
+  --build=BUILD           configure for building on BUILD [BUILD=HOST]
+  --host=HOST             configure for HOST [guessed]
+  --target=TARGET         configure for TARGET [TARGET=HOST]
+Features and packages:
+  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
+  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
+  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
+  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
+  --x-includes=DIR        X include files are in DIR
+  --x-libraries=DIR       X library files are in DIR
+EOF
+    if test -n "$ac_help"; then
+      echo "--enable and --with options recognized:$ac_help"
+    fi
+    exit 0 ;;
+
+  -host | --host | --hos | --ho)
+    ac_prev=host ;;
+  -host=* | --host=* | --hos=* | --ho=*)
+    host="$ac_optarg" ;;
+
+  -includedir | --includedir | --includedi | --included | --include \
+  | --includ | --inclu | --incl | --inc)
+    ac_prev=includedir ;;
+  -includedir=* | --includedir=* | --includedi=* | --included=* | --include=* \
+  | --includ=* | --inclu=* | --incl=* | --inc=*)
+    includedir="$ac_optarg" ;;
+
+  -infodir | --infodir | --infodi | --infod | --info | --inf)
+    ac_prev=infodir ;;
+  -infodir=* | --infodir=* | --infodi=* | --infod=* | --info=* | --inf=*)
+    infodir="$ac_optarg" ;;
+
+  -libdir | --libdir | --libdi | --libd)
+    ac_prev=libdir ;;
+  -libdir=* | --libdir=* | --libdi=* | --libd=*)
+    libdir="$ac_optarg" ;;
+
+  -libexecdir | --libexecdir | --libexecdi | --libexecd | --libexec \
+  | --libexe | --libex | --libe)
+    ac_prev=libexecdir ;;
+  -libexecdir=* | --libexecdir=* | --libexecdi=* | --libexecd=* | --libexec=* \
+  | --libexe=* | --libex=* | --libe=*)
+    libexecdir="$ac_optarg" ;;
+
+  -localstatedir | --localstatedir | --localstatedi | --localstated \
+  | --localstate | --localstat | --localsta | --localst \
+  | --locals | --local | --loca | --loc | --lo)
+    ac_prev=localstatedir ;;
+  -localstatedir=* | --localstatedir=* | --localstatedi=* | --localstated=* \
+  | --localstate=* | --localstat=* | --localsta=* | --localst=* \
+  | --locals=* | --local=* | --loca=* | --loc=* | --lo=*)
+    localstatedir="$ac_optarg" ;;
+
+  -mandir | --mandir | --mandi | --mand | --man | --ma | --m)
+    ac_prev=mandir ;;
+  -mandir=* | --mandir=* | --mandi=* | --mand=* | --man=* | --ma=* | --m=*)
+    mandir="$ac_optarg" ;;
+
+  -nfp | --nfp | --nf)
+    # Obsolete; use --without-fp.
+    with_fp=no ;;
+
+  -no-create | --no-create | --no-creat | --no-crea | --no-cre \
+  | --no-cr | --no-c)
+    no_create=yes ;;
+
+  -no-recursion | --no-recursion | --no-recursio | --no-recursi \
+  | --no-recurs | --no-recur | --no-recu | --no-rec | --no-re | --no-r)
+    no_recursion=yes ;;
+
+  -oldincludedir | --oldincludedir | --oldincludedi | --oldincluded \
+  | --oldinclude | --oldinclud | --oldinclu | --oldincl | --oldinc \
+  | --oldin | --oldi | --old | --ol | --o)
+    ac_prev=oldincludedir ;;
+  -oldincludedir=* | --oldincludedir=* | --oldincludedi=* | --oldincluded=* \
+  | --oldinclude=* | --oldinclud=* | --oldinclu=* | --oldincl=* | --oldinc=* \
+  | --oldin=* | --oldi=* | --old=* | --ol=* | --o=*)
+    oldincludedir="$ac_optarg" ;;
+
+  -prefix | --prefix | --prefi | --pref | --pre | --pr | --p)
+    ac_prev=prefix ;;
+  -prefix=* | --prefix=* | --prefi=* | --pref=* | --pre=* | --pr=* | --p=*)
+    prefix="$ac_optarg" ;;
+
+  -program-prefix | --program-prefix | --program-prefi | --program-pref \
+  | --program-pre | --program-pr | --program-p)
+    ac_prev=program_prefix ;;
+  -program-prefix=* | --program-prefix=* | --program-prefi=* \
+  | --program-pref=* | --program-pre=* | --program-pr=* | --program-p=*)
+    program_prefix="$ac_optarg" ;;
+
+  -program-suffix | --program-suffix | --program-suffi | --program-suff \
+  | --program-suf | --program-su | --program-s)
+    ac_prev=program_suffix ;;
+  -program-suffix=* | --program-suffix=* | --program-suffi=* \
+  | --program-suff=* | --program-suf=* | --program-su=* | --program-s=*)
+    program_suffix="$ac_optarg" ;;
+
+  -program-transform-name | --program-transform-name \
+  | --program-transform-nam | --program-transform-na \
+  | --program-transform-n | --program-transform- \
+  | --program-transform | --program-transfor \
+  | --program-transfo | --program-transf \
+  | --program-trans | --program-tran \
+  | --progr-tra | --program-tr | --program-t)
+    ac_prev=program_transform_name ;;
+  -program-transform-name=* | --program-transform-name=* \
+  | --program-transform-nam=* | --program-transform-na=* \
+  | --program-transform-n=* | --program-transform-=* \
+  | --program-transform=* | --program-transfor=* \
+  | --program-transfo=* | --program-transf=* \
+  | --program-trans=* | --program-tran=* \
+  | --progr-tra=* | --program-tr=* | --program-t=*)
+    program_transform_name="$ac_optarg" ;;
+
+  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
+  | -silent | --silent | --silen | --sile | --sil)
+    silent=yes ;;
+
+  -sbindir | --sbindir | --sbindi | --sbind | --sbin | --sbi | --sb)
+    ac_prev=sbindir ;;
+  -sbindir=* | --sbindir=* | --sbindi=* | --sbind=* | --sbin=* \
+  | --sbi=* | --sb=*)
+    sbindir="$ac_optarg" ;;
+
+  -sharedstatedir | --sharedstatedir | --sharedstatedi \
+  | --sharedstated | --sharedstate | --sharedstat | --sharedsta \
+  | --sharedst | --shareds | --shared | --share | --shar \
+  | --sha | --sh)
+    ac_prev=sharedstatedir ;;
+  -sharedstatedir=* | --sharedstatedir=* | --sharedstatedi=* \
+  | --sharedstated=* | --sharedstate=* | --sharedstat=* | --sharedsta=* \
+  | --sharedst=* | --shareds=* | --shared=* | --share=* | --shar=* \
+  | --sha=* | --sh=*)
+    sharedstatedir="$ac_optarg" ;;
+
+  -site | --site | --sit)
+    ac_prev=site ;;
+  -site=* | --site=* | --sit=*)
+    site="$ac_optarg" ;;
+
+  -srcdir | --srcdir | --srcdi | --srcd | --src | --sr)
+    ac_prev=srcdir ;;
+  -srcdir=* | --srcdir=* | --srcdi=* | --srcd=* | --src=* | --sr=*)
+    srcdir="$ac_optarg" ;;
+
+  -sysconfdir | --sysconfdir | --sysconfdi | --sysconfd | --sysconf \
+  | --syscon | --sysco | --sysc | --sys | --sy)
+    ac_prev=sysconfdir ;;
+  -sysconfdir=* | --sysconfdir=* | --sysconfdi=* | --sysconfd=* | --sysconf=* \
+  | --syscon=* | --sysco=* | --sysc=* | --sys=* | --sy=*)
+    sysconfdir="$ac_optarg" ;;
+
+  -target | --target | --targe | --targ | --tar | --ta | --t)
+    ac_prev=target ;;
+  -target=* | --target=* | --targe=* | --targ=* | --tar=* | --ta=* | --t=*)
+    target="$ac_optarg" ;;
+
+  -v | -verbose | --verbose | --verbos | --verbo | --verb)
+    verbose=yes ;;
+
+  -version | --version | --versio | --versi | --vers)
+    echo "configure generated by autoconf version 2.13"
+    exit 0 ;;
+
+  -with-* | --with-*)
+    ac_package=`echo $ac_option|sed -e 's/-*with-//' -e 's/=.*//'`
+    # Reject names that are not valid shell variable names.
+    if test -n "`echo $ac_package| sed 's/[-_a-zA-Z0-9]//g'`"; then
+      { echo "configure: error: $ac_package: invalid package name" 1>&2; exit 1; }
+    fi
+    ac_package=`echo $ac_package| sed 's/-/_/g'`
+    case "$ac_option" in
+      *=*) ;;
+      *) ac_optarg=yes ;;
+    esac
+    eval "with_${ac_package}='$ac_optarg'" ;;
+
+  -without-* | --without-*)
+    ac_package=`echo $ac_option|sed -e 's/-*without-//'`
+    # Reject names that are not valid shell variable names.
+    if test -n "`echo $ac_package| sed 's/[-a-zA-Z0-9_]//g'`"; then
+      { echo "configure: error: $ac_package: invalid package name" 1>&2; exit 1; }
+    fi
+    ac_package=`echo $ac_package| sed 's/-/_/g'`
+    eval "with_${ac_package}=no" ;;
+
+  --x)
+    # Obsolete; use --with-x.
+    with_x=yes ;;
+
+  -x-includes | --x-includes | --x-include | --x-includ | --x-inclu \
+  | --x-incl | --x-inc | --x-in | --x-i)
+    ac_prev=x_includes ;;
+  -x-includes=* | --x-includes=* | --x-include=* | --x-includ=* | --x-inclu=* \
+  | --x-incl=* | --x-inc=* | --x-in=* | --x-i=*)
+    x_includes="$ac_optarg" ;;
+
+  -x-libraries | --x-libraries | --x-librarie | --x-librari \
+  | --x-librar | --x-libra | --x-libr | --x-lib | --x-li | --x-l)
+    ac_prev=x_libraries ;;
+  -x-libraries=* | --x-libraries=* | --x-librarie=* | --x-librari=* \
+  | --x-librar=* | --x-libra=* | --x-libr=* | --x-lib=* | --x-li=* | --x-l=*)
+    x_libraries="$ac_optarg" ;;
+
+  -*) { echo "configure: error: $ac_option: invalid option; use --help to show usage" 1>&2; exit 1; }
+    ;;
+
+  *)
+    if test -n "`echo $ac_option| sed 's/[-a-z0-9.]//g'`"; then
+      echo "configure: warning: $ac_option: invalid host type" 1>&2
+    fi
+    if test "x$nonopt" != xNONE; then
+      { echo "configure: error: can only configure for one host and one target at a time" 1>&2; exit 1; }
+    fi
+    nonopt="$ac_option"
+    ;;
+
+  esac
+done
+
+if test -n "$ac_prev"; then
+  { echo "configure: error: missing argument to --`echo $ac_prev | sed 's/_/-/g'`" 1>&2; exit 1; }
+fi
+
+trap 'rm -fr conftest* confdefs* core core.* *.core $ac_clean_files; exit 1' 1 2 15
+
+# File descriptor usage:
+# 0 standard input
+# 1 file creation
+# 2 errors and warnings
+# 3 some systems may open it to /dev/tty
+# 4 used on the Kubota Titan
+# 6 checking for... messages and results
+# 5 compiler messages saved in config.log
+if test "$silent" = yes; then
+  exec 6>/dev/null
+else
+  exec 6>&1
+fi
+exec 5>./config.log
+
+echo "\
+This file contains any messages produced by compilers while
+running configure, to aid debugging if configure makes a mistake.
+" 1>&5
+
+# Strip out --no-create and --no-recursion so they do not pile up.
+# Also quote any args containing shell metacharacters.
+ac_configure_args=
+for ac_arg
+do
+  case "$ac_arg" in
+  -no-create | --no-create | --no-creat | --no-crea | --no-cre \
+  | --no-cr | --no-c) ;;
+  -no-recursion | --no-recursion | --no-recursio | --no-recursi \
+  | --no-recurs | --no-recur | --no-recu | --no-rec | --no-re | --no-r) ;;
+  *" "*|*"	"*|*[\[\]\~\#\$\^\&\*\(\)\{\}\\\|\;\<\>\?]*)
+  ac_configure_args="$ac_configure_args '$ac_arg'" ;;
+  *) ac_configure_args="$ac_configure_args $ac_arg" ;;
+  esac
+done
+
+# NLS nuisances.
+# Only set these to C if already set.  These must not be set unconditionally
+# because not all systems understand e.g. LANG=C (notably SCO).
+# Fixing LC_MESSAGES prevents Solaris sh from translating var values in `set'!
+# Non-C LC_CTYPE values break the ctype check.
+if test "${LANG+set}"   = set; then LANG=C;   export LANG;   fi
+if test "${LC_ALL+set}" = set; then LC_ALL=C; export LC_ALL; fi
+if test "${LC_MESSAGES+set}" = set; then LC_MESSAGES=C; export LC_MESSAGES; fi
+if test "${LC_CTYPE+set}"    = set; then LC_CTYPE=C;    export LC_CTYPE;    fi
+
+# confdefs.h avoids OS command line length limits that DEFS can exceed.
+rm -rf conftest* confdefs.h
+# AIX cpp loses on an empty file, so make sure it contains at least a newline.
+echo > confdefs.h
+
+# A filename unique to this package, relative to the directory that
+# configure is in, which we can look for to find out if srcdir is correct.
+ac_unique_file=
+
+# Find the source files, if location was not specified.
+if test -z "$srcdir"; then
+  ac_srcdir_defaulted=yes
+  # Try the directory containing this script, then its parent.
+  ac_prog=$0
+  ac_confdir=`echo $ac_prog|sed 's%/[^/][^/]*$%%'`
+  test "x$ac_confdir" = "x$ac_prog" && ac_confdir=.
+  srcdir=$ac_confdir
+  if test ! -r $srcdir/$ac_unique_file; then
+    srcdir=..
+  fi
+else
+  ac_srcdir_defaulted=no
+fi
+if test ! -r $srcdir/$ac_unique_file; then
+  if test "$ac_srcdir_defaulted" = yes; then
+    { echo "configure: error: can not find sources in $ac_confdir or .." 1>&2; exit 1; }
+  else
+    { echo "configure: error: can not find sources in $srcdir" 1>&2; exit 1; }
+  fi
+fi
+srcdir=`echo "${srcdir}" | sed 's%\([^/]\)/*$%\1%'`
+
+# Prefer explicitly selected file to automatically selected ones.
+if test -z "$CONFIG_SITE"; then
+  if test "x$prefix" != xNONE; then
+    CONFIG_SITE="$prefix/share/config.site $prefix/etc/config.site"
+  else
+    CONFIG_SITE="$ac_default_prefix/share/config.site $ac_default_prefix/etc/config.site"
+  fi
+fi
+for ac_site_file in $CONFIG_SITE; do
+  if test -r "$ac_site_file"; then
+    echo "loading site script $ac_site_file"
+    . "$ac_site_file"
+  fi
+done
+
+if test -r "$cache_file"; then
+  echo "loading cache $cache_file"
+  . $cache_file
+else
+  echo "creating cache $cache_file"
+  > $cache_file
+fi
+
+ac_ext=c
+# CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'
+ac_link='${CC-cc} -o conftest${ac_exeext} $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
+cross_compiling=$ac_cv_prog_cc_cross
+
+ac_exeext=
+ac_objext=o
+if (echo "testing\c"; echo 1,2,3) | grep c >/dev/null; then
+  # Stardent Vistra SVR4 grep lacks -e, says ghazi@caip.rutgers.edu.
+  if (echo -n testing; echo 1,2,3) | sed s/-n/xn/ | grep xn >/dev/null; then
+    ac_n= ac_c='
+' ac_t='	'
+  else
+    ac_n=-n ac_c= ac_t=
+  fi
+else
+  ac_n= ac_c='\c' ac_t=
+fi
+
+
+
+echo $ac_n "checking whether ${MAKE-make} sets \${MAKE}""... $ac_c" 1>&6
+echo "configure:557: checking whether ${MAKE-make} sets \${MAKE}" >&5
+set dummy ${MAKE-make}; ac_make=`echo "$2" | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_prog_make_${ac_make}_set'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftestmake <<\EOF
+all:
+	@echo 'ac_maketemp="${MAKE}"'
+EOF
+# GNU make sometimes prints "make[1]: Entering...", which would confuse us.
+eval `${MAKE-make} -f conftestmake 2>/dev/null | grep temp=`
+if test -n "$ac_maketemp"; then
+  eval ac_cv_prog_make_${ac_make}_set=yes
+else
+  eval ac_cv_prog_make_${ac_make}_set=no
+fi
+rm -f conftestmake
+fi
+if eval "test \"`echo '$ac_cv_prog_make_'${ac_make}_set`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  SET_MAKE=
+else
+  echo "$ac_t""no" 1>&6
+  SET_MAKE="MAKE=${MAKE-make}"
+fi
+
+# Extract the first word of "gcc", so it can be a program name with args.
+set dummy gcc; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:586: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_CC="gcc"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+fi
+fi
+CC="$ac_cv_prog_CC"
+if test -n "$CC"; then
+  echo "$ac_t""$CC" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+if test -z "$CC"; then
+  # Extract the first word of "cc", so it can be a program name with args.
+set dummy cc; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:616: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_prog_rejected=no
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      if test "$ac_dir/$ac_word" = "/usr/ucb/cc"; then
+        ac_prog_rejected=yes
+	continue
+      fi
+      ac_cv_prog_CC="cc"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+if test $ac_prog_rejected = yes; then
+  # We found a bogon in the path, so make sure we never use it.
+  set dummy $ac_cv_prog_CC
+  shift
+  if test $# -gt 0; then
+    # We chose a different compiler from the bogus one.
+    # However, it has the same basename, so the bogon will be chosen
+    # first if we set CC to just the basename; use the full file name.
+    shift
+    set dummy "$ac_dir/$ac_word" "$@"
+    shift
+    ac_cv_prog_CC="$@"
+  fi
+fi
+fi
+fi
+CC="$ac_cv_prog_CC"
+if test -n "$CC"; then
+  echo "$ac_t""$CC" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+  if test -z "$CC"; then
+    case "`uname -s`" in
+    *win32* | *WIN32*)
+      # Extract the first word of "cl", so it can be a program name with args.
+set dummy cl; ac_word=$2
+echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
+echo "configure:667: checking for $ac_word" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS=":"
+  ac_dummy="$PATH"
+  for ac_dir in $ac_dummy; do
+    test -z "$ac_dir" && ac_dir=.
+    if test -f $ac_dir/$ac_word; then
+      ac_cv_prog_CC="cl"
+      break
+    fi
+  done
+  IFS="$ac_save_ifs"
+fi
+fi
+CC="$ac_cv_prog_CC"
+if test -n "$CC"; then
+  echo "$ac_t""$CC" 1>&6
+else
+  echo "$ac_t""no" 1>&6
+fi
+ ;;
+    esac
+  fi
+  test -z "$CC" && { echo "configure: error: no acceptable cc found in \$PATH" 1>&2; exit 1; }
+fi
+
+echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
+echo "configure:699: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
+
+ac_ext=c
+# CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'
+ac_link='${CC-cc} -o conftest${ac_exeext} $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
+cross_compiling=$ac_cv_prog_cc_cross
+
+cat > conftest.$ac_ext << EOF
+
+#line 710 "configure"
+#include "confdefs.h"
+
+main(){return(0);}
+EOF
+if { (eval echo configure:715: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  ac_cv_prog_cc_works=yes
+  # If we can't run a trivial program, we are probably using a cross compiler.
+  if (./conftest; exit) 2>/dev/null; then
+    ac_cv_prog_cc_cross=no
+  else
+    ac_cv_prog_cc_cross=yes
+  fi
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  ac_cv_prog_cc_works=no
+fi
+rm -fr conftest*
+ac_ext=c
+# CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'
+ac_link='${CC-cc} -o conftest${ac_exeext} $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'
+cross_compiling=$ac_cv_prog_cc_cross
+
+echo "$ac_t""$ac_cv_prog_cc_works" 1>&6
+if test $ac_cv_prog_cc_works = no; then
+  { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
+fi
+echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
+echo "configure:741: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
+echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
+cross_compiling=$ac_cv_prog_cc_cross
+
+echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
+echo "configure:746: checking whether we are using GNU C" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.c <<EOF
+#ifdef __GNUC__
+  yes;
+#endif
+EOF
+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:755: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
+  ac_cv_prog_gcc=yes
+else
+  ac_cv_prog_gcc=no
+fi
+fi
+
+echo "$ac_t""$ac_cv_prog_gcc" 1>&6
+
+if test $ac_cv_prog_gcc = yes; then
+  GCC=yes
+else
+  GCC=
+fi
+
+ac_test_CFLAGS="${CFLAGS+set}"
+ac_save_CFLAGS="$CFLAGS"
+CFLAGS=
+echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
+echo "configure:774: checking whether ${CC-cc} accepts -g" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  echo 'void f(){}' > conftest.c
+if test -z "`${CC-cc} -g -c conftest.c 2>&1`"; then
+  ac_cv_prog_cc_g=yes
+else
+  ac_cv_prog_cc_g=no
+fi
+rm -f conftest*
+
+fi
+
+echo "$ac_t""$ac_cv_prog_cc_g" 1>&6
+if test "$ac_test_CFLAGS" = set; then
+  CFLAGS="$ac_save_CFLAGS"
+elif test $ac_cv_prog_cc_g = yes; then
+  if test "$GCC" = yes; then
+    CFLAGS="-g -O2"
+  else
+    CFLAGS="-g"
+  fi
+else
+  if test "$GCC" = yes; then
+    CFLAGS="-O2"
+  else
+    CFLAGS=
+  fi
+fi
+
+
+ac_aux_dir=
+for ac_dir in $srcdir $srcdir/.. $srcdir/../..; do
+  if test -f $ac_dir/install-sh; then
+    ac_aux_dir=$ac_dir
+    ac_install_sh="$ac_aux_dir/install-sh -c"
+    break
+  elif test -f $ac_dir/install.sh; then
+    ac_aux_dir=$ac_dir
+    ac_install_sh="$ac_aux_dir/install.sh -c"
+    break
+  fi
+done
+if test -z "$ac_aux_dir"; then
+  { echo "configure: error: can not find install-sh or install.sh in $srcdir $srcdir/.. $srcdir/../.." 1>&2; exit 1; }
+fi
+ac_config_guess=$ac_aux_dir/config.guess
+ac_config_sub=$ac_aux_dir/config.sub
+ac_configure=$ac_aux_dir/configure # This should be Cygnus configure.
+
+
+# Do some error checking and defaulting for the host and target type.
+# The inputs are:
+#    configure --host=HOST --target=TARGET --build=BUILD NONOPT
+#
+# The rules are:
+# 1. You are not allowed to specify --host, --target, and nonopt at the
+#    same time.
+# 2. Host defaults to nonopt.
+# 3. If nonopt is not specified, then host defaults to the current host,
+#    as determined by config.guess.
+# 4. Target and build default to nonopt.
+# 5. If nonopt is not specified, then target and build default to host.
+
+# The aliases save the names the user supplied, while $host etc.
+# will get canonicalized.
+case $host---$target---$nonopt in
+NONE---*---* | *---NONE---* | *---*---NONE) ;;
+*) { echo "configure: error: can only configure for one host and one target at a time" 1>&2; exit 1; } ;;
+esac
+
+
+# Make sure we can run config.sub.
+if ${CONFIG_SHELL-/bin/sh} $ac_config_sub sun4 >/dev/null 2>&1; then :
+else { echo "configure: error: can not run $ac_config_sub" 1>&2; exit 1; }
+fi
+
+echo $ac_n "checking host system type""... $ac_c" 1>&6
+echo "configure:853: checking host system type" >&5
+
+host_alias=$host
+case "$host_alias" in
+NONE)
+  case $nonopt in
+  NONE)
+    if host_alias=`${CONFIG_SHELL-/bin/sh} $ac_config_guess`; then :
+    else { echo "configure: error: can not guess host type; you must specify one" 1>&2; exit 1; }
+    fi ;;
+  *) host_alias=$nonopt ;;
+  esac ;;
+esac
+
+host=`${CONFIG_SHELL-/bin/sh} $ac_config_sub $host_alias`
+host_cpu=`echo $host | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\1/'`
+host_vendor=`echo $host | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\2/'`
+host_os=`echo $host | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\3/'`
+echo "$ac_t""$host" 1>&6
+
+echo $ac_n "checking target system type""... $ac_c" 1>&6
+echo "configure:874: checking target system type" >&5
+
+target_alias=$target
+case "$target_alias" in
+NONE)
+  case $nonopt in
+  NONE) target_alias=$host_alias ;;
+  *) target_alias=$nonopt ;;
+  esac ;;
+esac
+
+target=`${CONFIG_SHELL-/bin/sh} $ac_config_sub $target_alias`
+target_cpu=`echo $target | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\1/'`
+target_vendor=`echo $target | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\2/'`
+target_os=`echo $target | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\3/'`
+echo "$ac_t""$target" 1>&6
+
+echo $ac_n "checking build system type""... $ac_c" 1>&6
+echo "configure:892: checking build system type" >&5
+
+build_alias=$build
+case "$build_alias" in
+NONE)
+  case $nonopt in
+  NONE) build_alias=$host_alias ;;
+  *) build_alias=$nonopt ;;
+  esac ;;
+esac
+
+build=`${CONFIG_SHELL-/bin/sh} $ac_config_sub $build_alias`
+build_cpu=`echo $build | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\1/'`
+build_vendor=`echo $build | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\2/'`
+build_os=`echo $build | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\3/'`
+echo "$ac_t""$build" 1>&6
+
+test "$host_alias" != "$target_alias" &&
+  test "$program_prefix$program_suffix$program_transform_name" = \
+    NONENONEs,x,x, &&
+  program_prefix=${target_alias}-
+
+
+case $host_os in 
+	*linux-gnu)
+	OS="-DLINUX -DGLIBC"
+	;;
+	*solaris*)
+	OS="-DSOLARIS"
+	;;
+	*freebsd*)
+	OS="-DFREEBSD"
+	;;
+	*hpux)
+	OS="-DHPUX"
+	;;
+	*aix)
+	OS="-DAIX"
+	;;
+	*)
+	;;
+esac
+	
+echo $ac_n "checking for main in -lnsl""... $ac_c" 1>&6
+echo "configure:936: checking for main in -lnsl" >&5
+ac_lib_var=`echo nsl'_'main | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lnsl  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 944 "configure"
+#include "confdefs.h"
+
+int main() {
+main()
+; return 0; }
+EOF
+if { (eval echo configure:951: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo nsl | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-lnsl $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+echo $ac_n "checking for main in -log""... $ac_c" 1>&6
+echo "configure:979: checking for main in -log" >&5
+ac_lib_var=`echo og'_'main | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-log  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 987 "configure"
+#include "confdefs.h"
+
+int main() {
+main()
+; return 0; }
+EOF
+if { (eval echo configure:994: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo og | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-log $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+echo $ac_n "checking for main in -lsocket""... $ac_c" 1>&6
+echo "configure:1022: checking for main in -lsocket" >&5
+ac_lib_var=`echo socket'_'main | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lsocket  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1030 "configure"
+#include "confdefs.h"
+
+int main() {
+main()
+; return 0; }
+EOF
+if { (eval echo configure:1037: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo socket | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-lsocket $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+echo $ac_n "checking for crypt in -lcrypt""... $ac_c" 1>&6
+echo "configure:1065: checking for crypt in -lcrypt" >&5
+ac_lib_var=`echo crypt'_'crypt | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lcrypt  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1073 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char crypt();
+
+int main() {
+crypt()
+; return 0; }
+EOF
+if { (eval echo configure:1084: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo crypt | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-lcrypt $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+echo $ac_n "checking for printf in -lc""... $ac_c" 1>&6
+echo "configure:1112: checking for printf in -lc" >&5
+ac_lib_var=`echo c'_'printf | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lc  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1120 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char printf();
+
+int main() {
+printf()
+; return 0; }
+EOF
+if { (eval echo configure:1131: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo c | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-lc $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+
+
+
+
+echo $ac_n "checking for PAM support:""... $ac_c" 1>&6
+echo "configure:1163: checking for PAM support:" >&5
+echo
+# Check whether --with-pam or --without-pam was given.
+if test "${with_pam+set}" = set; then
+  withval="$with_pam"
+  :
+fi
+
+if test "x$with_pam" = "xyes";then
+	echo $ac_n "checking for dlopen in -ldl""... $ac_c" 1>&6
+echo "configure:1173: checking for dlopen in -ldl" >&5
+ac_lib_var=`echo dl'_'dlopen | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-ldl  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1181 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char dlopen();
+
+int main() {
+dlopen()
+; return 0; }
+EOF
+if { (eval echo configure:1192: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo dl | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-ldl $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+	echo $ac_n "checking for pam_start in -lpam""... $ac_c" 1>&6
+echo "configure:1220: checking for pam_start in -lpam" >&5
+ac_lib_var=`echo pam'_'pam_start | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lpam  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1228 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char pam_start();
+
+int main() {
+pam_start()
+; return 0; }
+EOF
+if { (eval echo configure:1239: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo pam | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-lpam $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+	DEFINES="-DUSE_PAM $DEFINES";
+        echo "$ac_t""Pam support... yes" 1>&6
+else
+        echo "$ac_t""Pam support... no" 1>&6
+fi
+
+echo $ac_n "checking for LDAP support""... $ac_c" 1>&6
+echo "configure:1273: checking for LDAP support" >&5
+echo
+# Check whether --with-ldap or --without-ldap was given.
+if test "${with_ldap+set}" = set; then
+  withval="$with_ldap"
+  :
+fi
+
+
+if test "x$with_ldap" = "xyes";then
+	echo $ac_n "checking for main in -lldap""... $ac_c" 1>&6
+echo "configure:1284: checking for main in -lldap" >&5
+ac_lib_var=`echo ldap'_'main | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lldap  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1292 "configure"
+#include "confdefs.h"
+
+int main() {
+main()
+; return 0; }
+EOF
+if { (eval echo configure:1299: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo ldap | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-lldap $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+	echo $ac_n "checking for main in -llber""... $ac_c" 1>&6
+echo "configure:1327: checking for main in -llber" >&5
+ac_lib_var=`echo lber'_'main | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-llber  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1335 "configure"
+#include "confdefs.h"
+
+int main() {
+main()
+; return 0; }
+EOF
+if { (eval echo configure:1342: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo lber | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-llber $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+   	echo $ac_n "checking for ldap_simple_bind_s in -lldap""... $ac_c" 1>&6
+echo "configure:1370: checking for ldap_simple_bind_s in -lldap" >&5
+ac_lib_var=`echo ldap'_'ldap_simple_bind_s | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lldap  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1378 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char ldap_simple_bind_s();
+
+int main() {
+ldap_simple_bind_s()
+; return 0; }
+EOF
+if { (eval echo configure:1389: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo ldap | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-lldap $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+   	echo $ac_n "checking for ldap_init in -lldap""... $ac_c" 1>&6
+echo "configure:1417: checking for ldap_init in -lldap" >&5
+ac_lib_var=`echo ldap'_'ldap_init | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lldap  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1425 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char ldap_init();
+
+int main() {
+ldap_init()
+; return 0; }
+EOF
+if { (eval echo configure:1436: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo ldap | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-lldap $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+ 
+   DEFINES="-DUSE_LDAP $DEFINES"
+        echo "$ac_t""LDAP support... yes" 1>&6
+else
+        echo "$ac_t""LDAP support... no" 1>&6
+fi
+
+echo $ac_n "checking for DB support""... $ac_c" 1>&6
+echo "configure:1471: checking for DB support" >&5
+echo 
+# Check whether --with-db or --without-db was given.
+if test "${with_db+set}" = set; then
+  withval="$with_db"
+  :
+fi
+
+if test "x$with_db" = "xyes";then
+	DB="$DB -DDB -DDB_NULL"	
+	echo "$ac_t""DB support... yes" 1>&6
+else
+	echo "$ac_t""DB support... no" 1>&6
+fi
+
+if test "x$with_db" = "xyes";then
+
+echo "Check for MySQL support:"
+
+# Check whether --with-mysql or --without-mysql was given.
+if test "${with_mysql+set}" = set; then
+  withval="$with_mysql"
+  :
+fi
+
+
+# Check whether --with-mysql-include-dir or --without-mysql-include-dir was given.
+if test "${with_mysql_include_dir+set}" = set; then
+  withval="$with_mysql_include_dir"
+  MYSQL_INCLUDE_DIR=$withval
+else
+  MYSQL_INCLUDE_DIR=/usr/include/mysql
+
+fi
+
+
+# Check whether --with-mysql-lib-dir or --without-mysql-lib-dir was given.
+if test "${with_mysql_lib_dir+set}" = set; then
+  withval="$with_mysql_lib_dir"
+  MYSQL_LIB_DIR=$withval
+else
+  MYSQL_LIB_DIR=/usr/lib/mysql
+
+fi
+
+
+
+if test "x$with_mysql" = "xyes";then
+	
+	LDFLAGS="-L$MYSQL_LIB_DIR $LDFLAGS"
+        LDFLAGS="-I$MYSQL_INCLUDE_DIR $LDFLAGS"
+        echo $ac_n "checking for mysql_init in -lmysqlclient""... $ac_c" 1>&6
+echo "configure:1523: checking for mysql_init in -lmysqlclient" >&5
+ac_lib_var=`echo mysqlclient'_'mysql_init | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lmysqlclient -lm $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1531 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char mysql_init();
+
+int main() {
+mysql_init()
+; return 0; }
+EOF
+if { (eval echo configure:1542: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  LIBS="-lmysqlclient -lm $LIBS"
+else
+  echo "$ac_t""no" 1>&6
+{ echo "configure: error: *** couldn't find libmysqlclient" 1>&2; exit 1; }
+fi
+
+
+	DB="$DB -DDB_MYSQL";
+        echo "$ac_t""Mysql support... yes" 1>&6
+else
+        echo "$ac_t""Mysql support... no" 1>&6
+fi
+
+fi
+
+if test "x$with_db" = "xyes";then
+
+echo "Check for PgSQL support:"
+
+# Check whether --with-pgsql or --without-pgsql was given.
+if test "${with_pgsql+set}" = set; then
+  withval="$with_pgsql"
+  :
+fi
+
+
+# Check whether --with-pgsql-include-dir or --without-pgsql-include-dir was given.
+if test "${with_pgsql_include_dir+set}" = set; then
+  withval="$with_pgsql_include_dir"
+  PGSQL_INCLUDE_DIR=$withval
+else
+  PGSQL_INCLUDE_DIR=/usr/include/pgsql
+
+fi
+
+
+# Check whether --with-pgsql-lib-dir or --without-pgsql-lib-dir was given.
+if test "${with_pgsql_lib_dir+set}" = set; then
+  withval="$with_pgsql_lib_dir"
+  PGSQL_LIB_DIR=$withval
+else
+  PGSQL_LIB=/usr/lib/pgsql
+
+fi
+
+
+
+if test "x$with_pgsql" = "xyes";then
+	
+	LDFLAGS="-I$PGSQL_INCLUDE_DIR $LDFLAGS"
+        LDFLAGS="-L$PGSQL_LIB_DIR $LDFLAGS"
+        echo $ac_n "checking for PQconnectdb  in -lpq""... $ac_c" 1>&6
+echo "configure:1609: checking for PQconnectdb  in -lpq" >&5
+ac_lib_var=`echo pq'_'PQconnectdb  | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lpq  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1617 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char PQconnectdb ();
+
+int main() {
+PQconnectdb ()
+; return 0; }
+EOF
+if { (eval echo configure:1628: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  LIBS="-lpq $LIBS"
+else
+  echo "$ac_t""no" 1>&6
+{ echo "configure: error: *** couldn't find libpq" 1>&2; exit 1; }
+fi
+
+
+	DB="$DB -DDB_PGSQL";
+        echo "$ac_t""Pgsql support... yes" 1>&6
+else
+        echo "$ac_t""Pgsql support... no" 1>&6
+fi
+
+fi
+
+
+# Check whether --with-tacuid or --without-tacuid was given.
+if test "${with_tacuid+set}" = set; then
+  withval="$with_tacuid"
+  :
+fi
+
+# Check whether --with-tacgid or --without-tacgid was given.
+if test "${with_tacgid+set}" = set; then
+  withval="$with_tacgid"
+  :
+fi
+
+
+
+if (test "x$with_tacuid" != "x" && test "x$with_tacgid" != "x" && test "x$with_tacuid" != "xyes" && test "x$with_tacgid" != "xyes");then
+
+ 	DEFINES="-DTACPLUS_USERID=$with_tacuid -DTACPLUS_GROUPID=$with_tacgid $DEFINES";	
+	echo "$ac_t""tacacs+ work with given user and group id" 1>&6 
+fi
+
+echo $ac_n "checking whether to enable the maxsess feature""... $ac_c" 1>&6
+echo "configure:1680: checking whether to enable the maxsess feature" >&5
+# Check whether --enable-maxsess or --disable-maxsess was given.
+if test "${enable_maxsess+set}" = set; then
+  enableval="$enable_maxsess"
+  
+if test "$enableval" = "yes";then
+ 	DEFINES="-DMAXSESS $DEFINES";
+	echo "$ac_t""yes" 1>&6
+else 
+	echo "$ac_t""no" 1>&6
+fi
+
+else
+  
+	echo "$ac_t""no" 1>&6
+
+fi
+
+
+
+# Check whether --with-tacplus_pid or --without-tacplus_pid was given.
+if test "${with_tacplus_pid+set}" = set; then
+  withval="$with_tacplus_pid"
+  PIDFILE="-DTACPLUS_PIDFILE=\\\"$withval/tac_plus.pid\\\""
+else
+  PIDFILE="-DTACPLUS_PIDFILE=\\\"/var/run/tac_plus.pid\\\""
+
+fi
+
+
+echo $ac_n "checking whether to enable the libwrap feture""... $ac_c" 1>&6
+echo "configure:1711: checking whether to enable the libwrap feture" >&5
+
+# Check whether --with-libwrap or --without-libwrap was given.
+if test "${with_libwrap+set}" = set; then
+  withval="$with_libwrap"
+   case "$withval" in
+  no)
+    echo "$ac_t""no" 1>&6
+    ;;
+  yes)
+    echo "$ac_t""yes" 1>&6
+    echo $ac_n "checking for request_init in -lwrap""... $ac_c" 1>&6
+echo "configure:1723: checking for request_init in -lwrap" >&5
+ac_lib_var=`echo wrap'_'request_init | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lwrap  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1731 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char request_init();
+
+int main() {
+request_init()
+; return 0; }
+EOF
+if { (eval echo configure:1742: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  
+        LIBS="-lwrap $LIBS"
+        DEFINES="-DTCPWRAPPER $DEFINES"
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+    ;;
+  *)
+    echo "$ac_t""yes" 1>&6
+    if test -d "$withval"; then
+        LDFLAGS="-L$withval $LDFLAGS"
+    	DEFINES="-DTCPWRAPPER $DEFINES"
+    fi
+    cat > conftest.$ac_ext <<EOF
+#line 1772 "configure"
+#include "confdefs.h"
+ int allow_severity; int deny_severity; 
+int main() {
+ hosts_access(); 
+; return 0; }
+EOF
+if { (eval echo configure:1779: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  :
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+   { echo "configure: error: Could not find the $withval library.  You must first install tcp_wrappers." 1>&2; exit 1; } 
+fi
+rm -f conftest*
+    ;;
+  esac 
+else
+  echo "$ac_t""no" 1>&6
+
+fi
+
+
+if test "x$enable_maxsess" = "xyes"; then
+
+# Check whether --enable-finger or --disable-finger was given.
+if test "${enable_finger+set}" = set; then
+  enableval="$enable_finger"
+  echo "$ac_t"""Enable whether finger at maxsess check: yes"" 1>&6;
+	DEFINES="-DENABLE_FINGER $DEFINES"
+else
+  echo "$ac_t"""Enable whether finger at maxsess check: no"" 1>&6;
+
+fi
+
+fi
+
+
+
+
+
+
+echo $ac_n "checking how to run the C preprocessor""... $ac_c" 1>&6
+echo "configure:1816: checking how to run the C preprocessor" >&5
+# On Suns, sometimes $CPP names a directory.
+if test -n "$CPP" && test -d "$CPP"; then
+  CPP=
+fi
+if test -z "$CPP"; then
+if eval "test \"`echo '$''{'ac_cv_prog_CPP'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+    # This must be in double quotes, not single quotes, because CPP may get
+  # substituted into the Makefile and "${CC-cc}" will confuse make.
+  CPP="${CC-cc} -E"
+  # On the NeXT, cc -E runs the code through the compiler's parser,
+  # not just through cpp.
+  cat > conftest.$ac_ext <<EOF
+#line 1831 "configure"
+#include "confdefs.h"
+#include <assert.h>
+Syntax Error
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:1837: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  :
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  CPP="${CC-cc} -E -traditional-cpp"
+  cat > conftest.$ac_ext <<EOF
+#line 1848 "configure"
+#include "confdefs.h"
+#include <assert.h>
+Syntax Error
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:1854: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  :
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  CPP="${CC-cc} -nologo -E"
+  cat > conftest.$ac_ext <<EOF
+#line 1865 "configure"
+#include "confdefs.h"
+#include <assert.h>
+Syntax Error
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:1871: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  :
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  CPP=/lib/cpp
+fi
+rm -f conftest*
+fi
+rm -f conftest*
+fi
+rm -f conftest*
+  ac_cv_prog_CPP="$CPP"
+fi
+  CPP="$ac_cv_prog_CPP"
+else
+  ac_cv_prog_CPP="$CPP"
+fi
+echo "$ac_t""$CPP" 1>&6
+
+echo $ac_n "checking for ANSI C header files""... $ac_c" 1>&6
+echo "configure:1896: checking for ANSI C header files" >&5
+if eval "test \"`echo '$''{'ac_cv_header_stdc'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 1901 "configure"
+#include "confdefs.h"
+#include <stdlib.h>
+#include <stdarg.h>
+#include <string.h>
+#include <float.h>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:1909: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  ac_cv_header_stdc=yes
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_header_stdc=no
+fi
+rm -f conftest*
+
+if test $ac_cv_header_stdc = yes; then
+  # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
+cat > conftest.$ac_ext <<EOF
+#line 1926 "configure"
+#include "confdefs.h"
+#include <string.h>
+EOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  egrep "memchr" >/dev/null 2>&1; then
+  :
+else
+  rm -rf conftest*
+  ac_cv_header_stdc=no
+fi
+rm -f conftest*
+
+fi
+
+if test $ac_cv_header_stdc = yes; then
+  # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
+cat > conftest.$ac_ext <<EOF
+#line 1944 "configure"
+#include "confdefs.h"
+#include <stdlib.h>
+EOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  egrep "free" >/dev/null 2>&1; then
+  :
+else
+  rm -rf conftest*
+  ac_cv_header_stdc=no
+fi
+rm -f conftest*
+
+fi
+
+if test $ac_cv_header_stdc = yes; then
+  # /bin/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
+if test "$cross_compiling" = yes; then
+  :
+else
+  cat > conftest.$ac_ext <<EOF
+#line 1965 "configure"
+#include "confdefs.h"
+#include <ctype.h>
+#define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
+#define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
+#define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))
+int main () { int i; for (i = 0; i < 256; i++)
+if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);
+exit (0); }
+
+EOF
+if { (eval echo configure:1976: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  :
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  ac_cv_header_stdc=no
+fi
+rm -fr conftest*
+fi
+
+fi
+fi
+
+echo "$ac_t""$ac_cv_header_stdc" 1>&6
+if test $ac_cv_header_stdc = yes; then
+  cat >> confdefs.h <<\EOF
+#define STDC_HEADERS 1
+EOF
+
+fi
+
+for ac_hdr in fcntl.h malloc.h strings.h sys/file.h sys/ioctl.h sys/time.h syslog.h unistd.h
+do
+ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
+echo "configure:2003: checking for $ac_hdr" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 2008 "configure"
+#include "confdefs.h"
+#include <$ac_hdr>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:2013: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
+fi
+rm -f conftest*
+fi
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_hdr 1
+EOF
+ 
+else
+  echo "$ac_t""no" 1>&6
+fi
+done
+
+for ac_hdr in shadow.h
+do
+ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
+echo "configure:2043: checking for $ac_hdr" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 2048 "configure"
+#include "confdefs.h"
+#include <$ac_hdr>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:2053: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
+fi
+rm -f conftest*
+fi
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_hdr=HAVE_`echo $ac_hdr | sed 'y%abcdefghijklmnopqrstuvwxyz./-%ABCDEFGHIJKLMNOPQRSTUVWXYZ___%'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_hdr 1
+EOF
+ 
+		if test -f /etc/shadow ; then
+		  cat >> confdefs.h <<\EOF
+#define SHADOW_PASSWORDS 1
+EOF
+		
+		fi 
+		
+else
+  echo "$ac_t""no" 1>&6
+fi
+done
+
+echo $ac_n "checking for working const""... $ac_c" 1>&6
+echo "configure:2087: checking for working const" >&5
+if eval "test \"`echo '$''{'ac_cv_c_const'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 2092 "configure"
+#include "confdefs.h"
+
+int main() {
+
+/* Ultrix mips cc rejects this.  */
+typedef int charset[2]; const charset x;
+/* SunOS 4.1.1 cc rejects this.  */
+char const *const *ccp;
+char **p;
+/* NEC SVR4.0.2 mips cc rejects this.  */
+struct point {int x, y;};
+static struct point const zero = {0,0};
+/* AIX XL C 1.02.0.0 rejects this.
+   It does not let you subtract one const X* pointer from another in an arm
+   of an if-expression whose if-part is not a constant expression */
+const char *g = "string";
+ccp = &g + (g ? g-g : 0);
+/* HPUX 7.0 cc rejects these. */
+++ccp;
+p = (char**) ccp;
+ccp = (char const *const *) p;
+{ /* SCO 3.2v4 cc rejects this.  */
+  char *t;
+  char const *s = 0 ? (char *) 0 : (char const *) 0;
+
+  *t++ = 0;
+}
+{ /* Someone thinks the Sun supposedly-ANSI compiler will reject this.  */
+  int x[] = {25, 17};
+  const int *foo = &x[0];
+  ++foo;
+}
+{ /* Sun SC1.0 ANSI compiler rejects this -- but not the above. */
+  typedef const int *iptr;
+  iptr p = 0;
+  ++p;
+}
+{ /* AIX XL C 1.02.0.0 rejects this saying
+     "k.c", line 2.27: 1506-025 (S) Operand must be a modifiable lvalue. */
+  struct s { int j; const int *ap[3]; };
+  struct s *b; b->j = 5;
+}
+{ /* ULTRIX-32 V3.1 (Rev 9) vcc rejects this */
+  const int foo = 10;
+}
+
+; return 0; }
+EOF
+if { (eval echo configure:2141: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  ac_cv_c_const=yes
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_c_const=no
+fi
+rm -f conftest*
+fi
+
+echo "$ac_t""$ac_cv_c_const" 1>&6
+if test $ac_cv_c_const = no; then
+  cat >> confdefs.h <<\EOF
+#define const 
+EOF
+
+fi
+
+echo $ac_n "checking whether time.h and sys/time.h may both be included""... $ac_c" 1>&6
+echo "configure:2162: checking whether time.h and sys/time.h may both be included" >&5
+if eval "test \"`echo '$''{'ac_cv_header_time'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 2167 "configure"
+#include "confdefs.h"
+#include <sys/types.h>
+#include <sys/time.h>
+#include <time.h>
+int main() {
+struct tm *tp;
+; return 0; }
+EOF
+if { (eval echo configure:2176: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  ac_cv_header_time=yes
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_header_time=no
+fi
+rm -f conftest*
+fi
+
+echo "$ac_t""$ac_cv_header_time" 1>&6
+if test $ac_cv_header_time = yes; then
+  cat >> confdefs.h <<\EOF
+#define TIME_WITH_SYS_TIME 1
+EOF
+
+fi
+
+
+if test $ac_cv_prog_gcc = yes; then
+    echo $ac_n "checking whether ${CC-cc} needs -traditional""... $ac_c" 1>&6
+echo "configure:2199: checking whether ${CC-cc} needs -traditional" >&5
+if eval "test \"`echo '$''{'ac_cv_prog_gcc_traditional'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+    ac_pattern="Autoconf.*'x'"
+  cat > conftest.$ac_ext <<EOF
+#line 2205 "configure"
+#include "confdefs.h"
+#include <sgtty.h>
+Autoconf TIOCGETP
+EOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  egrep "$ac_pattern" >/dev/null 2>&1; then
+  rm -rf conftest*
+  ac_cv_prog_gcc_traditional=yes
+else
+  rm -rf conftest*
+  ac_cv_prog_gcc_traditional=no
+fi
+rm -f conftest*
+
+
+  if test $ac_cv_prog_gcc_traditional = no; then
+    cat > conftest.$ac_ext <<EOF
+#line 2223 "configure"
+#include "confdefs.h"
+#include <termio.h>
+Autoconf TCGETA
+EOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  egrep "$ac_pattern" >/dev/null 2>&1; then
+  rm -rf conftest*
+  ac_cv_prog_gcc_traditional=yes
+fi
+rm -f conftest*
+
+  fi
+fi
+
+echo "$ac_t""$ac_cv_prog_gcc_traditional" 1>&6
+  if test $ac_cv_prog_gcc_traditional = yes; then
+    CC="$CC -traditional"
+  fi
+fi
+
+echo $ac_n "checking whether setpgrp takes no argument""... $ac_c" 1>&6
+echo "configure:2245: checking whether setpgrp takes no argument" >&5
+if eval "test \"`echo '$''{'ac_cv_func_setpgrp_void'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  if test "$cross_compiling" = yes; then
+  { echo "configure: error: cannot check setpgrp if cross compiling" 1>&2; exit 1; }
+else
+  cat > conftest.$ac_ext <<EOF
+#line 2253 "configure"
+#include "confdefs.h"
+
+#ifdef HAVE_UNISTD_H
+#include <unistd.h>
+#endif
+
+/*
+ * If this system has a BSD-style setpgrp, which takes arguments, exit
+ * successfully.
+ */
+main()
+{
+    if (setpgrp(1,1) == -1)
+	exit(0);
+    else
+	exit(1);
+}
+
+EOF
+if { (eval echo configure:2273: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  ac_cv_func_setpgrp_void=no
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  ac_cv_func_setpgrp_void=yes
+fi
+rm -fr conftest*
+fi
+
+
+fi
+
+echo "$ac_t""$ac_cv_func_setpgrp_void" 1>&6
+if test $ac_cv_func_setpgrp_void = yes; then
+  cat >> confdefs.h <<\EOF
+#define SETPGRP_VOID 1
+EOF
+
+fi
+
+echo $ac_n "checking return type of signal handlers""... $ac_c" 1>&6
+echo "configure:2297: checking return type of signal handlers" >&5
+if eval "test \"`echo '$''{'ac_cv_type_signal'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 2302 "configure"
+#include "confdefs.h"
+#include <sys/types.h>
+#include <signal.h>
+#ifdef signal
+#undef signal
+#endif
+#ifdef __cplusplus
+extern "C" void (*signal (int, void (*)(int)))(int);
+#else
+void (*signal ()) ();
+#endif
+
+int main() {
+int i;
+; return 0; }
+EOF
+if { (eval echo configure:2319: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+  rm -rf conftest*
+  ac_cv_type_signal=void
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  ac_cv_type_signal=int
+fi
+rm -f conftest*
+fi
+
+echo "$ac_t""$ac_cv_type_signal" 1>&6
+cat >> confdefs.h <<EOF
+#define RETSIGTYPE $ac_cv_type_signal
+EOF
+
+
+echo $ac_n "checking for vprintf""... $ac_c" 1>&6
+echo "configure:2338: checking for vprintf" >&5
+if eval "test \"`echo '$''{'ac_cv_func_vprintf'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 2343 "configure"
+#include "confdefs.h"
+/* System header to define __stub macros and hopefully few prototypes,
+    which can conflict with char vprintf(); below.  */
+#include <assert.h>
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char vprintf();
+
+int main() {
+
+/* The GNU C library defines this for functions which it implements
+    to always fail with ENOSYS.  Some functions are actually named
+    something starting with __ and the normal name is an alias.  */
+#if defined (__stub_vprintf) || defined (__stub___vprintf)
+choke me
+#else
+vprintf();
+#endif
+
+; return 0; }
+EOF
+if { (eval echo configure:2366: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func_vprintf=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_func_vprintf=no"
+fi
+rm -f conftest*
+fi
+
+if eval "test \"`echo '$ac_cv_func_'vprintf`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  cat >> confdefs.h <<\EOF
+#define HAVE_VPRINTF 1
+EOF
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+if test "$ac_cv_func_vprintf" != yes; then
+echo $ac_n "checking for _doprnt""... $ac_c" 1>&6
+echo "configure:2390: checking for _doprnt" >&5
+if eval "test \"`echo '$''{'ac_cv_func__doprnt'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 2395 "configure"
+#include "confdefs.h"
+/* System header to define __stub macros and hopefully few prototypes,
+    which can conflict with char _doprnt(); below.  */
+#include <assert.h>
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char _doprnt();
+
+int main() {
+
+/* The GNU C library defines this for functions which it implements
+    to always fail with ENOSYS.  Some functions are actually named
+    something starting with __ and the normal name is an alias.  */
+#if defined (__stub__doprnt) || defined (__stub____doprnt)
+choke me
+#else
+_doprnt();
+#endif
+
+; return 0; }
+EOF
+if { (eval echo configure:2418: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func__doprnt=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_func__doprnt=no"
+fi
+rm -f conftest*
+fi
+
+if eval "test \"`echo '$ac_cv_func_'_doprnt`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  cat >> confdefs.h <<\EOF
+#define HAVE_DOPRNT 1
+EOF
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+fi
+
+echo $ac_n "checking for wait3 that fills in rusage""... $ac_c" 1>&6
+echo "configure:2443: checking for wait3 that fills in rusage" >&5
+if eval "test \"`echo '$''{'ac_cv_func_wait3_rusage'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  if test "$cross_compiling" = yes; then
+  ac_cv_func_wait3_rusage=no
+else
+  cat > conftest.$ac_ext <<EOF
+#line 2451 "configure"
+#include "confdefs.h"
+#include <sys/types.h>
+#include <sys/time.h>
+#include <sys/resource.h>
+#include <stdio.h>
+/* HP-UX has wait3 but does not fill in rusage at all.  */
+main() {
+  struct rusage r;
+  int i;
+  /* Use a field that we can force nonzero --
+     voluntary context switches.
+     For systems like NeXT and OSF/1 that don't set it,
+     also use the system CPU time.  And page faults (I/O) for Linux.  */
+  r.ru_nvcsw = 0;
+  r.ru_stime.tv_sec = 0;
+  r.ru_stime.tv_usec = 0;
+  r.ru_majflt = r.ru_minflt = 0;
+  switch (fork()) {
+  case 0: /* Child.  */
+    sleep(1); /* Give up the CPU.  */
+    _exit(0);
+  case -1: _exit(0); /* What can we do?  */
+  default: /* Parent.  */
+    wait3(&i, 0, &r);
+    sleep(2); /* Avoid "text file busy" from rm on fast HP-UX machines.  */
+    exit(r.ru_nvcsw == 0 && r.ru_majflt == 0 && r.ru_minflt == 0
+	 && r.ru_stime.tv_sec == 0 && r.ru_stime.tv_usec == 0);
+  }
+}
+EOF
+if { (eval echo configure:2482: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+then
+  ac_cv_func_wait3_rusage=yes
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -fr conftest*
+  ac_cv_func_wait3_rusage=no
+fi
+rm -fr conftest*
+fi
+
+fi
+
+echo "$ac_t""$ac_cv_func_wait3_rusage" 1>&6
+if test $ac_cv_func_wait3_rusage = yes; then
+  cat >> confdefs.h <<\EOF
+#define HAVE_WAIT3 1
+EOF
+
+fi
+
+for ac_func in regcomp select socket strcspn strdup strtol
+do
+echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
+echo "configure:2507: checking for $ac_func" >&5
+if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 2512 "configure"
+#include "confdefs.h"
+/* System header to define __stub macros and hopefully few prototypes,
+    which can conflict with char $ac_func(); below.  */
+#include <assert.h>
+/* Override any gcc2 internal prototype to avoid an error.  */
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char $ac_func();
+
+int main() {
+
+/* The GNU C library defines this for functions which it implements
+    to always fail with ENOSYS.  Some functions are actually named
+    something starting with __ and the normal name is an alias.  */
+#if defined (__stub_$ac_func) || defined (__stub___$ac_func)
+choke me
+#else
+$ac_func();
+#endif
+
+; return 0; }
+EOF
+if { (eval echo configure:2535: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_func_$ac_func=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_func_$ac_func=no"
+fi
+rm -f conftest*
+fi
+
+if eval "test \"`echo '$ac_cv_func_'$ac_func`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_func=HAVE_`echo $ac_func | tr 'abcdefghijklmnopqrstuvwxyz' 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_func 1
+EOF
+ 
+else
+  echo "$ac_t""no" 1>&6
+fi
+done
+
+
+trap '' 1 2 15
+cat > confcache <<\EOF
+# This file is a shell script that caches the results of configure
+# tests run on this system so they can be shared between configure
+# scripts and configure runs.  It is not useful on other systems.
+# If it contains results you don't want to keep, you may remove or edit it.
+#
+# By default, configure uses ./config.cache as the cache file,
+# creating it if it does not exist already.  You can give configure
+# the --cache-file=FILE option to use a different cache file; that is
+# what configure does when it calls configure scripts in
+# subdirectories, so they share the cache.
+# Giving --cache-file=/dev/null disables caching, for debugging configure.
+# config.status only pays attention to the cache file if you give it the
+# --recheck option to rerun configure.
+#
+EOF
+# The following way of writing the cache mishandles newlines in values,
+# but we know of no workaround that is simple, portable, and efficient.
+# So, don't put newlines in cache variables' values.
+# Ultrix sh set writes to stderr and can't be redirected directly,
+# and sets the high bit in the cache file unless we assign to the vars.
+(set) 2>&1 |
+  case `(ac_space=' '; set | grep ac_space) 2>&1` in
+  *ac_space=\ *)
+    # `set' does not quote correctly, so add quotes (double-quote substitution
+    # turns \\\\ into \\, and sed turns \\ into \).
+    sed -n \
+      -e "s/'/'\\\\''/g" \
+      -e "s/^\\([a-zA-Z0-9_]*_cv_[a-zA-Z0-9_]*\\)=\\(.*\\)/\\1=\${\\1='\\2'}/p"
+    ;;
+  *)
+    # `set' quotes correctly as required by POSIX, so do not add quotes.
+    sed -n -e 's/^\([a-zA-Z0-9_]*_cv_[a-zA-Z0-9_]*\)=\(.*\)/\1=${\1=\2}/p'
+    ;;
+  esac >> confcache
+if cmp -s $cache_file confcache; then
+  :
+else
+  if test -w $cache_file; then
+    echo "updating cache $cache_file"
+    cat confcache > $cache_file
+  else
+    echo "not updating unwritable cache $cache_file"
+  fi
+fi
+rm -f confcache
+
+trap 'rm -fr conftest* confdefs* core core.* *.core $ac_clean_files; exit 1' 1 2 15
+
+test "x$prefix" = xNONE && prefix=$ac_default_prefix
+# Let make expand exec_prefix.
+test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
+
+# Any assignment to VPATH causes Sun make to only execute
+# the first set of double-colon rules, so remove it if not needed.
+# If there is a colon in the path, we need to keep it.
+if test "x$srcdir" = x.; then
+  ac_vpsub='/^[ 	]*VPATH[ 	]*=[^:]*$/d'
+fi
+
+trap 'rm -f $CONFIG_STATUS conftest*; exit 1' 1 2 15
+
+DEFS=-DHAVE_CONFIG_H
+
+# Without the "./", some shells look in PATH for config.status.
+: ${CONFIG_STATUS=./config.status}
+
+echo creating $CONFIG_STATUS
+rm -f $CONFIG_STATUS
+cat > $CONFIG_STATUS <<EOF
+#! /bin/sh
+# Generated automatically by configure.
+# Run this file to recreate the current configuration.
+# This directory was configured as follows,
+# on host `(hostname || uname -n) 2>/dev/null | sed 1q`:
+#
+# $0 $ac_configure_args
+#
+# Compiler output produced by configure, useful for debugging
+# configure, is in ./config.log if it exists.
+
+ac_cs_usage="Usage: $CONFIG_STATUS [--recheck] [--version] [--help]"
+for ac_option
+do
+  case "\$ac_option" in
+  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
+    echo "running \${CONFIG_SHELL-/bin/sh} $0 $ac_configure_args --no-create --no-recursion"
+    exec \${CONFIG_SHELL-/bin/sh} $0 $ac_configure_args --no-create --no-recursion ;;
+  -version | --version | --versio | --versi | --vers | --ver | --ve | --v)
+    echo "$CONFIG_STATUS generated by autoconf version 2.13"
+    exit 0 ;;
+  -help | --help | --hel | --he | --h)
+    echo "\$ac_cs_usage"; exit 0 ;;
+  *) echo "\$ac_cs_usage"; exit 1 ;;
+  esac
+done
+
+ac_given_srcdir=$srcdir
+
+trap 'rm -fr `echo "Makefile config.h" | sed "s/:[^ ]*//g"` conftest*; exit 1' 1 2 15
+EOF
+cat >> $CONFIG_STATUS <<EOF
+
+# Protect against being on the right side of a sed subst in config.status.
+sed 's/%@/@@/; s/@%/@@/; s/%g\$/@g/; /@g\$/s/[\\\\&%]/\\\\&/g;
+ s/@@/%@/; s/@@/@%/; s/@g\$/%g/' > conftest.subs <<\\CEOF
+$ac_vpsub
+$extrasub
+s%@SHELL@%$SHELL%g
+s%@CFLAGS@%$CFLAGS%g
+s%@CPPFLAGS@%$CPPFLAGS%g
+s%@CXXFLAGS@%$CXXFLAGS%g
+s%@FFLAGS@%$FFLAGS%g
+s%@DEFS@%$DEFS%g
+s%@LDFLAGS@%$LDFLAGS%g
+s%@LIBS@%$LIBS%g
+s%@exec_prefix@%$exec_prefix%g
+s%@prefix@%$prefix%g
+s%@program_transform_name@%$program_transform_name%g
+s%@bindir@%$bindir%g
+s%@sbindir@%$sbindir%g
+s%@libexecdir@%$libexecdir%g
+s%@datadir@%$datadir%g
+s%@sysconfdir@%$sysconfdir%g
+s%@sharedstatedir@%$sharedstatedir%g
+s%@localstatedir@%$localstatedir%g
+s%@libdir@%$libdir%g
+s%@includedir@%$includedir%g
+s%@oldincludedir@%$oldincludedir%g
+s%@infodir@%$infodir%g
+s%@mandir@%$mandir%g
+s%@SET_MAKE@%$SET_MAKE%g
+s%@CC@%$CC%g
+s%@host@%$host%g
+s%@host_alias@%$host_alias%g
+s%@host_cpu@%$host_cpu%g
+s%@host_vendor@%$host_vendor%g
+s%@host_os@%$host_os%g
+s%@target@%$target%g
+s%@target_alias@%$target_alias%g
+s%@target_cpu@%$target_cpu%g
+s%@target_vendor@%$target_vendor%g
+s%@target_os@%$target_os%g
+s%@build@%$build%g
+s%@build_alias@%$build_alias%g
+s%@build_cpu@%$build_cpu%g
+s%@build_vendor@%$build_vendor%g
+s%@build_os@%$build_os%g
+s%@DEFINES@%$DEFINES%g
+s%@PIDFILE@%$PIDFILE%g
+s%@DB@%$DB%g
+s%@OS@%$OS%g
+s%@CPP@%$CPP%g
+
+CEOF
+EOF
+
+cat >> $CONFIG_STATUS <<\EOF
+
+# Split the substitutions into bite-sized pieces for seds with
+# small command number limits, like on Digital OSF/1 and HP-UX.
+ac_max_sed_cmds=90 # Maximum number of lines to put in a sed script.
+ac_file=1 # Number of current file.
+ac_beg=1 # First line for current file.
+ac_end=$ac_max_sed_cmds # Line after last line for current file.
+ac_more_lines=:
+ac_sed_cmds=""
+while $ac_more_lines; do
+  if test $ac_beg -gt 1; then
+    sed "1,${ac_beg}d; ${ac_end}q" conftest.subs > conftest.s$ac_file
+  else
+    sed "${ac_end}q" conftest.subs > conftest.s$ac_file
+  fi
+  if test ! -s conftest.s$ac_file; then
+    ac_more_lines=false
+    rm -f conftest.s$ac_file
+  else
+    if test -z "$ac_sed_cmds"; then
+      ac_sed_cmds="sed -f conftest.s$ac_file"
+    else
+      ac_sed_cmds="$ac_sed_cmds | sed -f conftest.s$ac_file"
+    fi
+    ac_file=`expr $ac_file + 1`
+    ac_beg=$ac_end
+    ac_end=`expr $ac_end + $ac_max_sed_cmds`
+  fi
+done
+if test -z "$ac_sed_cmds"; then
+  ac_sed_cmds=cat
+fi
+EOF
+
+cat >> $CONFIG_STATUS <<EOF
+
+CONFIG_FILES=\${CONFIG_FILES-"Makefile"}
+EOF
+cat >> $CONFIG_STATUS <<\EOF
+for ac_file in .. $CONFIG_FILES; do if test "x$ac_file" != x..; then
+  # Support "outfile[:infile[:infile...]]", defaulting infile="outfile.in".
+  case "$ac_file" in
+  *:*) ac_file_in=`echo "$ac_file"|sed 's%[^:]*:%%'`
+       ac_file=`echo "$ac_file"|sed 's%:.*%%'` ;;
+  *) ac_file_in="${ac_file}.in" ;;
+  esac
+
+  # Adjust a relative srcdir, top_srcdir, and INSTALL for subdirectories.
+
+  # Remove last slash and all that follows it.  Not all systems have dirname.
+  ac_dir=`echo $ac_file|sed 's%/[^/][^/]*$%%'`
+  if test "$ac_dir" != "$ac_file" && test "$ac_dir" != .; then
+    # The file is in a subdirectory.
+    test ! -d "$ac_dir" && mkdir "$ac_dir"
+    ac_dir_suffix="/`echo $ac_dir|sed 's%^\./%%'`"
+    # A "../" for each directory in $ac_dir_suffix.
+    ac_dots=`echo $ac_dir_suffix|sed 's%/[^/]*%../%g'`
+  else
+    ac_dir_suffix= ac_dots=
+  fi
+
+  case "$ac_given_srcdir" in
+  .)  srcdir=.
+      if test -z "$ac_dots"; then top_srcdir=.
+      else top_srcdir=`echo $ac_dots|sed 's%/$%%'`; fi ;;
+  /*) srcdir="$ac_given_srcdir$ac_dir_suffix"; top_srcdir="$ac_given_srcdir" ;;
+  *) # Relative path.
+    srcdir="$ac_dots$ac_given_srcdir$ac_dir_suffix"
+    top_srcdir="$ac_dots$ac_given_srcdir" ;;
+  esac
+
+
+  echo creating "$ac_file"
+  rm -f "$ac_file"
+  configure_input="Generated automatically from `echo $ac_file_in|sed 's%.*/%%'` by configure."
+  case "$ac_file" in
+  *Makefile*) ac_comsub="1i\\
+# $configure_input" ;;
+  *) ac_comsub= ;;
+  esac
+
+  ac_file_inputs=`echo $ac_file_in|sed -e "s%^%$ac_given_srcdir/%" -e "s%:% $ac_given_srcdir/%g"`
+  sed -e "$ac_comsub
+s%@configure_input@%$configure_input%g
+s%@srcdir@%$srcdir%g
+s%@top_srcdir@%$top_srcdir%g
+" $ac_file_inputs | (eval "$ac_sed_cmds") > $ac_file
+fi; done
+rm -f conftest.s*
+
+# These sed commands are passed to sed as "A NAME B NAME C VALUE D", where
+# NAME is the cpp macro being defined and VALUE is the value it is being given.
+#
+# ac_d sets the value in "#define NAME VALUE" lines.
+ac_dA='s%^\([ 	]*\)#\([ 	]*define[ 	][ 	]*\)'
+ac_dB='\([ 	][ 	]*\)[^ 	]*%\1#\2'
+ac_dC='\3'
+ac_dD='%g'
+# ac_u turns "#undef NAME" with trailing blanks into "#define NAME VALUE".
+ac_uA='s%^\([ 	]*\)#\([ 	]*\)undef\([ 	][ 	]*\)'
+ac_uB='\([ 	]\)%\1#\2define\3'
+ac_uC=' '
+ac_uD='\4%g'
+# ac_e turns "#undef NAME" without trailing blanks into "#define NAME VALUE".
+ac_eA='s%^\([ 	]*\)#\([ 	]*\)undef\([ 	][ 	]*\)'
+ac_eB='$%\1#\2define\3'
+ac_eC=' '
+ac_eD='%g'
+
+if test "${CONFIG_HEADERS+set}" != set; then
+EOF
+cat >> $CONFIG_STATUS <<EOF
+  CONFIG_HEADERS="config.h"
+EOF
+cat >> $CONFIG_STATUS <<\EOF
+fi
+for ac_file in .. $CONFIG_HEADERS; do if test "x$ac_file" != x..; then
+  # Support "outfile[:infile[:infile...]]", defaulting infile="outfile.in".
+  case "$ac_file" in
+  *:*) ac_file_in=`echo "$ac_file"|sed 's%[^:]*:%%'`
+       ac_file=`echo "$ac_file"|sed 's%:.*%%'` ;;
+  *) ac_file_in="${ac_file}.in" ;;
+  esac
+
+  echo creating $ac_file
+
+  rm -f conftest.frag conftest.in conftest.out
+  ac_file_inputs=`echo $ac_file_in|sed -e "s%^%$ac_given_srcdir/%" -e "s%:% $ac_given_srcdir/%g"`
+  cat $ac_file_inputs > conftest.in
+
+EOF
+
+# Transform confdefs.h into a sed script conftest.vals that substitutes
+# the proper values into config.h.in to produce config.h.  And first:
+# Protect against being on the right side of a sed subst in config.status.
+# Protect against being in an unquoted here document in config.status.
+rm -f conftest.vals
+cat > conftest.hdr <<\EOF
+s/[\\&%]/\\&/g
+s%[\\$`]%\\&%g
+s%#define \([A-Za-z_][A-Za-z0-9_]*\) *\(.*\)%${ac_dA}\1${ac_dB}\1${ac_dC}\2${ac_dD}%gp
+s%ac_d%ac_u%gp
+s%ac_u%ac_e%gp
+EOF
+sed -n -f conftest.hdr confdefs.h > conftest.vals
+rm -f conftest.hdr
+
+# This sed command replaces #undef with comments.  This is necessary, for
+# example, in the case of _POSIX_SOURCE, which is predefined and required
+# on some systems where configure will not decide to define it.
+cat >> conftest.vals <<\EOF
+s%^[ 	]*#[ 	]*undef[ 	][ 	]*[a-zA-Z_][a-zA-Z_0-9]*%/* & */%
+EOF
+
+# Break up conftest.vals because some shells have a limit on
+# the size of here documents, and old seds have small limits too.
+
+rm -f conftest.tail
+while :
+do
+  ac_lines=`grep -c . conftest.vals`
+  # grep -c gives empty output for an empty file on some AIX systems.
+  if test -z "$ac_lines" || test "$ac_lines" -eq 0; then break; fi
+  # Write a limited-size here document to conftest.frag.
+  echo '  cat > conftest.frag <<CEOF' >> $CONFIG_STATUS
+  sed ${ac_max_here_lines}q conftest.vals >> $CONFIG_STATUS
+  echo 'CEOF
+  sed -f conftest.frag conftest.in > conftest.out
+  rm -f conftest.in
+  mv conftest.out conftest.in
+' >> $CONFIG_STATUS
+  sed 1,${ac_max_here_lines}d conftest.vals > conftest.tail
+  rm -f conftest.vals
+  mv conftest.tail conftest.vals
+done
+rm -f conftest.vals
+
+cat >> $CONFIG_STATUS <<\EOF
+  rm -f conftest.frag conftest.h
+  echo "/* $ac_file.  Generated automatically by configure.  */" > conftest.h
+  cat conftest.in >> conftest.h
+  rm -f conftest.in
+  if cmp -s $ac_file conftest.h 2>/dev/null; then
+    echo "$ac_file is unchanged"
+    rm -f conftest.h
+  else
+    # Remove last slash and all that follows it.  Not all systems have dirname.
+      ac_dir=`echo $ac_file|sed 's%/[^/][^/]*$%%'`
+      if test "$ac_dir" != "$ac_file" && test "$ac_dir" != .; then
+      # The file is in a subdirectory.
+      test ! -d "$ac_dir" && mkdir "$ac_dir"
+    fi
+    rm -f $ac_file
+    mv conftest.h $ac_file
+  fi
+fi; done
+
+EOF
+cat >> $CONFIG_STATUS <<EOF
+
+EOF
+cat >> $CONFIG_STATUS <<\EOF
+echo timestamp > stamp-h
+exit 0
+EOF
+chmod +x $CONFIG_STATUS
+rm -fr confdefs* $ac_clean_files
+test "$no_create" = yes || ${CONFIG_SHELL-/bin/sh} $CONFIG_STATUS || exit 1
+
diff -uNr tac_plus.F4.0.3.alpha/configure.in 081101/configure.in
--- tac_plus.F4.0.3.alpha/configure.in	Thu Jan  1 02:00:00 1970
+++ 081101/configure.in	Thu Nov  8 12:23:58 2001
@@ -0,0 +1,271 @@
+dnl This file writen by Devrim SERAL for tac_plus daemon
+
+AC_INIT()
+
+dnl Checks for programs.
+AC_PROG_MAKE_SET
+AC_PROG_CC
+
+dnl Check for Host information
+dnl AC_CANONICAL_HOST()
+AC_CANONICAL_SYSTEM()
+
+case $host_os in 
+	*linux-gnu)
+	OS="-DLINUX -DGLIBC"
+	;;
+	*solaris*)
+	OS="-DSOLARIS"
+	;;
+	*freebsd*)
+	OS="-DFREEBSD"
+	;;
+	*hpux)
+	OS="-DHPUX"
+	;;
+	*aix)
+	OS="-DAIX"
+	;;
+	*)
+	;;
+esac
+	
+dnl Checks for libraries.
+dnl Replace `main' with a function in -lnsl:
+AC_CHECK_LIB(nsl, main)
+dnl Replace `main' with a function in -log:
+AC_CHECK_LIB(og, main)
+dnl Replace `main' with a function in -lsocket:
+AC_CHECK_LIB(socket, main)
+dnl Check for Crypt function
+AC_CHECK_LIB(crypt, crypt)
+AC_CHECK_LIB(c,printf)
+
+
+dnl Devrim Added 
+AC_CONFIG_HEADER(config.h)
+
+dnl For PAM support
+AC_MSG_CHECKING(for PAM support:)
+echo
+AC_ARG_WITH(pam,
+	[  --with-pam		With PAM Support   ],,)
+if test "x$with_pam" = "xyes";then
+	AC_CHECK_LIB(dl, dlopen)
+	AC_CHECK_LIB(pam, pam_start)
+	DEFINES="-DUSE_PAM $DEFINES";
+        AC_MSG_RESULT(Pam support... yes)
+else
+        AC_MSG_RESULT(Pam support... no)
+fi
+
+dnl For LDAP Support
+AC_MSG_CHECKING(for LDAP support)
+echo
+AC_ARG_WITH(ldap,
+        [  --with-ldap		With LDAP Support   ],,)
+
+if test "x$with_ldap" = "xyes";then
+	AC_CHECK_LIB(ldap, main)
+	AC_CHECK_LIB(lber, main)
+   	AC_CHECK_LIB(ldap, ldap_simple_bind_s)
+   	AC_CHECK_LIB(ldap, ldap_init)
+ 
+   DEFINES="-DUSE_LDAP $DEFINES"
+        AC_MSG_RESULT(LDAP support... yes)
+else
+        AC_MSG_RESULT(LDAP support... no)
+fi
+
+dnl For DB Support
+AC_MSG_CHECKING(for DB support)
+echo 
+AC_ARG_WITH(db,
+        [  --with-db		For DB Support   ],,)
+if test "x$with_db" = "xyes";then
+	DB="$DB -DDB -DDB_NULL"	
+	AC_MSG_RESULT(DB support... yes)
+else
+	AC_MSG_RESULT(DB support... no)
+fi
+
+dnl For MySQL support
+if test "x$with_db" = "xyes";then
+
+echo "Check for MySQL support:"
+
+AC_ARG_WITH(mysql,
+	[  --with-mysql		With MySQL Support   ],,)
+
+AC_ARG_WITH(mysql-include-dir,
+        [  --with-mysql-include-dir=PREFIX  Mysql include path [default=/usr/include/mysql]],
+	MYSQL_INCLUDE_DIR=$withval,
+	MYSQL_INCLUDE_DIR=/usr/include/mysql
+)
+
+AC_ARG_WITH(mysql-lib-dir,
+        [  --with-mysql-lib-dir=PREFIX  Mysql library path [default=/usr/lib/mysql]],
+	MYSQL_LIB_DIR=$withval,
+	MYSQL_LIB_DIR=/usr/lib/mysql
+)
+
+
+if test "x$with_mysql" = "xyes";then
+	
+	LDFLAGS="-L$MYSQL_LIB_DIR $LDFLAGS"
+        LDFLAGS="-I$MYSQL_INCLUDE_DIR $LDFLAGS"
+        AC_CHECK_LIB(mysqlclient, mysql_init,
+                        LIBS="-lmysqlclient -lm $LIBS",
+                        AC_MSG_ERROR(*** couldn't find libmysqlclient),
+                        -lm)
+
+	DB="$DB -DDB_MYSQL";
+        AC_MSG_RESULT(Mysql support... yes)
+else
+        AC_MSG_RESULT(Mysql support... no)
+fi
+
+fi
+
+dnl For PgSQL support
+if test "x$with_db" = "xyes";then
+
+echo "Check for PgSQL support:"
+
+AC_ARG_WITH(pgsql,
+	[  --with-pgsql		With PgSQL Support   ],,)
+
+AC_ARG_WITH(pgsql-include-dir,
+        [  --with-pgsql-include-dir=PREFIX  PgSQL include path [default=/usr/include/pgsql]],
+	PGSQL_INCLUDE_DIR=$withval,
+	PGSQL_INCLUDE_DIR=/usr/include/pgsql
+)
+
+AC_ARG_WITH(pgsql-lib-dir,
+        [  --with-pgsql-lib-dir=PREFIX  PgSQL library path [default=/usr/lib/pgsql]],
+	PGSQL_LIB_DIR=$withval,
+	PGSQL_LIB=/usr/lib/pgsql
+)
+
+
+if test "x$with_pgsql" = "xyes";then
+	
+	LDFLAGS="-I$PGSQL_INCLUDE_DIR $LDFLAGS"
+        LDFLAGS="-L$PGSQL_LIB_DIR $LDFLAGS"
+        AC_CHECK_LIB(pq,PQconnectdb ,
+                        LIBS="-lpq $LIBS",
+                        AC_MSG_ERROR(*** couldn't find libpq))
+
+	DB="$DB -DDB_PGSQL";
+        AC_MSG_RESULT(Pgsql support... yes)
+else
+        AC_MSG_RESULT(Pgsql support... no)
+fi
+
+fi
+
+dnl Tacuid & tac guid 
+
+AC_ARG_WITH(tacuid,
+		[  --with-tacuid=ID	If you want to run tac_plus other than root user (no default value) ],,)
+AC_ARG_WITH(tacgid,
+ 		[  --with-tacgid=GID	If you want to run tac_plus other than root group(no default value) ],,)
+
+
+if (test "x$with_tacuid" != "x" && test "x$with_tacgid" != "x" && test "x$with_tacuid" != "xyes" && test "x$with_tacgid" != "xyes");then
+
+ 	DEFINES="-DTACPLUS_USERID=$with_tacuid -DTACPLUS_GROUPID=$with_tacgid $DEFINES";	
+	AC_MSG_RESULT(tacacs+ work with given user and group id) 
+fi
+
+AC_MSG_CHECKING(whether to enable the maxsess feature)
+AC_ARG_ENABLE(maxsess,
+              [  --enable-maxsess	Enable maxsess feature ],
+[
+if test "$enableval" = "yes";then
+ 	DEFINES="-DMAXSESS $DEFINES";
+	AC_MSG_RESULT(yes)
+else 
+	AC_MSG_RESULT(no)
+fi
+],
+[
+	AC_MSG_RESULT(no)
+])
+
+dnl Enable tacacs.pid file directory 
+
+AC_ARG_WITH(tacplus_pid,
+        [  --with-tacplus_pid=PREFIX  Tac_plus pid file location [default=/var/run] ],
+        PIDFILE="-DTACPLUS_PIDFILE=\\\"$withval/tac_plus.pid\\\"",
+        PIDFILE="-DTACPLUS_PIDFILE=\\\"/var/run/tac_plus.pid\\\""
+)
+
+dnl For libwrap check
+AC_MSG_CHECKING(whether to enable the libwrap feture)
+
+AC_ARG_WITH(libwrap,
+[  --with-libwrap[=PATH]   Compile in libwrap (tcp_wrappers) support.],
+[ case "$withval" in
+  no)
+    AC_MSG_RESULT(no)
+    ;;
+  yes)
+    AC_MSG_RESULT(yes)
+    AC_CHECK_LIB(wrap, request_init, [
+        LIBS="-lwrap $LIBS"
+        DEFINES="-DTCPWRAPPER $DEFINES"])
+    ;;
+  *)
+    AC_MSG_RESULT(yes)
+    if test -d "$withval"; then
+        LDFLAGS="-L$withval $LDFLAGS"
+    	DEFINES="-DTCPWRAPPER $DEFINES"
+    fi
+    AC_TRY_LINK([ int allow_severity; int deny_severity; ],
+                [ hosts_access(); ],
+                [],
+                [ AC_MSG_ERROR(Could not find the $withval library.  You must first install tcp_wrappers.) ])
+    ;;
+  esac ],
+  AC_MSG_RESULT(no)
+)
+
+dnl Maxsess finger check
+if test "x$enable_maxsess" = "xyes"; then
+
+AC_ARG_ENABLE(finger,
+        [  --enable-finger	Enable finger at maxsess check ],
+	AC_MSG_RESULT("Enable whether finger at maxsess check: yes");
+	DEFINES="-DENABLE_FINGER $DEFINES",
+	AC_MSG_RESULT("Enable whether finger at maxsess check: no");
+)
+fi
+
+dnl insert defines to Makefile 
+AC_SUBST(DEFINES)
+AC_SUBST(PIDFILE)
+AC_SUBST(DB)
+AC_SUBST(OS)
+
+dnl Checks for header files.
+AC_HEADER_STDC
+AC_CHECK_HEADERS(fcntl.h malloc.h strings.h sys/file.h sys/ioctl.h sys/time.h syslog.h unistd.h)
+AC_CHECK_HEADERS(shadow.h,[
+		if test -f /etc/shadow ; then
+		  AC_DEFINE(SHADOW_PASSWORDS)		
+		fi 
+		],)
+dnl Checks for typedefs, structures, and compiler characteristics.
+AC_C_CONST
+AC_HEADER_TIME
+
+dnl Checks for library functions.
+AC_PROG_GCC_TRADITIONAL
+AC_FUNC_SETPGRP
+AC_TYPE_SIGNAL
+AC_FUNC_VPRINTF
+AC_FUNC_WAIT3
+AC_CHECK_FUNCS(regcomp select socket strcspn strdup strtol)
+
+AC_OUTPUT(Makefile,echo timestamp > stamp-h)
diff -uNr tac_plus.F4.0.3.alpha/convert.pl 081101/convert.pl
--- tac_plus.F4.0.3.alpha/convert.pl	Sat Apr  3 09:03:47 1999
+++ 081101/convert.pl	Wed Oct 31 14:50:28 2001
@@ -1,4 +1,4 @@
-#! /usr/local/bin/perl
+#! /usr/bin/perl
 
 # convert a passwd(5) and optional supplementary file into the new
 # file format
diff -uNr tac_plus.F4.0.3.alpha/db.c 081101/db.c
--- tac_plus.F4.0.3.alpha/db.c	Thu Jan  1 02:00:00 1970
+++ 081101/db.c	Thu Nov 29 13:16:08 2001
@@ -0,0 +1,401 @@
+/*
+     Verify that this user/password is valid per a database.
+     Return 1 if verified, 0 otherwise.
+     
+     Format of connection string (look like internet URL):
+
+       db://user:password@hostname/table?name&passwd
+
+     Example connect to Oracle RDBMS at user 'roger' with password
+     'tiger', to 'host.domain.com' database server, fields name in
+     table is 'name' and 'passwd' in 'oshadow' table:
+
+       oracle://roger:tiger@host.domain.com/oshadow?name&passwd
+
+     DONE:
+     12-nov-1998 Created
+                 Add DB support to 'login = db <string>'
+     14-nov-1998 Change Tacacs+ version from 0.95 to 3.0.9
+     18-nov-1998 Added code for Oracle [version 8.0.5]
+     27-nov-1998 Tested with 30'000 usernames Oracle database
+                 Added DB support to global configuration
+                 'default authentication = db <string>'
+     28-nov-1998 Added code for NULL database %)
+     
+     FUTURE:
+     Make *_db_verify() the functions is reenterable
+     More security for connection to database
+     GDBM support
+     Separate debug logging
+     Perfomance testing on 10000 records in Oracle database
+     (in guide sayd about 3 auth/sec on Ultra 2 - hmm)
+     
+     -------------------------------------------------------
+     fil@artelecom.ru                   http://twister.pp.ru
+ 
+ ****************************************************************************
+				    PART II
+
+   I am added some extra extension. Like MySQL and PostgreSQL database support
+   And change most of lines for use dynamic memory allocation. db_accounting 
+   added by me.
+  
+   devrim(devrim@gazi.edu.tr)
+*/
+
+#if defined(DB)
+#include <stdio.h>
+#include "tac_plus.h"
+#include "db.h"
+
+char *find_attr_value(); 
+
+int
+db_verify(user, users_passwd, str_conn)
+char *user, *users_passwd;      /* Username and gived password   */
+char *str_conn;                 /* String connection to database */
+{
+    char *buffer;
+    char *db_pref, *db_user, *db_password;
+    char *db_hostname, *db_table,*db_name,*dbfield_name, *dbfield_passwd;
+    int ret;
+
+    if (debug & DEBUG_PASSWD_FLAG)
+	report(LOG_DEBUG, "verify %s by database at %s", user, str_conn);
+
+    buffer = db_pref = (char *)malloc( strlen(str_conn) + 1 );
+    if( buffer == NULL ){
+	report(LOG_DEBUG, "Error allocation memory");
+        return(0);
+    }
+
+    strcpy( buffer, str_conn );
+
+    db_user = (char *)strstr( db_pref, "://" );
+    if( db_user == NULL ){
+	if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "Error parse db_user");
+    	    free(buffer);
+	    return(0);
+    }
+    *db_user = '\0'; 
+
+	/* For recognize db authentication database */
+    
+    if (check_db_type(db_pref)) {
+	report(LOG_DEBUG, "%s DB authentication scheme didn't recognize by tac_plus",db_pref);
+    	free(buffer);
+        return(0);
+    }
+
+    db_user += 3;
+
+    db_password = (char *)strstr( db_user, ":" );
+    if( db_password == NULL ){
+        if (debug & DEBUG_PASSWD_FLAG)
+    	     report(LOG_DEBUG, "Error parse db_password");
+    	free(buffer);
+        return(0);
+    }
+    *db_password = '\0';
+    db_password++;
+    
+    db_hostname = (char *)strstr( db_password, "@" );
+    if( db_hostname == NULL ){
+	if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "Error parse db_hostname");
+    	free(buffer);
+        return(0);
+    }
+    *db_hostname = '\0';
+    db_hostname++;
+    
+    db_name = (char *)strstr( db_hostname, "/" );
+    if( db_name == NULL ){
+        if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "Error parse db_name");
+    	free(buffer);
+        return(0);
+    } 
+    *db_name = '\0';
+    db_name++;
+    
+    db_table = (char *)strstr( db_name, "/" );
+    if( db_table == NULL ){
+        if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "Error parse db_table");
+    	free(buffer);
+        return(0);
+    } 
+    *db_table = '\0';
+    db_table++;
+    
+    dbfield_name = (char *)strstr( db_table, "?" );
+    if( dbfield_name == NULL){
+	if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "Error parse dbfield_name");
+    	free(buffer);
+        return(0);
+    }
+    *dbfield_name = '\0';
+    dbfield_name++;
+
+
+    dbfield_passwd = (char *)strstr( dbfield_name, "&" );
+    if( dbfield_passwd == NULL){
+	if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "Error parse dbfield_passwd");
+    	free(buffer);
+        return(0);
+    }
+    *dbfield_passwd = '\0';
+    dbfield_passwd++;
+    
+
+    /* Parse database connection string */
+	if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "db_verify: db_pref=%s, db_user=%s, db_password=%s db_hostname=%s, db_name=%s ,db_table=%s, dbfield_name=%s, dbfield_passwd=%s", db_pref, db_user, db_password, db_hostname, db_name,db_table, dbfield_name, dbfield_passwd);
+
+    /* Check for empty passwords */
+   if (users_passwd == NULL || *users_passwd == '\0' ||
+        db_password == NULL || *db_password == '\0' ) {
+        if (debug & DEBUG_PASSWD_FLAG)
+           report(LOG_DEBUG, "One from passwords is empty");
+    	free(buffer);
+	return (0);
+    }
+
+    ret = 0;
+
+    /* Run database depend function */
+#if defined(DB_ORACLE)
+    if (!strcmp(db_pref, "oracle")) {
+	ret = oracle_db_verify(
+	    user, users_passwd,
+	    db_user, db_password, db_hostname, db_table,
+	    dbfield_name, dbfield_passwd);
+    }
+#endif
+
+#if defined(DB_MYSQL)
+    if (!strcmp(db_pref, "mysql")) {
+	ret = mysql_db_verify(
+	    user, users_passwd,
+	    db_user, db_password, db_hostname, db_name, db_table,
+	    dbfield_name, dbfield_passwd);
+    }
+#endif
+
+#if defined(DB_PGSQL)
+    if (!strcmp(db_pref, "pgsql")) {
+	ret = pgsql_db_verify(
+	    user, users_passwd,
+	    db_user, db_password, db_hostname,db_name, db_table,
+	    dbfield_name, dbfield_passwd);
+    }
+#endif
+
+#if defined(DB_NULL)
+    if (!strcmp(db_pref, "null")) {
+        ret = null_db_verify(
+	    user, users_passwd,
+	    db_user, db_password, db_hostname ,db_table,
+	    dbfield_name, dbfield_passwd);
+    }
+#endif
+
+#if defined(DB_GDBM)
+    if (!strcmp(db_pref, "gdbm")) {
+        gdb_db_verify();
+    }
+#endif
+    free(buffer); /* Free unused memory */
+    return (ret); /* error */
+}
+
+
+/* Db accounting routine */
+int
+db_acct(rec)
+struct acct_rec *rec;
+{
+    char *buffer;
+    char *db_pref, *db_user, *db_password;
+    char *db_hostname, *db_name,*db_table;
+    char *a_username,*s_name,*c_name,*elapsed_time,*bytes_in,*bytes_out;
+    int ret;
+
+    buffer = db_pref = (char *)malloc( strlen(session.db_acct) + 1 );
+	
+    if( buffer == NULL ){
+	report(LOG_DEBUG, "Error allocation memory");
+        return(0);
+    }
+
+    strcpy( buffer, session.db_acct);
+
+    db_user = (char *)strstr( db_pref, "://" );
+    if( db_user == NULL ){
+	if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "Error parse db_user");
+        free(buffer);
+	return(0);
+    }
+    *db_user = '\0'; 
+
+	/* For recognize db accouting database */
+    
+    if( check_db_type(db_pref) ) {
+	report(LOG_DEBUG, "%s DB accounting scheme didn't recognize by tac_plus",db_pref);
+        free(buffer);
+        return(0);
+    }
+
+    db_user += 3;
+
+    db_password = (char *)strstr( db_user, ":" );
+    if( db_password == NULL ){
+        if (debug & DEBUG_PASSWD_FLAG)
+    	    report(LOG_DEBUG, "Error parse db_password");
+        free(buffer);
+        return(0);
+    }
+    *db_password = '\0';
+    db_password++;
+    
+    db_hostname = (char *)strstr( db_password, "@" );
+    if( db_hostname == NULL ){
+	if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "Error parse db_hostname");
+        free(buffer);
+        return(0);
+    }
+    *db_hostname = '\0';
+    db_hostname++;
+    
+    db_name = (char *)strstr( db_hostname, "/" );
+    if( db_name == NULL ){
+        if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "Error parse db_name");
+        free(buffer);
+        return(0);
+    } 
+    *db_name = '\0';
+    db_name++;
+    
+    db_table = (char *)strstr( db_name, "/" );
+    if( db_table == NULL ){
+        if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "Error parse db_table");
+        free(buffer);
+        return(0);
+    } 
+    *db_table = '\0';
+    db_table++;
+
+/* Find some attributes  for accounting */
+    a_username=rec->identity->username;
+    	if (a_username==NULL ) {
+        	if (debug & DEBUG_PASSWD_FLAG) 
+			report(LOG_DEBUG,"db_acct: Can't find username!");
+        		free(buffer);
+			return(0);
+	}
+    s_name=rec->identity->NAS_name;
+    	if (s_name==NULL) {
+        	if (debug & DEBUG_PASSWD_FLAG) 
+			report(LOG_DEBUG,"db_acct: Can't find NAS name!");
+        		free(buffer);
+			return(0);
+	}
+    c_name=find_attr_value("addr", rec->args, rec->num_args);
+    	if (c_name==NULL) {
+        	if (debug & DEBUG_PASSWD_FLAG) 
+			report(LOG_DEBUG,"db_acct: Can't find client adress!");
+	/* Can't find client adress so give NAC_address attribute value */ 
+		c_name=rec->identity->NAC_address;
+	}
+    elapsed_time=find_attr_value("elapsed_time", rec->args, rec->num_args);
+    	if (elapsed_time==NULL) {
+        	if (debug & DEBUG_PASSWD_FLAG) 
+			report(LOG_DEBUG,"db_acct: Can't get elapsed time!");
+        		free(buffer);
+			return(0);
+	}
+    bytes_in=find_attr_value("bytes_in", rec->args, rec->num_args);
+    	if (bytes_in==NULL) bytes_in="0";
+    bytes_out=find_attr_value("bytes_out", rec->args, rec->num_args);
+    	if (bytes_out==NULL) bytes_out="0";
+
+
+    /* Parse database connection string */
+	if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "db_verify: db_pref=%s, db_user=%s,db_password=%s , db_hostname=%s, db_name=%s ,db_table=%s ",
+        	db_pref, db_user, db_password,
+        	db_hostname, db_name,db_table );
+
+    /* Check for empty passwords */
+   if (db_user == NULL || db_password == '\0' ) {
+        if (debug & DEBUG_PASSWD_FLAG)
+           report(LOG_DEBUG, "One from passwords is empty");
+        free(buffer);
+	return (0);
+    }
+
+    ret = 0;
+    /* Run database depend function */
+#if defined(DB_ORACLE)
+    if (!strcmp(db_pref, "oracle")) {
+	ret = oracle_db_acct(
+	    db_user, db_password, db_hostname, db_name, db_table);
+    }
+#endif
+
+#if defined(DB_MYSQL)
+    if (!strcmp(db_pref, "mysql")) {
+	ret = mysql_db_acct(
+	    db_user, db_password, db_hostname, db_name, db_table,s_name,c_name,a_username,elapsed_time,bytes_in,bytes_out);
+    }
+#endif
+
+#if defined(DB_PGSQL)
+    if (!strcmp(db_pref, "pgsql")) {
+        ret = pgsql_db_acct(
+            db_user, db_password, db_hostname, db_name, db_table,s_name,c_name,a_username,elapsed_time,bytes_in,bytes_out);
+    }
+#endif
+
+#if defined(DB_NULL)
+    if (!strcmp(db_pref, "null")) {
+        ret = null_db_acct(
+	    db_user, db_password, db_hostname, db_name, db_table,s_name,c_name,a_username,elapsed_time,bytes_in,bytes_out);
+    }
+#endif
+#if defined(DB_GDBM)
+    if (!strcmp(db_pref, "gdbm")) {
+        gdb_db_acct();
+    }
+#endif
+
+    free(buffer); /* Free unused memory */
+    return (ret); /* error */
+
+}
+
+/* For checking DB type */
+int 
+check_db_type(db_type)
+char *db_type;
+{
+char *dbp[]=DEFINED_DB;
+int ret=1,i;
+
+for (i=0; dbp[i] ; i++ ) {
+	if(!strcmp(db_type,dbp[i])) {
+		ret=0;
+		break;
+	}
+}
+return ret;
+}
+#endif /* DB */
diff -uNr tac_plus.F4.0.3.alpha/db.h 081101/db.h
--- tac_plus.F4.0.3.alpha/db.h	Thu Jan  1 02:00:00 1970
+++ 081101/db.h	Thu Nov 29 13:15:44 2001
@@ -0,0 +1,23 @@
+/* 
+		This is Database Functions header file 
+*/
+
+#if defined(DB)
+
+/* The databases  recognized by this definition */
+#define DEFINED_DB {"null","mysql","pgsql"}
+
+#define SQLCMDL 1024
+
+#if defined(DB_MYSQL)
+#define MYAUTHSQL "SELECT %s FROM %s WHERE %s=\"%s\""
+#define MYACCTSQL "INSERT INTO %s (usern,s_name,c_name,elapsed_time,bytes_in,bytes_out,fin_t) VALUES (\"%s\",\"%s\",\"%s\",%s,%s,%s,NOW())"
+#endif /* DB_MYSQL */
+
+#if defined(DB_PGSQL)
+#define PWLEN   13
+#define PGAUTHSQL "SELECT %s FROM %s WHERE %s='%s'"
+#define PGACCTSQL "INSERT INTO %s (usern,s_name,c_name,elapsed_time,bytes_in,bytes_out,fin_t) VALUES ('%s','%s','%s',%s,%s,%s,NOW())"
+#endif /* DB_PGSQL */
+
+#endif /* DB */
diff -uNr tac_plus.F4.0.3.alpha/db_mysql.c 081101/db_mysql.c
--- tac_plus.F4.0.3.alpha/db_mysql.c	Thu Jan  1 02:00:00 1970
+++ 081101/db_mysql.c	Wed Oct 31 14:50:28 2001
@@ -0,0 +1,233 @@
+#if defined(DB_MYSQL) && defined(DB)
+/*
+
+		Writen by Devrim SERAL(devrim@gazi.edu.tr)
+     This program writen for MySQL Authentication and Accounting Propose
+
+License: This code is free software; you can redistribute it and/or modify it
+under the terms of the GNU General Public License as published by the Free
+Software Foundation; either version 2, or (at your option) any later version.
+
+*/
+
+#include "tac_plus.h"
+#include <stdio.h>
+#include <mysql.h>
+#include "db.h"
+
+MYSQL *mysqldb;
+MYSQL_RES *res;
+MYSQL_ROW row;
+MYSQL_FIELD *table_field;
+
+/* 		This MySQL Authentication Function		*/
+
+int mysql_db_verify(user, users_passwd, db_user, db_password,
+	db_hostname,db_name, db_table, dbfield_name, dbfield_passwd)
+
+
+char *user, *users_passwd;      /* Username and gived password   */
+char *db_user;                  /* db's parameters               */
+char *db_password;
+char *db_hostname;
+char *db_name;
+char *db_table;
+char *dbfield_name;
+char *dbfield_passwd;
+
+{
+
+char *real_passwd;
+char *mysqlcmd;
+int sql_len;
+
+   if (debug & DEBUG_AUTHEN_FLAG)
+	report(LOG_DEBUG, "MySQL: verify %s", user);
+	
+/* Connect database server */
+
+   if ( !( mysql_connect(mysqldb,db_hostname,db_user,db_password) ) )
+	{
+   	        if (debug & DEBUG_AUTHEN_FLAG)
+		    report(LOG_DEBUG, "MySQL: cannot connect as %s", db_user);
+		return(0);
+	}
+
+/*Select tacacs db */
+
+    if ( mysql_select_db(mysqldb,db_name) )
+	{
+   		if (debug & DEBUG_AUTHEN_FLAG)
+		   report(LOG_DEBUG, "MySQL: cannot find database named %s",db_name);
+        	return(0);
+	}
+
+/* Check select string length */
+
+sql_len=strlen(dbfield_passwd)+strlen(dbfield_name)+
+	strlen(db_table)+strlen(user)+strlen(MYAUTHSQL);
+
+  if ( sql_len>= SQLCMDL )
+        {
+        	if (debug & DEBUG_AUTHEN_FLAG)
+		     report(LOG_DEBUG, "MySQL: Sql cmd exceed alowed limits");
+        	return(0);
+        }
+
+/* Prepare select string */
+
+if ((mysqlcmd=(char *) malloc(sql_len)) == NULL ) {
+	if (debug & DEBUG_AUTHEN_FLAG)
+		report(LOG_ERR, "mysql_db_verify: mysqlcmd malloc error");
+	return(0);
+}
+
+sprintf(mysqlcmd,MYAUTHSQL,dbfield_passwd,db_table,dbfield_name,user);
+
+/*  Query database */
+
+    if (mysql_query(mysqldb,mysqlcmd))
+	{
+	if (debug & DEBUG_AUTHEN_FLAG)
+		report(LOG_DEBUG, "MySQL: cannot query database ");
+    	free(mysqlcmd);
+        return(0);
+	}
+
+    free(mysqlcmd);
+    
+    if (!(res = mysql_store_result(mysqldb)))
+	{
+	if (debug & DEBUG_AUTHEN_FLAG)
+  		report(LOG_DEBUG, "MySQL: cannot store result");
+        return(0);
+	}  
+   
+   if(!(row = mysql_fetch_row(res)))
+	{
+	if (debug & DEBUG_AUTHEN_FLAG)
+        	report(LOG_DEBUG, "MySQL: cannot fetch row");
+        return(0);
+        }  
+  
+   if(strlen(row[0]) <= 0 )
+        {
+	if (debug & DEBUG_AUTHEN_FLAG)
+        	report(LOG_DEBUG, "MySQL: DB passwd entry is NULL");
+        return(0);
+        }
+   /* Allocate memory for real_passwd */
+   if ((real_passwd=(char *) malloc(strlen(row[0])+1)) == NULL ) {
+   
+        if (debug & DEBUG_AUTHEN_FLAG)
+                report(LOG_ERR, "mysql_db_verify: real_passwd malloc error");
+        return(0);
+   }
+
+	strcpy(real_passwd,row[0]);
+ 
+   if (!mysql_eof(res))
+	{
+	if (debug & DEBUG_AUTHEN_FLAG)
+        	report(LOG_DEBUG, "MySQL:  Result not end!!");
+        return(0);
+        }
+
+    mysql_free_result(res);
+    mysql_close(mysqldb);
+  
+if (debug & DEBUG_AUTHEN_FLAG)   
+     report(LOG_DEBUG, "MySQL: verify password '%s' to DES encrypted string '%s'", users_passwd, real_passwd);
+
+    /* Try to verify the password */
+    if (!des_verify(users_passwd, real_passwd)) {
+        free(real_passwd);
+	return (0);
+    }
+    free(real_passwd);
+    return (1); /* Return 1 if verified, 0 otherwise. */
+} 
+/* end of MySQL authentication */
+
+/* 		This MySQL Accounting Function			*/
+
+int 
+mysql_db_acct(db_user,db_password,db_hostname,db_name,
+	      db_table,s_name,c_name,a_username,
+	      elapsed_time,bytes_in,bytes_out)
+
+char *db_user;			/* db's parameters		*/
+char *db_password;
+char *db_hostname;
+char *db_name;
+char *db_table;
+char *s_name, *c_name,*a_username,*elapsed_time,*bytes_in,*bytes_out;
+
+{
+
+char *mysqlcmd;
+int sql_len;
+	
+/* Connect database server */
+
+   if (!(mysql_connect(mysqldb,db_hostname,db_user,db_password)))
+	{
+	if (debug & DEBUG_ACCT_FLAG)
+		report(LOG_DEBUG, "MySQL: cannot connect as %s", db_user);
+		return(0);
+	}
+
+/*Select tacacs db */
+
+    if (mysql_select_db(mysqldb,db_name))
+	{
+	if (debug & DEBUG_ACCT_FLAG)
+	   report(LOG_DEBUG, "MySQL: cannot find database named %s",db_name);
+           return(0);
+	}
+
+/* Check buffer overflow for select string */
+sql_len=strlen(db_table)+strlen(a_username)+
+	strlen(s_name)+strlen(c_name)+strlen(elapsed_time)+
+	strlen(bytes_in)+strlen(bytes_out)+strlen(MYACCTSQL);  
+
+if ( sql_len >= SQLCMDL )
+        {
+        if (debug & DEBUG_ACCT_FLAG)
+		report(LOG_DEBUG, "MySQL: Sql cmd exceed alowed limits");
+        	return(0);
+        }
+ 
+
+/* Prepare select string */
+if ((mysqlcmd = (char *) malloc(sql_len)) == NULL ) {
+	if (debug & DEBUG_ACCT_FLAG)
+		report(LOG_ERR, "mysql_db_acct: mysqlcmd malloc error");
+	return(0);
+}
+
+sprintf(mysqlcmd,MYACCTSQL,db_table,a_username,s_name,c_name,elapsed_time,bytes_in,bytes_out);
+
+/*  Query database */
+
+    if (mysql_query(mysqldb,mysqlcmd))
+	{
+	if (debug & DEBUG_ACCT_FLAG)
+		report(LOG_DEBUG, "MySQL: cannot query database");
+	free(mysqlcmd);
+	return(0);
+        }
+
+	free(mysqlcmd);
+
+/* Check if accounting is sucess */
+    if ( mysql_affected_rows( mysqldb ) < 0 )
+	{
+	if (debug & DEBUG_ACCT_FLAG)
+		report(LOG_DEBUG, "MySQL: Insert isn't sucess");
+        return(0);
+        }
+	return (1); /* Return 1 if verified, 0 otherwise. */
+}
+/* end of MySQL accounting */
+#endif
diff -uNr tac_plus.F4.0.3.alpha/db_null.c 081101/db_null.c
--- tac_plus.F4.0.3.alpha/db_null.c	Thu Jan  1 02:00:00 1970
+++ 081101/db_null.c	Wed Oct 31 14:50:28 2001
@@ -0,0 +1,56 @@
+/*
+**  Simple NULL driver for database interface. I created this for testing
+**  db_* on my notebook by home. There i dont have Oracle or any database
+**  server.                                               Fil/27-nov-1998
+**
+**  DO_NOT_USE_THIS_FOR_WORK!
+*/
+
+#if defined(DB_NULL) && defined(DB)
+#include "tac_plus.h"
+
+int null_db_verify(user, users_passwd, db_user, db_password, db_hostname,
+	    db_table, dbfield_name, dbfield_passwd)
+	    
+char *user, *users_passwd;      /* Username and gived password   */
+char *db_user;			/* db's parametr's		 */
+char *db_password;
+char *db_hostname;
+char *db_table;
+char *dbfield_name;
+char *dbfield_passwd;
+
+{
+//report(LOG_DEBUG, "DB_NULL(%u) - ok", __LINE__);
+
+    /* Try to verify the password
+       Successful if username and password equal */
+    if (strcmp(user, users_passwd)) {
+	return (0);
+    }
+    if (debug & DEBUG_PASSWD_FLAG)
+       	report(LOG_DEBUG, "DB Null: verify password '%s'", users_passwd);
+
+    return (1); /* Return 1 if verified, 0 otherwise. */
+}
+
+/*	Null Database Accounting	*/
+
+int 
+null_db_acct(db_user, db_password, db_hostname,db_name,db_table,s_name,c_name,a_username,elapsed_time,bytes_in,bytes_out)
+char *db_user;			/* db's parametr's		 */
+char *db_password;
+char *db_hostname;
+char *db_name;
+char *db_table;
+char *s_name;
+char *c_name;
+char *a_username;
+char *elapsed_time;char *bytes_in;char *bytes_out;
+{
+report(LOG_INFO,"Db accounting user=%s pass=%s host=%s db_name=%s table=%s servern=%s clientn=%s username=%s et=%s bi=%s bo=%s",db_user,db_password,db_hostname,
+db_name,db_table,s_name,c_name,a_username,elapsed_time,bytes_in,bytes_out);
+return (1);
+}
+#endif
+
diff -uNr tac_plus.F4.0.3.alpha/db_pgsql.c 081101/db_pgsql.c
--- tac_plus.F4.0.3.alpha/db_pgsql.c	Thu Jan  1 02:00:00 1970
+++ 081101/db_pgsql.c	Wed Oct 31 14:50:28 2001
@@ -0,0 +1,215 @@
+#if defined(DB_PGSQL) && defined(DB)
+
+/*
+		Writen by Devrim SERAL(devrim@gazi.edu.tr)
+	For PostgreSQL Authentication And Accounting Propose
+			      28-01-2001
+
+License: This code is free software; you can redistribute it and/or modify it
+under the terms of the GNU General Public License as published by the Free
+Software Foundation; either version 2, or (at your option) any later version.
+
+*/
+
+#include "tac_plus.h"
+#include <stdio.h>
+#include <libpq-fe.h> 
+#include "db.h" 
+
+PGconn     *conn;
+PGresult   *res;
+
+/* Clear PgSQL file descriptor and close connection */
+
+int
+exit_nicely(PGconn *cn,PGresult *r)
+{
+    PQclear(r);
+    PQfinish(cn);
+}
+
+/* 		PgSQL Authentication function 			*/
+
+int 
+pgsql_db_verify(user, users_passwd, db_user, db_password,
+	db_hostname,db_name, db_table, dbfield_name, dbfield_passwd)
+
+
+char *user, *users_passwd;      /* Username and gived password   */
+char *db_user;                  /* db's parameters               */
+char *db_password;
+char *db_hostname;
+char *db_name;
+char *db_table;
+char *dbfield_name;
+char *dbfield_passwd;
+
+{
+
+char *real_passwd;
+char *pgsqlcmd;
+int sql_len;
+int nrow;
+
+if (debug & DEBUG_AUTHEN_FLAG)
+        report(LOG_DEBUG, "PGSQL: verify %s", user);
+	
+/* Connect database server */
+
+conn=PQsetdbLogin(db_hostname,NULL,NULL,NULL,db_name,db_user,db_password);
+
+if ( PQstatus(conn) == CONNECTION_BAD ) 
+{
+    if (debug & DEBUG_AUTHEN_FLAG)
+	report(LOG_DEBUG, "PGSQL: Connection to database %s failed", db_name);
+	return(0);
+}
+
+/* Check select string length */
+
+sql_len=strlen(dbfield_passwd)+strlen(dbfield_name)+strlen(db_table)+strlen(user)+strlen(PGAUTHSQL);
+
+if ( sql_len> SQLCMDL ) {
+    if (debug & DEBUG_AUTHEN_FLAG)
+       	report(LOG_DEBUG, "PGSQL: Sql cmd exceed alowed limits");
+       	return(0);
+}
+
+/* Prepare select string */
+
+if ((pgsqlcmd=(char *) malloc(sql_len)) == NULL ) {
+    if (debug & DEBUG_AUTHEN_FLAG)
+	report(LOG_ERR, "pgsql_db_verify: pgsqlcmd malloc error");
+	return(0);
+}
+
+sprintf(pgsqlcmd,PGAUTHSQL,dbfield_passwd,db_table,dbfield_name,user);
+
+/*  Query database */
+res=PQexec(conn,pgsqlcmd);
+
+if (!res || PQresultStatus(res) != PGRES_TUPLES_OK) {
+   if (debug & DEBUG_AUTHEN_FLAG) {
+	report(LOG_DEBUG, "PGSQL: cannot query database ");
+	report(LOG_DEBUG, "PGSQL: Error message->%s", PQerrorMessage(conn) );
+   }
+  	free(pgsqlcmd);
+        exit_nicely(conn,res);
+	return(0);
+}
+
+free(pgsqlcmd);
+
+if( nrow=PQntuples(res)!=1) {  
+    if (debug & DEBUG_AUTHEN_FLAG)
+        report(LOG_DEBUG, "PGSQL: Have we got more than one password!!");
+        exit_nicely(conn,res);
+	return(0);
+}  
+  
+if ( PQgetisnull(res,0,PQfnumber(res,dbfield_passwd)) ) {
+    if (debug & DEBUG_AUTHEN_FLAG)
+        report(LOG_DEBUG, "PGSQL: DB passwd entry is NULL");
+        exit_nicely(conn,res);
+	return(0);
+}
+
+  /* Allocate memory for real_passwd */
+    real_passwd=(char *) malloc(PWLEN+1);
+    strncpy(real_passwd,PQgetvalue(res,0,PQfnumber(res,dbfield_passwd)),PWLEN);
+    real_passwd[PWLEN]='\0';
+ 
+exit_nicely(conn,res);
+  
+if (debug & DEBUG_AUTHEN_FLAG)
+    report(LOG_DEBUG, "PGSQL: verify password '%s' to DES encrypted string '%s'", users_passwd, real_passwd);
+ 
+	/* Try to verify the password */
+	if (!des_verify(users_passwd, real_passwd)) {
+        return (0);
+	}
+
+    return (1); /* Return 1 if verified, 0 otherwise. */
+}
+
+/*			PGSQL ACCOUNTING function 		*/ 
+
+int pgsql_db_acct(db_user,db_password,db_hostname,db_name,
+		  db_table,s_name,c_name,a_username,elapsed_time,
+		  bytes_in,bytes_out)
+
+char *db_user;                  /* db's parameters              */
+char *db_password;
+char *db_hostname;
+char *db_name;
+char *db_table;
+char *s_name, *c_name,*a_username,*elapsed_time,*bytes_in,*bytes_out;
+
+{
+
+char *pgsqlcmd;
+int sql_len;
+
+  if (debug & DEBUG_ACCT_FLAG)
+	report(LOG_DEBUG, "PGSQL: Accounting for %s begin", a_username);
+	
+/* Connect database server */
+
+conn=PQsetdbLogin(db_hostname,NULL,NULL,NULL,db_name,db_user,db_password);
+
+if ( PQstatus(conn) == CONNECTION_BAD ) {
+   if (debug & DEBUG_ACCT_FLAG) {
+	report(LOG_DEBUG, "PGSQL: Connection to database %s failed", db_name);
+	report(LOG_DEBUG, "PGSQL: Error message->%s", PQerrorMessage(conn) );
+   }
+	return(0);
+}
+
+/* Check select string length */
+
+sql_len=strlen(db_table)+strlen(a_username)+
+	strlen(s_name)+strlen(c_name)+strlen(elapsed_time)+
+	strlen(bytes_in)+strlen(bytes_out)+strlen(PGACCTSQL); 
+
+if ( sql_len> SQLCMDL ) {
+   if (debug & DEBUG_ACCT_FLAG) 
+       	report(LOG_DEBUG, "PGSQL: Sql cmd exceed alowed limits");
+   return(0);
+}
+
+/* Prepare select string */
+
+if ((pgsqlcmd=(char *) malloc(sql_len)) == NULL ) {
+   if (debug & DEBUG_ACCT_FLAG) 
+	report(LOG_ERR, "pgsql_db_verify: pgsqlcmd malloc error");
+   return(0);
+}
+
+sprintf(pgsqlcmd,PGACCTSQL,db_table,a_username,s_name,c_name,elapsed_time,bytes_in,bytes_out);
+ 
+/*  Query database */
+res=PQexec(conn,pgsqlcmd);
+
+if (!res || PQresultStatus(res) != PGRES_COMMAND_OK )
+{
+ if (debug & DEBUG_ACCT_FLAG) { 
+	report(LOG_DEBUG, "PGSQL: cannot establish database query");
+	report(LOG_DEBUG, "PGSQL: Error message->%s", PQerrorMessage(conn) );
+}
+    	free(pgsqlcmd);
+        exit_nicely(conn,res);
+	return(0);
+}
+
+free(pgsqlcmd);
+    
+/* Flush all result and close connection */
+exit_nicely(conn,res);
+
+    if (debug & DEBUG_ACCT_FLAG)
+	report(LOG_DEBUG, "PGSQL: Accounting for %s finished", a_username);
+  
+    return (1); /* Return 1 if verified, 0 otherwise. */
+}
+
+#endif
diff -uNr tac_plus.F4.0.3.alpha/default_v0_fn.c 081101/default_v0_fn.c
--- tac_plus.F4.0.3.alpha/default_v0_fn.c	Sat Apr  3 09:03:47 1999
+++ 081101/default_v0_fn.c	Wed Oct 31 14:50:28 2001
@@ -87,6 +87,7 @@
 	    /* No username. Try requesting one */
 	    data->status = TAC_PLUS_AUTHEN_STATUS_GETUSER;
 	    if (data->service == TAC_PLUS_AUTHEN_SVC_LOGIN) {
+		if ( !(prompt=(char *)cfg_get_host_prompt(data->NAS_id->NAS_name)) )
 		prompt = "\nUser Access Verification\n\nUsername: ";
 	    } else {
 		prompt = "Username: ";
diff -uNr tac_plus.F4.0.3.alpha/do_acct.c 081101/do_acct.c
--- tac_plus.F4.0.3.alpha/do_acct.c	Sat Apr  3 09:03:45 1999
+++ 081101/do_acct.c	Thu Nov 29 13:20:47 2001
@@ -63,19 +63,20 @@
 {
     int i, errors;
     time_t t = time(NULL);
-    char *ct = ctime(&t);
+    char *ct = (char *) ctime(&t);
 
     ct[24] = '\0';
 
     if (!acctfd) {
-	acctfd = open(session.acctfile, O_CREAT | O_WRONLY | O_APPEND, 0666);
+	acctfd = open(session.acctfile, O_CREAT | O_WRONLY | O_APPEND,0640);
 	if (acctfd < 0) {
 	    report(LOG_ERR, "Can't open acct file %s -- %s",
 		   session.acctfile, sys_errlist[errno]);
 	    return(1);
 	}
     }
-    if (!tac_lockfd(session.acctfile, acctfd)) {
+ 
+   if (!tac_lockfd(session.acctfile, acctfd)) {
 	rec->admin_msg = tac_strdup("Cannot lock log file");
 	report(LOG_ERR, "%s: Cannot lock %s", 
 	       session.peer, session.acctfile);
@@ -158,7 +159,11 @@
 #endif
     entry.ut_time = utime;
 
-    wtmpfd = open(wtmpfile, O_CREAT | O_WRONLY | O_APPEND | O_SYNC, 0666);	
+#ifndef FREEBSD
+    wtmpfd = open(wtmpfile, O_CREAT | O_WRONLY | O_APPEND | O_SYNC, 0644);	
+#else
+    wtmpfd = open(wtmpfile, O_CREAT | O_WRONLY | O_APPEND | O_FSYNC, 0644);	
+#endif
     if (wtmpfd < 0) {
 	report(LOG_ERR, "Can't open wtmp file %s -- %s",
 	       wtmpfile, sys_errlist[errno]);
@@ -206,7 +211,7 @@
     }
     return(NULL);
 }
-
+
 int
 do_wtmp(rec)
     struct acct_rec *rec;
diff -uNr tac_plus.F4.0.3.alpha/do_author.c 081101/do_author.c
--- tac_plus.F4.0.3.alpha/do_author.c	Sat Apr  3 09:03:46 1999
+++ 081101/do_author.c	Wed Oct 31 14:50:28 2001
@@ -36,7 +36,9 @@
     int status;
     int svc;
     char *cmd, *protocol, *svcname;
-    
+#ifdef USE_PAM
+    char *pam_service= NULL;
+#endif
     protocol = NULL;
 
     data->status = AUTHOR_STATUS_FAIL;	/* for safety */
@@ -122,6 +124,27 @@
     }
 #endif /* MAXSESS */
 
+#ifdef USE_PAM
+	/* Check  PAM Authorization */
+     switch (svc) {
+    case N_svc_ppp:
+    case N_svc_exec:
+if (pam_service=cfg_get_pam_service(data->id->username,TAC_PLUS_RECURSE) ) {
+
+	if (debug & DEBUG_AUTHOR_FLAG)
+		report(LOG_DEBUG, "PAM Authorization begin for user %s",data->id->username);
+	if(tac_pam_authorization(data->id->username,data,pam_service))
+	{
+ 		if (debug & DEBUG_AUTHOR_FLAG)
+        		report(LOG_DEBUG, "PAM Authorization Fail");
+		return(0);
+	}
+} /* Pam_service */
+    default:
+	break;
+    }
+#endif 
+
     switch(svc) {
     default:
 	report(LOG_ERR, "%s: Bad service type %d", session.peer, svc);
@@ -868,10 +891,11 @@
 		    report(LOG_DEBUG, "nas:%s svr:absent, default=deny -> denied (c)",
 			   nas_arg);
 		}
-		if (out_args)
+		if (out_args) {
 		    for (i = 0; i < data->num_out_args; i++)
 			free(out_args[i]);
-		free(out_args);
+		    free(out_args);
+		}
 		
 		data->num_out_args = 0;
 		data->output_args = NULL;
diff -uNr tac_plus.F4.0.3.alpha/enable.c 081101/enable.c
--- tac_plus.F4.0.3.alpha/enable.c	Sat Apr  3 09:03:46 1999
+++ 081101/enable.c	Wed Oct 31 14:50:28 2001
@@ -30,6 +30,47 @@
     int state;
 };
 
+int
+enable_host_verify(passwd,data)
+char *passwd;
+struct authen_data *data;
+{
+char *enable,*p;
+if(enable=(char *)cfg_get_host_enable(data->NAS_id->NAS_name)) {
+   p = tac_find_substring("cleartext ", enable);
+   if (p) {	
+        if (strcmp(passwd, p)) {
+            if (debug & DEBUG_PASSWD_FLAG)
+                report(LOG_DEBUG, "Enable cleartext password is incorrect");
+            data->status = TAC_PLUS_AUTHEN_STATUS_FAIL;
+        } else {
+            data->status = TAC_PLUS_AUTHEN_STATUS_PASS;
+
+            if (debug & DEBUG_PASSWD_FLAG)
+                report(LOG_DEBUG, "Enable cleartext password is correct");
+	    return(1);
+        }
+   }
+   p = tac_find_substring("des ", enable);
+   if (p) {	
+        if (!des_verify(passwd, p)) {
+            if (debug & DEBUG_PASSWD_FLAG)
+                report(LOG_DEBUG, "Enable des password is incorrect");
+            data->status = TAC_PLUS_AUTHEN_STATUS_FAIL;
+        } else {
+            data->status = TAC_PLUS_AUTHEN_STATUS_PASS;
+
+            if (debug & DEBUG_PASSWD_FLAG)
+                report(LOG_DEBUG, "Enable des password is correct");
+	    return(1);
+        }
+    }
+} 
+return(0);
+
+}
+
+
 static void
 enable(passwd, data)
 char *passwd;
@@ -56,6 +97,12 @@
 
     /* 2). level=15. Try $enab15$ or $enable$ (for backwards
        compatibility) and verify */
+    
+    /* But firstly check wether if we have host enable password */
+    
+    if(enable_host_verify(passwd,data)) {
+    	return;
+    }
 
     if (verify("$enable$", passwd, data, TAC_PLUS_NORECURSE) ||
 	verify("$enab15$", passwd, data, TAC_PLUS_NORECURSE)) {
diff -uNr tac_plus.F4.0.3.alpha/generate_passwd.c 081101/generate_passwd.c
--- tac_plus.F4.0.3.alpha/generate_passwd.c	Sat Apr  3 09:03:47 1999
+++ 081101/generate_passwd.c	Thu Nov  8 12:29:05 2001
@@ -22,9 +22,16 @@
    You can optionally supply a salt to verify a password.
    Usage: a.out [salt]
 */
+#include <stdlib.h>
+#include <stdio.h>
+#include <time.h>
+#include <unistd.h>
 
+#ifndef NULL
 #define NULL 0
+#endif
 
+int
 main(argc, argv)
 char **argv;
 {
@@ -42,7 +49,7 @@
 
     write(1, prompt, strlen(prompt));
     n = read(0, pass, sizeof(pass));
-    pass[n-1] = NULL;
+    pass[n-1] = '\0';
 
     if (!salt) {
 	int i, r, r1, r2;
diff -uNr tac_plus.F4.0.3.alpha/install-sh 081101/install-sh
--- tac_plus.F4.0.3.alpha/install-sh	Thu Jan  1 02:00:00 1970
+++ 081101/install-sh	Wed Oct 31 14:50:28 2001
@@ -0,0 +1 @@
+#!/bin/sh
diff -uNr tac_plus.F4.0.3.alpha/ldap.c 081101/ldap.c
--- tac_plus.F4.0.3.alpha/ldap.c	Thu Jan  1 02:00:00 1970
+++ 081101/ldap.c	Wed Oct 31 14:50:28 2001
@@ -0,0 +1,119 @@
+/*
+     Verify that this user/password is valid per a database LDAP server
+     Return 1 if verified, 0 otherwise.
+     
+     Format of connection string (look like internet URL):
+
+       ldap://LDAP-hostname
+     
+     -------------------------------------------------------
+     patrick.harpes@tudor.lu            http://www.santel.lu
+                                        http://www.tudor.lu
+     
+
+
+     Dependencies: You need to get the OpenLDAP libraries
+                   from http://www.openldap.org
+ 
+      License: tac_ldap is free software; you can redistribute it
+               and/or modify it under the terms of the GNU General Public License
+               as published by the Free Software Foundation; either version 2,
+               or (at your option) any later version.
+--------------------------------------------------------------------------
+				Changes:
+ Ok i am back again..:)
+ I changed lot of thing.. First off all i add port feature to ldap string.
+ And also add more check for buffer overflows.
+
+Connect format would be:
+       ldap://LDAP-hostname:100
+
+Port name isn't required.. I would like to change format with : 
+       ldap://LDAP-hostname:100/dn_for_user&dn_for_passwd
+
+ devrim seral <devrim@gazi.edu.tr> 
+
+*/ 
+
+
+#if defined(USE_LDAP)
+#include <stdio.h>
+#include <string.h>
+#include <lber.h>
+#include <ldap.h>
+#include <ldap_cdefs.h>
+
+#include "tac_plus.h"
+#include "ldap.h"
+
+
+int
+ldap_verify(user, users_passwd, str_conn)
+char *user, *users_passwd;      /* Username and gived password   */
+char *str_conn;                 /* String connection to database */
+{
+  char *buf;
+  char *ldapServer;
+  char *ldap_port;
+  LDAP *ld;
+  int port;
+  int err;
+
+/* Don't allow null username and passwd */ 
+  if ( *user == '0' || *users_passwd == '0' ) return (1);
+
+  buf=(char *)malloc(strlen(str_conn)+1);
+  if (buf == NULL ){ 
+	report(LOG_DEBUG, "Error can't allocate memory");
+        return(1);
+  }
+  
+  strcpy(buf,str_conn);
+  ldapServer=strstr(buf, "://");
+  
+  if(ldapServer == NULL && strlen(ldapServer) <4 ) {
+	if (debug) {
+		report(LOG_DEBUG, "Error parse ldap server");
+		return(1);
+	}
+  } 
+  
+ ldapServer=ldapServer+3;
+
+ ldap_port=(char *)strstr(ldapServer, ":");
+
+ if (ldap_port != NULL ) {
+		*ldap_port='\0';
+		port=atoi(++ldap_port);
+ } else {
+	port = LDAP_PORT;
+ }
+ 
+ if ( debug & DEBUG_AUTHEN_FLAG ) 
+  report(LOG_DEBUG, "In verify_ldap : Before ldap_init : ldapserver = %s port= %d", ldapServer, port);
+
+
+  if( (ld = ldap_init(ldapServer, port)) == NULL)
+    {
+      report(LOG_DEBUG, "Unable to connect to LDAP server:%s port:%d",ldapServer, port);
+      return 1;
+    }
+  
+  err=ldap_simple_bind_s(ld, user, users_passwd);
+  
+  if(err != LDAP_SUCCESS)
+    {
+      if ( debug & DEBUG_AUTHEN_FLAG ) 
+      	report(LOG_DEBUG,"Error while bind : %d %s",err, ldap_err2string(err) );
+      return 1;
+    }         
+  else
+    {
+      /* Success */
+     if ( debug & DEBUG_AUTHEN_FLAG ) 
+     		report(LOG_DEBUG, "LDAP authentication Sucess ");
+     ldap_unbind_s(ld); 
+     return 0;
+    }
+}
+#endif /* LDAP */
diff -uNr tac_plus.F4.0.3.alpha/ldap.h 081101/ldap.h
--- tac_plus.F4.0.3.alpha/ldap.h	Thu Jan  1 02:00:00 1970
+++ 081101/ldap.h	Wed Oct 31 14:50:28 2001
@@ -0,0 +1 @@
+int ldap_verify();
diff -uNr tac_plus.F4.0.3.alpha/maxsess.c 081101/maxsess.c
--- tac_plus.F4.0.3.alpha/maxsess.c	Sat Apr  3 09:03:47 1999
+++ 081101/maxsess.c	Wed Oct 31 14:50:28 2001
@@ -323,6 +323,8 @@
     /* NOTREACHED */
 }
 
+#ifdef ENABLE_FINGER
+
 /*
  * Contact a NAS (using finger) to check how many sessions this USER
  * is currently running on it.
@@ -564,6 +566,7 @@
 
     return (nsess);
 }
+#endif /* ENABLE_FINGER */
 
 /*
  * Estimate how many sessions a named user currently owns by looking in
@@ -652,11 +655,14 @@
 	       "user %s is running %d out of a maximum of %d sessions",
 	       user, sess, maxsess);
     }
+#ifdef ENABLE_FINGER
     if ((sess >= maxsess) && is_async(id->NAS_port)) {
 	/* If we have finger available, double check this count by contacting
 	 * the NAS */
 	sess = countusers_by_finger(id);
     }
+#endif
+
     /* If it's really too high, don't authorize more services */
     if (sess >= maxsess) {
 	char buf[80];
diff -uNr tac_plus.F4.0.3.alpha/packet.c 081101/packet.c
--- tac_plus.F4.0.3.alpha/packet.c	Sat Apr  3 09:03:46 1999
+++ 081101/packet.c	Wed Oct 31 14:50:28 2001
@@ -425,6 +425,7 @@
     HDR hdr;
     u_char *pkt, *data;
     int len;
+    char *tkey;
 
     if (debug & DEBUG_PACKET_FLAG)
 	report(LOG_DEBUG, "Waiting for packet");
@@ -446,6 +447,13 @@
 
     /* get memory for the packet */
     len = TAC_PLUS_HDR_SIZE + ntohl(hdr.datalength);
+    if ((ntohl(hdr.datalength) & ~0xffffUL) ||
+       len < TAC_PLUS_HDR_SIZE || len > 0x10000) {
+       report(LOG_ERR,
+              "%s: Illegal data size: %lu\n",
+              session.peer, ntohl(hdr.datalength));
+       return(NULL);
+    }
     pkt = (u_char *) tac_malloc(len);
 
     /* initialise the packet */
@@ -472,7 +480,10 @@
     }
 
     /* decrypt the data portion */
-    if (md5_xor((HDR *)pkt, data, session.key)) {
+    if ( !(tkey=(char *)cfg_get_host_key(session.peer)) )
+		tkey = session.key;     
+
+    if (md5_xor((HDR *)pkt, data, tkey)) {
 	report(LOG_ERR, "%s: start_session error decrypting data",
 	       session.peer);
 	return (NULL);
@@ -494,6 +505,7 @@
     HDR *hdr = (HDR *) pak;
     u_char *data;
     int len;
+    char *tkey;
 
     len = TAC_PLUS_HDR_SIZE + ntohl(hdr->datalength);
 
@@ -501,7 +513,10 @@
     data = pak + TAC_PLUS_HDR_SIZE;
 
     /* encrypt the data portion */
-    if (md5_xor((HDR *)pak, data, session.key)) {
+   if ( !(tkey=(char *)cfg_get_host_key(session.peer)) )
+                tkey = session.key;
+
+   if (md5_xor((HDR *)pak, data, tkey)) {
 	report(LOG_ERR, "%s: write_packet: error encrypting data", session.peer);
 	return (-1);
     }
diff -uNr tac_plus.F4.0.3.alpha/parse.c 081101/parse.c
--- tac_plus.F4.0.3.alpha/parse.c	Sat Apr  3 09:03:46 1999
+++ 081101/parse.c	Wed Oct 31 14:50:28 2001
@@ -71,6 +71,9 @@
     declare("ms-chap", S_mschap);
 #endif /* MSCHAP */
     declare("cleartext", S_cleartext);
+#ifdef USE_PAM
+    declare("pam", S_pam);
+#endif /*USE_PAM */
     declare("nopassword", S_nopasswd);
     declare("cmd", S_cmd);
     declare("default", S_default);
@@ -82,6 +85,7 @@
     declare("group", S_group);
     declare("global", S_global);
     declare("host", S_host);
+    declare("type", S_type);
     declare("ip", S_ip);
     declare("ipx", S_ipx);
     declare("key", S_key);
@@ -89,6 +93,13 @@
 #ifdef MAXSESS
     declare("maxsess", S_maxsess);
 #endif
+#ifdef DB
+    declare("db", S_db);
+    declare("db_accounting",S_db_accounting);
+#endif
+#ifdef USE_LDAP
+    declare ("ldap", S_ldap);
+#endif
     declare("member", S_member);
     declare("message", S_message);
     declare("name", S_name);
@@ -103,6 +114,9 @@
     declare("slip", S_slip);
     declare("service", S_svc);
     declare("user", S_user);
+    declare("time", S_time);
+    declare("prompt",S_prompt);
+    declare("enable",S_enable);
 }
 
 /* Return a keyword code if a keyword is recognized. 0 otherwise */
@@ -144,6 +158,8 @@
 	return ("group");
     case S_host:
 	return ("host");
+    case S_type:
+	return ("type");
     case S_file:
 	return ("file");
     case S_skey:
@@ -158,7 +174,13 @@
     case S_maxsess:
 	return ("maxsess");
 #endif
-    case S_expires:
+#ifdef DB
+    case S_db:
+        return ("db");
+    case S_db_accounting:
+	return ("db_accounting");
+#endif
+   case S_expires:
 	return ("expires");
     case S_after:
 	return ("after");
@@ -182,6 +204,10 @@
 	return ("opap");
     case S_cleartext:
 	return ("cleartext");
+#ifdef USE_PAM
+    case S_pam:
+	return ("pam");
+#endif /*USE_PAM */	
     case S_nopasswd:
 	return("nopassword");
     case S_des:
@@ -224,5 +250,11 @@
 	return ("accounting");
     case S_lcp:
 	return("lcp");
+    case S_time:
+	return("time");
+    case S_prompt:
+        return("prompt");
+    case S_enable:
+        return("enable");
     }
 }
diff -uNr tac_plus.F4.0.3.alpha/parse.h 081101/parse.h
--- tac_plus.F4.0.3.alpha/parse.h	Sat Apr  3 09:03:47 1999
+++ 081101/parse.h	Wed Oct 31 14:50:28 2001
@@ -75,3 +75,17 @@
 #ifdef MSCHAP
 #define S_mschap          42
 #endif /* MSCHAP */
+#ifdef USE_PAM
+#define S_pam		  43
+#endif	 /*USE_PAM */
+#ifdef DB
+#define S_db		  44
+#define S_db_accounting	  45
+#endif  /*DB*/
+#define S_type		  46
+#ifdef USE_LDAP
+#define S_ldap            47
+#endif /* LDAP */
+#define S_time		  48
+#define S_prompt          49
+#define S_enable          50
diff -uNr tac_plus.F4.0.3.alpha/pwlib.c 081101/pwlib.c
--- tac_plus.F4.0.3.alpha/pwlib.c	Sat Apr  3 09:03:47 1999
+++ 081101/pwlib.c	Wed Oct 31 14:50:28 2001
@@ -19,11 +19,27 @@
 
 #include "tac_plus.h"
 #include "expire.h"
+#include "time_limit.h"
 
 #ifdef SHADOW_PASSWORDS
 #include <shadow.h>
 #endif
 
+#ifdef USE_PAM
+int
+tac_pam_auth(char *UserName,char *Password,struct authen_data *data,char *Service);
+#endif /* USE_PAM   */
+
+/* For database verification */
+#ifdef DB
+int db_verify();
+#endif /* DB */
+
+/* For LDAP verification */
+#ifdef USE_LDAP
+#include "ldap.h"
+#endif /* LDAP */
+
 /* Generic password verification routines for des, file and cleartext
    passwords */
 
@@ -96,8 +112,19 @@
 int recurse;
 {
     char *exp_date;
+    char *timestamp;
     char *cfg_passwd;
     char *p;
+    
+    timestamp = (char *)cfg_get_timestamp(name, recurse); 
+    if ( timestamp != NULL ) { 
+    	if( time_limit_process(timestamp) == 0  ) {
+		if ( debug & DEBUG_AUTHEN_FLAG ) 
+			report(LOG_DEBUG,"Timestamp check failed");	
+		data->status = TAC_PLUS_AUTHEN_STATUS_FAIL;
+	        return (0);
+	} 
+    }
 
     if (data->type == TAC_PLUS_AUTHEN_TYPE_PAP) {
 	cfg_passwd = cfg_get_pap_secret(name, recurse);
@@ -118,18 +145,79 @@
 
     if (!cfg_passwd) {
 	char *file = cfg_get_authen_default();
+	switch (cfg_get_authen_default_method()) {
+	case (S_file):
+
 	if (file) {
 	    return (passwd_file_verify(name, passwd, data, file));
 	}
+        break;
+#ifdef DB
+	case (S_db):
+   /* ugly check for database connect string */
+   if( strstr(file, "://") ){
+	    if (debug & DEBUG_PASSWD_FLAG)
+        	report(LOG_DEBUG,"%s %s: DB access to %s for user %s",session.peer, session.port, file, name);
+        if (!db_verify(name, passwd, file)) {
+            data->status = TAC_PLUS_AUTHEN_STATUS_FAIL;
+            return (0);
+        } else {
+            data->status = TAC_PLUS_AUTHEN_STATUS_PASS;
+        }
+        exp_date = NULL;
+        set_expiration_status(exp_date, data);
+        return (data->status == TAC_PLUS_AUTHEN_STATUS_PASS);
+    }
+	break;
+#endif
+
+#ifdef USE_LDAP
+        case (S_ldap):
+        if (ldap_verify(name, passwd, file)==1) {
+            data->status = TAC_PLUS_AUTHEN_STATUS_FAIL;
+            return (0);
+        } else {
+            data->status = TAC_PLUS_AUTHEN_STATUS_PASS;
+        }
+        exp_date = NULL;
+        set_expiration_status(exp_date, data);
+        return (data->status == TAC_PLUS_AUTHEN_STATUS_PASS);
+        break;
+#endif /* USE_LDAP */
 
+#ifdef USE_PAM
+        case (S_pam):
+	if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "PAM verify daemon %s == NAS %s", p,passwd);
+	if (tac_pam_auth(name, passwd, data,file)) {
+	    if (debug & DEBUG_PASSWD_FLAG)
+		report(LOG_DEBUG, "PAM default authentication fail");
+	    data->status = TAC_PLUS_AUTHEN_STATUS_FAIL;
+	    return(0);
+	} else {
+	    data->status = TAC_PLUS_AUTHEN_STATUS_PASS;
+
+	    if (debug & DEBUG_PASSWD_FLAG)
+		report(LOG_DEBUG, " PAM default authentication pass");
+	}
+
+	exp_date = cfg_get_expires(name, recurse);
+	set_expiration_status(exp_date, data);
+	return (data->status == TAC_PLUS_AUTHEN_STATUS_PASS);
+	break;
+#endif	
+	default:
 	/* otherwise, we fail */
 	data->status = TAC_PLUS_AUTHEN_STATUS_FAIL;
 	return (0);
+
     }
+}
 
     /* We have a configured password. Deal with it depending on its
        type */
 
+
     p = tac_find_substring("cleartext ", cfg_passwd);
     if (p) {
 	if (debug & DEBUG_PASSWD_FLAG)
@@ -152,6 +240,31 @@
 	return (data->status == TAC_PLUS_AUTHEN_STATUS_PASS);
     }
 
+#ifdef USE_PAM
+    p = tac_find_substring("pam ", cfg_passwd);
+    if (p) {
+	if (debug & DEBUG_PASSWD_FLAG)
+	    report(LOG_DEBUG, "PAM verify daemon %s == NAS %s", p,passwd);
+
+	if (tac_pam_auth(name, passwd, data,p)) {
+	    if (debug & DEBUG_PASSWD_FLAG)
+		report(LOG_DEBUG, "PAM Password is incorrect");
+	    data->status = TAC_PLUS_AUTHEN_STATUS_FAIL;
+	    return(0);
+	} else {
+	    data->status = TAC_PLUS_AUTHEN_STATUS_PASS;
+
+	    if (debug & DEBUG_PASSWD_FLAG)
+		report(LOG_DEBUG, "PAM Password is correct");
+	}
+
+	exp_date = cfg_get_expires(name, recurse);
+	set_expiration_status(exp_date, data);
+	return (data->status == TAC_PLUS_AUTHEN_STATUS_PASS);
+    }
+
+#endif /* USE_PAM */
+
     p = tac_find_substring("des ", cfg_passwd);
     if (p) {
 	/* try to verify this des password */
@@ -167,11 +280,37 @@
 	return (data->status == TAC_PLUS_AUTHEN_STATUS_PASS);
     }
 
+#ifdef DB
+    p = tac_find_substring("db ", cfg_passwd);
+    if (p) {
+        /* try to verify this password from database */
+        if (debug & DEBUG_PASSWD_FLAG)
+            report(LOG_DEBUG, "DB verify daemon %s == NAS %s", p, passwd);
+
+	if (!db_verify(name, passwd, p)) {
+            data->status = TAC_PLUS_AUTHEN_STATUS_FAIL;
+
+        if (debug & DEBUG_PASSWD_FLAG)
+                report(LOG_DEBUG, "DB Password is incorrect");
+   
+	 return (0);
+        } else {
+
+	if (debug & DEBUG_PASSWD_FLAG)
+                report(LOG_DEBUG, "DB Password is correct");
+            data->status = TAC_PLUS_AUTHEN_STATUS_PASS;
+        }
+        exp_date = cfg_get_expires(name, recurse);
+        set_expiration_status(exp_date, data);
+        return (data->status == TAC_PLUS_AUTHEN_STATUS_PASS);
+    }
+#endif /* DB */
+
     p = tac_find_substring("file ", cfg_passwd);
     if (p) {
 	return (passwd_file_verify(name, passwd, data, p));
     }
-
+    
     /* Oops. No idea what kind of password this is. This should never
        happen as the parser should never create such passwords. */
 
@@ -282,9 +421,11 @@
 
     data->status = TAC_PLUS_AUTHEN_STATUS_FAIL;
 
-    if (filename && STREQ(filename, "/etc/passwd")) {
+    if (filename && (STREQ(filename, "/etc/passwd")|| STREQ(filename,"/etc/shadow") )) {
 	return(etc_passwd_file_verify(user, supplied_passwd, data));
     }
+ 
+
 
     /* an alternate filename */
     if (!(access(filename, R_OK) == 0)) {
diff -uNr tac_plus.F4.0.3.alpha/report.c 081101/report.c
--- tac_plus.F4.0.3.alpha/report.c	Sat Apr  3 09:03:46 1999
+++ 081101/report.c	Wed Oct 31 14:50:28 2001
@@ -159,7 +159,7 @@
     if (debug) {
 	int logfd;
 
-	logfd = open(logfile, O_CREAT | O_WRONLY | O_APPEND, 0666);
+	logfd = open(logfile, O_CREAT | O_WRONLY | O_APPEND, 0640);
 	if (logfd >= 0) {
 	    char buf[512];
 	    time_t t = time(NULL);
diff -uNr tac_plus.F4.0.3.alpha/stamp-h 081101/stamp-h
--- tac_plus.F4.0.3.alpha/stamp-h	Thu Jan  1 02:00:00 1970
+++ 081101/stamp-h	Thu Nov 29 13:17:08 2001
@@ -0,0 +1 @@
+timestamp
diff -uNr tac_plus.F4.0.3.alpha/tac_pam.c 081101/tac_pam.c
--- tac_plus.F4.0.3.alpha/tac_pam.c	Thu Jan  1 02:00:00 1970
+++ 081101/tac_pam.c	Wed Oct 31 14:50:28 2001
@@ -0,0 +1,199 @@
+#ifdef USE_PAM
+
+/* tac_pam.auth.c
+ * A simple pam authentication  routine written by 
+ * Max Liccardo <ravel@tiscalinet.it>
+ * PAM_RUSER=username/rem_addr.
+ */
+
+ /*
+    This program was contributed by Shane Watts
+    [modifications by AGM]
+
+    You need to add the following (or equivalent) to the /etc/pam.conf file.
+    # check authorization
+    check_user   auth       required     /usr/lib/security/pam_unix_auth.so
+    check_user   account    required     /usr/lib/security/pam_unix_acct.so
+   */
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <security/pam_appl.h>
+#include "tac_plus.h"
+
+typedef struct
+{
+	char *UserName;
+	char *Passwd;
+} UserCred;
+
+
+static int fconv(int num_msg, const struct pam_message **msg,
+		struct pam_response **resp,void *appdata_ptr)
+{
+	int 		i;
+    UserCred	*lUserCred;
+
+
+	lUserCred  = appdata_ptr;
+
+	if(lUserCred == NULL)
+	{
+		report(LOG_ERR,"argh....maybe a SunOs 5.6 ???");
+		return(PAM_CONV_ERR);
+	}
+
+
+	*resp = (struct pam_response *) calloc(num_msg,sizeof(struct pam_response));	
+	
+	for(i=0;i<num_msg;i++)
+	{
+		switch(msg[i]->msg_style)
+		{
+			case PAM_PROMPT_ECHO_OFF:
+                resp[i]->resp = strdup(lUserCred->Passwd);
+                break;
+			
+			case PAM_PROMPT_ECHO_ON:
+                resp[i]->resp = strdup(lUserCred->UserName);
+                break;		
+			
+			default:
+				 report(LOG_DEBUG,"conv default");
+			break;
+		}
+		resp[i]->resp_retcode = 0;
+	}
+
+	return(PAM_SUCCESS);
+}
+
+
+
+
+int
+tac_pam_auth(char *aszUserName,char *aszPassword,struct authen_data *data,char *aszService)
+{
+   	pam_handle_t 	*pamh=NULL;
+   	int 			retval;
+	char 			*lpszRemoteUser;   				/* Username/NAC address */
+    struct pam_conv s_conv;
+	UserCred		s_UserCred;
+
+
+	s_UserCred.UserName = aszUserName;
+    s_UserCred.Passwd 	= aszPassword;
+
+	s_conv.conv = fconv;
+    s_conv.appdata_ptr = (void *) &s_UserCred;
+
+
+	if((lpszRemoteUser = calloc(strlen(aszUserName)+strlen(data->NAS_id->NAC_address)+2,sizeof(char))) == NULL)
+	{
+        report(LOG_ERR,"cannot malloc");
+		return(1);
+	}
+
+   	retval = pam_start(aszService,aszUserName , &s_conv, &pamh);
+
+ 	if (retval != PAM_SUCCESS)
+   	{
+	    report(LOG_ERR, "cannot start pam-authentication");	
+		pamh = NULL;
+		return(1);
+    }
+
+    sprintf(lpszRemoteUser,"%s:%s",aszUserName,data->NAS_id->NAC_address);
+
+    pam_set_item(pamh,PAM_RUSER,lpszRemoteUser);
+    pam_set_item(pamh,PAM_RHOST,data->NAS_id->NAS_name);
+    pam_set_item(pamh,PAM_TTY,data->NAS_id->NAS_port);
+
+	free(lpszRemoteUser);
+
+    retval = pam_authenticate(pamh,0); 				/* is user really user? */
+
+    if(retval != PAM_SUCCESS)
+     	report(LOG_ERR, "%s",pam_strerror(pamh,retval));
+    
+    if (pam_end(pamh,retval) != PAM_SUCCESS) {     /* close Linux-PAM */
+		pamh = NULL;
+		return(1);
+	}
+
+    return ( retval == PAM_SUCCESS ? 0:1 );       /* indicate success */
+}
+
+
+/* PAM authorization rotine written by
+ * Devrim SERAL <devrim@tef.gazi.edu.tr>
+*/
+
+int
+tac_pam_authorization (char *aszUserName,struct author_data *data,char *aszService)
+{
+   	pam_handle_t 	*pamh=NULL;
+   	int 			retval;
+	char 			*lpszRemoteUser;   				/* Username/NAC address */
+	struct pam_conv s_conv;
+	UserCred		s_UserCred;
+
+
+	s_UserCred.UserName = aszUserName;
+
+	s_conv.conv = fconv;
+        s_conv.appdata_ptr = (void *) &s_UserCred;
+
+	if (aszService== NULL) 
+	{
+	report(LOG_ERR,"Service Name doesn't available So authorize him");
+                return(0);
+        }
+	
+
+	if((lpszRemoteUser = calloc(strlen(aszUserName)+strlen(data->id->NAC_address)+2,sizeof(char))) == NULL)
+	{
+        report(LOG_ERR,"cannot malloc");
+		return(1);
+	}
+
+   	retval = pam_start(aszService,aszUserName , &s_conv, &pamh);
+
+ 	if (retval != PAM_SUCCESS)
+   	{
+	    report(LOG_ERR, "cannot start pam-authentication");	
+		pamh = NULL;
+		return(1);
+    }
+
+    sprintf(lpszRemoteUser,"%s:%s",aszUserName,data->id->NAC_address);
+
+    pam_set_item(pamh,PAM_RUSER,lpszRemoteUser);
+    pam_set_item(pamh,PAM_RHOST,data->id->NAS_name);
+    pam_set_item(pamh,PAM_TTY,data->id->NAS_port);
+
+	free(lpszRemoteUser);
+
+    retval = pam_acct_mgmt(pamh, 0); /* Is user permit to gain access system */
+    
+    if(retval != PAM_SUCCESS)
+        report(LOG_ERR, "Pam Account Managment:%s",pam_strerror(pamh,retval));
+    else 
+	if (debug & DEBUG_AUTHOR_FLAG)
+        report(LOG_DEBUG, "PAM authorization allow user");    
+    
+   if (pam_end(pamh,retval) != PAM_SUCCESS) {     /* close Linux-PAM */
+		pamh = NULL;
+		return(1);
+	}
+
+    return ( retval == PAM_SUCCESS ? 0:1 );       /* indicate success */
+}
+
+
+#endif /* USE_PAM */
+
+
+
+
diff -uNr tac_plus.F4.0.3.alpha/tac_plus.1 081101/tac_plus.1
--- tac_plus.F4.0.3.alpha/tac_plus.1	Sat Apr  3 09:03:47 1999
+++ 081101/tac_plus.1	Wed Oct 31 14:50:28 2001
@@ -32,7 +32,7 @@
 authorisation and accounting.
 .LP
 On startup, tac_plus creates the file
-.B /etc/tac_plus.pid ,
+.B /var/run/tac_plus.pid ,
 if possible, containing its process id.
 .LP
 .SH ARGUMENTS and OPTIONS
@@ -85,13 +85,13 @@
 .B \-d <level>
 Switch on debugging and write debug output into
 .B
-/var/tmp/tac_plus.log. 
+/var/log/tac_plus.log. 
 
 See the definitions of debugging flags at the bottom of tac_plus.h for
 available flags and their meanings.  Most flags cause extra messages
 to be sent to 
 .B
-/var/tmp/tac_plus.log 
+/var/log/tac_plus.log 
 and also to 
 .B
 syslog.
@@ -209,10 +209,10 @@
 The tac_plus User's Guide.
 .SH FILES
 .TP 30
-.B /var/tmp/tac_plus.log
+.B /var/log/tac_plus.log
 Contains debugging output when -d is in effect.
 .TP
-.B /etc/tac_plus.pid  or /etc/tac_plus.pid.port
+.B /var/run/tac_plus.pid  or /var/run/tac_plus.pid.port
 contains the process id of the currently running daemon.  The port
 number is appended to the filename only if the port being used is not
 the default one of 49.
diff -uNr tac_plus.F4.0.3.alpha/tac_plus.c 081101/tac_plus.c
--- tac_plus.F4.0.3.alpha/tac_plus.c	Sat Apr  3 09:03:46 1999
+++ 081101/tac_plus.c	Thu Nov 29 13:18:02 2001
@@ -88,7 +88,7 @@
 
     report(LOG_INFO, "Reading config");
 
-    session.acctfile = tac_strdup("/var/tmp/acctfile");
+    session.acctfile = tac_strdup("/var/log/acctfile");
     
     if (!session.cfgfile) {
 	report(LOG_ERR, "no config file specified");
@@ -98,6 +98,7 @@
     /* read the config file */
     if (cfg_read_config(session.cfgfile)) {
 	report(LOG_ERR, "Parsing %s", session.cfgfile);
+	fprintf(stderr,"Config file not found!!\n");
 	tac_exit(1);
     }
 
@@ -116,7 +117,7 @@
 #ifdef REARMSIGNAL
     signal(SIGUSR1, handler);
     signal(SIGHUP, handler);
-#endif REARMSIGNAL
+#endif /* REARMSIGNAL */
 }
 
 /*
@@ -395,14 +396,18 @@
     
     ostream = NULL;
     /* chdir("/"); */
-    umask(0);
+    umask(022);
     errno = 0;
 
     s = get_socket();
-
+   
 #ifndef SOMAXCONN
+#ifdef LINUX
+#define SOMAXCONN 128
+#else 
 #define SOMAXCONN 5
-#endif
+#endif /* LINUX */
+#endif /* SOMAXCONN */
 
     if (listen(s, SOMAXCONN) < 0) {
 	console++;
@@ -411,9 +416,9 @@
     }
 
     if (port == TAC_PLUS_PORT) {
-	strcpy(pidfilebuf, TAC_PLUS_PIDFILE);
+	strcpy(pidfilebuf, TACPLUS_PIDFILE);
     } else {
-	sprintf(pidfilebuf, "%s.%d", TAC_PLUS_PIDFILE, port);
+	sprintf(pidfilebuf, "%s.%d", TACPLUS_PIDFILE, port);
     }
 
     /* write process id to pidfile */
@@ -424,16 +429,16 @@
 	report(LOG_ERR, "Cannot write pid to %s %s", 
 	       pidfilebuf, sys_errlist[errno]);
 
-#ifdef TAC_PLUS_GROUPID
-    if (setgid(TAC_PLUS_GROUPID))
+#ifdef TACPLUS_GROUPID
+    if (setgid(TACPLUS_GROUPID))
 	report(LOG_ERR, "Cannot set group id to %d %s", 
-	       TAC_PLUS_GROUPID, sys_errlist[errno]);
+	       TACPLUS_GROUPID, sys_errlist[errno]);
 #endif
 
-#ifdef TAC_PLUS_USERID
-    if (setuid(TAC_PLUS_USERID)) 
+#ifdef TACPLUS_USERID
+    if (setuid(TACPLUS_USERID)) 
 	report(LOG_ERR, "Cannot set user id to %d %s", 
-	       TAC_PLUS_USERID, sys_errlist[errno]);
+	       TACPLUS_USERID, sys_errlist[errno]);
 #endif
 
 #ifdef MAXSESS
@@ -699,14 +704,14 @@
 #ifdef SYSV
     fprintf(stdout,"SYSV\n");
 #endif
-#ifdef TAC_PLUS_GROUPID
-    fprintf(stdout,"TAC_PLUS_GROUPID\n");
+#ifdef TACPLUS_GROUPID
+    fprintf(stdout,"TACPLUS_GROUPID\n");
 #endif
 #ifdef TAC_PLUS_PORT
     fprintf(stdout,"TAC_PLUS_PORT\n");
 #endif
-#ifdef TAC_PLUS_USERID
-    fprintf(stdout,"TAC_PLUS_USERID\n");
+#ifdef TACPLUS_USERID
+    fprintf(stdout,"TACPLUS_USERID\n");
 #endif
 #ifdef TRACE
     fprintf(stdout,"TRACE\n");
diff -uNr tac_plus.F4.0.3.alpha/tac_plus.h 081101/tac_plus.h
--- tac_plus.F4.0.3.alpha/tac_plus.h	Sat Apr  3 09:03:47 1999
+++ 081101/tac_plus.h	Wed Oct 31 14:58:00 2001
@@ -16,6 +16,8 @@
    WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
    FITNESS FOR A PARTICULAR PURPOSE.
 */
+/* For autoconfig */
+#include "config.h"
 
 /* 
  * If you are defining a system from scratch, the following may be useful.
@@ -34,7 +36,7 @@
 /* Define this if you have shadow passwords in /etc/passwd and
  * /etc/shadow. Note that you usually need to be root to read
  * /etc/shadow */
-/* #define SHADOW_PASSWORDS */
+/*#define SHADOW_PASSWORDS*/
 
 /* Define this if your malloc is defined in malloc.h instead of stdlib.h */
 /* #define STDLIB_MALLOC */
@@ -68,7 +70,7 @@
  */
 /* #define REARMSIGNAL */
 
-#define VERSION "F4.0.3.alpha"
+#define VERSION "F4.0.3.alpha.v9 (Extended Tac_plus)"
 
 /*
  * System definitions. 
@@ -120,7 +122,6 @@
 #define SYSV
 #define GETDTABLESIZE
 #define REAPCHILD
-#define SHADOW_PASSWORDS
 #define NEED_BZERO
 #define REARMSIGNAL
 #endif /* SOLARIS */
@@ -181,8 +182,8 @@
 #include <strings.h>
 #endif	/* SYSV */
 
-#ifndef TAC_PLUS_PIDFILE
-#define TAC_PLUS_PIDFILE "/etc/tac_plus.pid"
+#ifndef TACPLUS_PIDFILE
+#define TACPLUS_PIDFILE "/var/run/tac_plus.pid"
 #endif
 
 
@@ -321,6 +322,11 @@
 #define	TAC_PLUS_PORT			49
 #endif
 
+/* Define tac_plus name for hosts.* files */ 
+#ifdef TCPWRAPPER
+#define	TACNAME				"tac_plus"
+#endif
+
 #define TAC_PLUS_READ_TIMEOUT		180	/* seconds */
 #define TAC_PLUS_WRITE_TIMEOUT		180	/* seconds */
 
@@ -337,6 +343,7 @@
     char *peer;                    /* name of connected peer */
     char *cfgfile;                 /* config file name */
     char *acctfile;                /* name of accounting file */
+    char *db_acct;             	   /* name of db accounting string */
     char port[NAS_PORT_MAX_LEN+1]; /* For error reporting */
     u_char version;                /* version of last packet read */
 };
@@ -625,6 +632,10 @@
 /* acct.c */
 extern void accounting();
 
+/* do_acct.c */
+extern int do_wtmp();
+extern int do_acct();
+
 /* report.c */
 extern void report_string();
 extern void report_hex();
@@ -637,6 +648,8 @@
 /* packet.c */
 extern u_char *get_authen_continue();
 extern int send_authen_reply();
+extern int send_error_reply();
+extern int send_acct_reply();
 
 /* utils.c */
 extern char *tac_malloc();
@@ -661,6 +674,7 @@
 extern int cfg_get_intvalue();
 extern char * cfg_get_pvalue();
 extern char *cfg_get_authen_default();
+extern int cfg_get_authen_default_method();
 extern char **cfg_get_svc_attrs();
 extern NODE *cfg_get_cmd_node();
 extern NODE *cfg_get_svc_node();
@@ -675,6 +689,9 @@
 extern char *cfg_get_pap_secret();
 extern char *cfg_get_opap_secret();
 extern char *cfg_get_global_secret();
+#ifdef USE_PAM
+extern char *cfg_get_pam_service();
+#endif /* PAM */ 
 extern void cfg_clean_config();
 extern char *cfg_nodestring();
 
@@ -713,7 +730,7 @@
 /*
  * This is a shared file used to maintain a record of who's on
  */
-#define WHOLOG_DEFAULT "/var/tmp/tac.who_log"
+#define WHOLOG_DEFAULT "/var/log/tac_who.log"
 extern char *wholog;
 /*
  * This is state kept per user/session
@@ -727,7 +744,11 @@
 
 #endif /* MAXSESS */
 
-#define LOGFILE_DEFAULT "/var/tmp/tac_plus.log"
+#ifdef USE_PAM
+extern int tac_pam_authorization();
+#endif
+
+#define LOGFILE_DEFAULT "/var/log/tac_plus.log"
 
 extern struct timeval started_at;
 extern char *logfile;
diff -uNr tac_plus.F4.0.3.alpha/tcpwrap.c 081101/tcpwrap.c
--- tac_plus.F4.0.3.alpha/tcpwrap.c	Thu Jan  1 02:00:00 1970
+++ 081101/tcpwrap.c	Wed Oct 31 14:50:29 2001
@@ -0,0 +1,37 @@
+/* 
+   This function  use for check access control rules from hosts.deny and
+   hosts.access file. 
+   Writen by Devrim SERAL<devrim@gazi.edu.tr>. This file protected by 
+   GNU Copyright agreement. 
+*/
+#ifdef TCPWRAPPER
+#include <tcpd.h>
+#include "tac_plus.h"
+
+int allow_severity = LOG_INFO;
+int deny_severity = LOG_WARNING;
+
+
+int
+check_from_wrap(datap)
+struct identity *datap;
+{
+    struct request_info req;
+
+    request_init(&req, RQ_DAEMON,TACNAME,RQ_CLIENT_ADDR,datap->NAS_name , NULL);
+    fromhost(&req); /* validate client host info */
+    if (!hosts_access(&req))
+      {
+        if (debug & DEBUG_AUTHEN_FLAG)
+		report(LOG_DEBUG, "Access denied for NAS=%s",datap->NAS_name);
+        send_authen_error("You are not allowed to access here");
+        refuse(&req); /* If connection is not allowed, clean up and exit. */
+        return 0;
+      } 
+    
+    if (debug & DEBUG_AUTHEN_FLAG )
+                report(LOG_DEBUG, "Access permited for NAS=%s",datap->NAS_name);
+return 1;     
+
+}
+#endif /* TCPWRAPPER */
diff -uNr tac_plus.F4.0.3.alpha/time_limit.c 081101/time_limit.c
--- tac_plus.F4.0.3.alpha/time_limit.c	Thu Jan  1 02:00:00 1970
+++ 081101/time_limit.c	Wed Oct 31 14:50:29 2001
@@ -0,0 +1,204 @@
+/* 		
+	These functions writen by Devrim SERAL <devrim@gazi.edu.tr>
+
+Applicable format is  : <day str><time str> [,|] <day str><time str> [,|] and so on  
+
+The accept parameter for day str is:
+SU = Sunday
+MO = Monday
+TU = Tuesday
+WE = Wendsday
+TH = Thursday
+FR = Friday
+SA = Saturday
+WK = For week days
+WD = For Week and
+AL = For All days
+
+And time str must be:
+Hourminute-Hourminute  
+For example it's to be -> 0000-1200 or 1600-1700 or 1600-0800
+
+License: This code is free software; you can redistribute it and/or modify it 
+under the terms of the GNU General Public License as published by the Free 
+Software Foundation; either version 2, or (at your option) any later version.
+		
+*/	
+
+#include"time_limit.h"
+#include "tac_plus.h"
+
+int problem=0;
+
+int 
+time_limit_process(str) 
+char *str;
+{
+int ret=0;
+char *tmp_str;
+
+tmp_str=(char *)strtok(str,",|");
+while ( tmp_str != NULL) {
+	ret|=str_token_proc(tmp_str);
+	tmp_str=(char *)strtok(NULL,",");
+	}
+return (ret); 
+}
+
+int 
+str_token_proc(str)
+char *str;
+{
+int inv=0,ret;
+
+/* Pass space characters */ 
+while (isspace(*str)) str++;
+
+if (*str=='!') { 
+		inv=1;str++; 
+}
+
+ret=process(str);
+
+if (problem) {
+	if ( debug & DEBUG_AUTHEN_FLAG )
+               report(LOG_DEBUG,"Timestamp format incorrect");
+	problem=0;
+	return(0);
+} 
+
+if (inv) 
+	ret=!ret;
+return(ret);	
+}
+
+
+int
+process(str)
+char *str;
+{
+int count=0,ret=0,i,j,localtm;
+char *head,*buf,*gec;
+long sec;
+struct tm *tms;
+
+/* Pass space characters  */
+while (isspace(*str)) str++;
+
+head=str;
+
+/* Count alphanumeric char */
+while (isalpha(*str)) { 
+	count++;
+	str++;
+}
+
+if ( count==0 || count%2 ) { 
+	problem++;
+	return 0;
+}
+
+buf=(char *)malloc(count+1);
+strncpy(buf,head,count);
+gec=buf;
+str_up(buf);
+
+for(i=1;i<=(count/2);i++) {
+	for (j=0;j<NUM;j++) {
+                if(!strncmp(gec,week_days[j],2)) {
+                        ret=ret^week_day_val[j];
+                }
+        }
+	gec+=2;
+}
+
+/* We finished to use buffer so free it */
+free(buf);
+
+sec=time(0);
+tms=localtime(&sec);
+localtm=(tms->tm_hour)*60+tms->tm_min;
+ret=( week_day_val[tms->tm_wday] & ret ) && time_calc(str,localtm);
+
+if (ret>0) 
+	return (1); 
+else 
+	return(0); 
+}
+
+str_up(str)
+char *str;
+{
+  while(*str) {
+	if(islower(*str)) *str=toupper(*str);
+	str++;
+  }
+}
+
+int 
+time_calc(str,lct)
+char *str;
+int lct;
+{
+char *t1,*t2,*head;
+int say1,say2,count=0;
+
+head=str;
+
+ while (isdigit(*head) || *head=='-') {
+        count++;
+	head++;	
+ }
+
+if (*str=='\0' || count!= TPL ) {
+	problem++;	
+	return (0);
+}
+
+  t1=(char *) malloc(count);
+  strncpy(t1,str,count);	/*Put str value to t1*/
+
+  t2=(char *) strstr(t1,"-"); /* Find next time part */
+
+if (t2==NULL) {
+   free(t1);
+   problem++;
+   return(0);
+}
+	
+*t2='\0';t2++;
+	
+if ( strlen(t1)<4 || strlen(t2)<4 ) {
+	free(t1);
+	problem++;
+	return(0);
+}
+	say1=antoi(t1,2)*60+antoi(t1+2,2);
+	say2=antoi(t2,2)*60+antoi(t2+2,2);
+
+free(t1);
+
+if (say1<=say2) { 
+	if( (lct>=say1) && (lct<=say2) ) return(1); 
+}
+else {
+	if( (lct>=say1) || (lct<=say2) ) return(1); 
+}
+return(0);
+
+}
+
+int 
+antoi(str,n)
+char *str;int n;
+{
+char *buf;
+int ret;
+
+  buf=(char *) malloc(n);
+  strncpy(buf,str,n);
+  ret=atoi(buf);
+  free(buf);
+
+return(ret);
+}
diff -uNr tac_plus.F4.0.3.alpha/time_limit.h 081101/time_limit.h
--- tac_plus.F4.0.3.alpha/time_limit.h	Thu Jan  1 02:00:00 1970
+++ 081101/time_limit.h	Wed Oct 31 14:50:29 2001
@@ -0,0 +1,13 @@
+#include<stdlib.h>
+#include<ctype.h>
+#include<stdio.h>
+#include<time.h>
+#include<string.h>
+#define NUM 10
+#define TPL  9 /* time part len */
+
+/*Global variables */
+static char* week_days[]={"SU","MO","TU","WE","TH","FR","SA","WK","WD","AL"};
+static long week_day_val[]={1,2,4,8,16,32,64,62,65,127};
+
+extern int time_limit_process();
diff -uNr tac_plus.F4.0.3.alpha/users_guide 081101/users_guide
--- tac_plus.F4.0.3.alpha/users_guide	Sat Apr  3 09:03:48 1999
+++ 081101/users_guide	Wed Oct 31 14:50:29 2001
@@ -1058,7 +1058,7 @@
 attempt to authorize is made by using a "before" clause e.g.
 
 user = auth1 {
-    before authorization "/usr/local/bin/pre_authorize $user $port $address"
+    before authorization "/usr/bin/pre_authorize $user $port $address"
 }
 
 The AV pairs sent from the NAS will be supplied to this program's
@@ -1118,9 +1118,9 @@
 NAS and change the authorization status if required.
 
 group = auth1 {
-    # call /usr/local/bin/post_authorize passing it the username, port
+    # call /usr/bin/post_authorize passing it the username, port
     # and current authorization status. 
-    after authorization "/usr/local/bin/post_authorize $user $port $status"
+    after authorization "/usr/bin/post_authorize $user $port $status"
 }
 
 The AV pairs resulting from the authorization algorithm that the
@@ -1348,16 +1348,16 @@
 --------------------------
 
 There is a myriad of debugging values that can be used in conjunction
-with the -d flag to produce debugging output in /var/tmp/tac_plus.log.
+with the -d flag to produce debugging output in /var/log/tac_plus.log.
 
 For example, starting the daemon with 
 
 	tac_plus -C CONFIG -d 16
 
-will put authentication debugging into /var/tmp/tac_plus.log. You can
+will put authentication debugging into /var/log/tac_plus.log. You can
 view this information by using the tail command.
 
-	tail -f /var/tmp/tac_plus.log
+	tail -f /var/log/tac_plus.log
 
 See the man page for more information.
 
@@ -1368,15 +1368,15 @@
 and then send the daemon a SIGUSR1. This will cause it to reinitialize
 itself and re-read the configuration file.
 
-On startup, tac_plus creates the file /etc/tac_plus.pid , if possible,
+On startup, tac_plus creates the file /var/run/tac_plus.pid , if possible,
 containing its process id. If you invoke the daemon so that it listens
-on a non-standard port, the file created is /etc/tac_plus.pid.<port>
+on a non-standard port, the file created is /var/run/tac_plus.pid.<port>
 instead, where <port> is the port number the daemon is listening on.
 
 Assuming you are listening on the default port 49, something like the
 following should work:
 
-# kill -USR1 `cat /etc/tac_plus.pid`
+# kill -USR1 `cat /var/run/tac_plus.pid`
 
 It's a good idea to check that the daemon is still running after
 sending it a SIGUSR1, since a syntactically incorrect configuration
